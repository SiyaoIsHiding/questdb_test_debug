<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>PropServerConfiguration.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">All in questdb Coverage Results, io.questdb in questdb Coverage Results</a> &gt; <a href="index.source.html" class="el_package">io.questdb</a> &gt; <span class="el_source">PropServerConfiguration.java</span></div><h1>PropServerConfiguration.java</h1><pre class="source lang-java linenums">/*******************************************************************************
 *     ___                  _   ____  ____
 *    / _ \ _   _  ___  ___| |_|  _ \| __ )
 *   | | | | | | |/ _ \/ __| __| | | |  _ \
 *   | |_| | |_| |  __/\__ \ |_| |_| | |_) |
 *    \__\_\\__,_|\___||___/\__|____/|____/
 *
 *  Copyright (c) 2014-2019 Appsicle
 *  Copyright (c) 2019-2022 QuestDB
 *
 *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 *
 ******************************************************************************/

package io.questdb;

import io.questdb.cairo.*;
import io.questdb.cairo.security.AllowAllCairoSecurityContext;
import io.questdb.cairo.sql.SqlExecutionCircuitBreakerConfiguration;
import io.questdb.cutlass.http.*;
import io.questdb.cutlass.http.processors.JsonQueryProcessorConfiguration;
import io.questdb.cutlass.http.processors.StaticContentProcessorConfiguration;
import io.questdb.cutlass.json.JsonException;
import io.questdb.cutlass.json.JsonLexer;
import io.questdb.cutlass.line.*;
import io.questdb.cutlass.line.tcp.LineTcpReceiverConfiguration;
import io.questdb.cutlass.line.udp.LineUdpReceiverConfiguration;
import io.questdb.cutlass.pgwire.PGWireConfiguration;
import io.questdb.cutlass.text.CsvFileIndexer;
import io.questdb.cutlass.text.TextConfiguration;
import io.questdb.cutlass.text.types.InputFormatConfiguration;
import io.questdb.log.Log;
import io.questdb.metrics.MetricsConfiguration;
import io.questdb.mp.WorkerPoolConfiguration;
import io.questdb.network.*;
import io.questdb.std.*;
import io.questdb.std.datetime.DateFormat;
import io.questdb.std.datetime.DateLocale;
import io.questdb.std.datetime.DateLocaleFactory;
import io.questdb.std.datetime.microtime.*;
import io.questdb.std.datetime.millitime.DateFormatFactory;
import io.questdb.std.datetime.millitime.Dates;
import io.questdb.std.datetime.millitime.MillisecondClock;
import io.questdb.std.datetime.millitime.MillisecondClockImpl;
import io.questdb.std.str.Path;
import io.questdb.std.str.StringSink;
import org.jetbrains.annotations.NotNull;
import org.jetbrains.annotations.Nullable;

import java.io.File;
import java.io.IOException;
import java.util.*;

public class PropServerConfiguration implements ServerConfiguration {
    public static final long COMMIT_INTERVAL_DEFAULT = 2000;
    public static final String CONFIG_DIRECTORY = &quot;conf&quot;;
    public static final String DB_DIRECTORY = &quot;db&quot;;
    public static final String SNAPSHOT_DIRECTORY = &quot;snapshot&quot;;
    public static final String TMP_DIRECTORY = &quot;tmp&quot;;
<span class="fc" id="L70">    private static final Map&lt;PropertyKey, String&gt; DEPRECATED_SETTINGS = new HashMap&lt;&gt;();</span>
<span class="fc" id="L71">    private static final Map&lt;String, String&gt; OBSOLETE_SETTINGS = new HashMap&lt;&gt;();</span>
<span class="fc" id="L72">    private static final LowerCaseCharSequenceIntHashMap WRITE_FO_OPTS = new LowerCaseCharSequenceIntHashMap();</span>
    private final DateFormat backupDirTimestampFormat;
    private final int backupMkdirMode;
    private final String backupRoot;
    private final CharSequence backupTempDirName;
    private final int binaryEncodingMaxLength;
    private final BuildInformation buildInformation;
    private final boolean cairoAttachPartitionCopy;
    private final String cairoAttachPartitionSuffix;
<span class="fc" id="L81">    private final CairoConfiguration cairoConfiguration = new PropCairoConfiguration();</span>
    private final int cairoMaxCrashFiles;
    private final int cairoPageFrameReduceColumnListCapacity;
    private final int cairoPageFrameReduceQueueCapacity;
    private final int cairoPageFrameReduceRowIdListCapacity;
    private final int cairoPageFrameReduceShardCount;
    private final int cairoPageFrameReduceTaskPoolCapacity;
    private final int cairoSqlCopyLogRetentionDays;
    private final int cairoSqlCopyQueueCapacity;
    private final String cairoSqlCopyRoot;
    private final String cairoSqlCopyWorkRoot;
    private final long cairoTableRegistryAutoReloadFrequency;
<span class="fc" id="L93">    private final PropSqlExecutionCircuitBreakerConfiguration circuitBreakerConfiguration = new PropSqlExecutionCircuitBreakerConfiguration();</span>
    private final int circuitBreakerThrottle;
    private final long circuitBreakerTimeout;
    private final int columnIndexerQueueCapacity;
    private final int columnPurgeQueueCapacity;
    private final long columnPurgeRetryDelay;
    private final long columnPurgeRetryDelayLimit;
    private final double columnPurgeRetryDelayMultiplier;
    private final int columnPurgeTaskPoolCapacity;
    private final int commitMode;
    private final String confRoot;
    private final int createAsSelectRetryCount;
    private final String dbDirectory;
    private final CharSequence defaultMapType;
    private final boolean defaultSymbolCacheFlag;
    private final int defaultSymbolCapacity;
    private final int fileOperationRetryCount;
<span class="fc" id="L110">    private final PropHttpContextConfiguration httpContextConfiguration = new PropHttpContextConfiguration();</span>
<span class="fc" id="L111">    private final IODispatcherConfiguration httpIODispatcherConfiguration = new PropHttpIODispatcherConfiguration();</span>
<span class="fc" id="L112">    private final PropHttpMinIODispatcherConfiguration httpMinIODispatcherConfiguration = new PropHttpMinIODispatcherConfiguration();</span>
<span class="fc" id="L113">    private final PropHttpMinServerConfiguration httpMinServerConfiguration = new PropHttpMinServerConfiguration();</span>
    private final boolean httpMinServerEnabled;
<span class="fc" id="L115">    private final HttpServerConfiguration httpServerConfiguration = new PropHttpServerConfiguration();</span>
    private final boolean httpServerEnabled;
    private final int httpSqlCacheBlockCount;
    private final boolean httpSqlCacheEnabled;
    private final int httpSqlCacheRowCount;
<span class="fc" id="L120">    private final WaitProcessorConfiguration httpWaitProcessorConfiguration = new PropWaitProcessorConfiguration();</span>
    private final long idleCheckInterval;
    private final boolean ilpAutoCreateNewColumns;
    private final boolean ilpAutoCreateNewTables;
    private final long inactiveReaderTTL;
    private final long inactiveWalWriterTTL;
    private final long inactiveWriterTTL;
    private final int indexValueBlockSize;
    private final InputFormatConfiguration inputFormatConfiguration;
    private final long instanceHashHi;
    private final long instanceHashLo;
    private final boolean ioURingEnabled;
    private final boolean isReadOnlyInstance;
<span class="fc" id="L133">    private final JsonQueryProcessorConfiguration jsonQueryProcessorConfiguration = new PropJsonQueryProcessorConfiguration();</span>
    private final int latestByQueueCapacity;
    private final boolean lineTcpEnabled;
<span class="fc" id="L136">    private final WorkerPoolConfiguration lineTcpIOWorkerPoolConfiguration = new PropLineTcpIOWorkerPoolConfiguration();</span>
<span class="fc" id="L137">    private final LineTcpReceiverConfiguration lineTcpReceiverConfiguration = new PropLineTcpReceiverConfiguration();</span>
<span class="fc" id="L138">    private final IODispatcherConfiguration lineTcpReceiverDispatcherConfiguration = new PropLineTcpReceiverIODispatcherConfiguration();</span>
<span class="fc" id="L139">    private final WorkerPoolConfiguration lineTcpWriterWorkerPoolConfiguration = new PropLineTcpWriterWorkerPoolConfiguration();</span>
    private final int lineUdpCommitMode;
    private final int lineUdpCommitRate;
    private final boolean lineUdpEnabled;
    private final int lineUdpGroupIPv4Address;
    private final int lineUdpMsgBufferSize;
    private final int lineUdpMsgCount;
    private final boolean lineUdpOwnThread;
    private final int lineUdpOwnThreadAffinity;
    private final int lineUdpReceiveBufferSize;
<span class="fc" id="L149">    private final LineUdpReceiverConfiguration lineUdpReceiverConfiguration = new PropLineUdpReceiverConfiguration();</span>
    private final LineProtoTimestampAdapter lineUdpTimestampAdapter;
    private final boolean lineUdpUnicast;
    private final DateLocale locale;
    private final Log log;
    private final int maxFileNameLength;
    private final long maxRerunWaitCapMs;
    private final int maxSwapFileCount;
    private final int maxUncommittedRows;
<span class="fc" id="L158">    private final MetricsConfiguration metricsConfiguration = new PropMetricsConfiguration();</span>
    private final boolean metricsEnabled;
    private final int mkdirMode;
    private final int o3CallbackQueueCapacity;
    private final int o3ColumnMemorySize;
    private final int o3CopyQueueCapacity;
    private final long o3MaxLag;
    private final long o3MinLagUs;
    private final int o3OpenColumnQueueCapacity;
    private final int o3PartitionPurgeListCapacity;
    private final int o3PartitionQueueCapacity;
    private final int o3PurgeDiscoveryQueueCapacity;
    private final boolean o3QuickSortEnabled;
    private final int parallelIndexThreshold;
    private final boolean parallelIndexingEnabled;
    private final boolean pgEnabled;
<span class="fc" id="L174">    private final PGWireConfiguration pgWireConfiguration = new PropPGWireConfiguration();</span>
<span class="fc" id="L175">    private final PropPGWireDispatcherConfiguration propPGWireDispatcherConfiguration = new PropPGWireDispatcherConfiguration();</span>
    private final int queryCacheEventQueueCapacity;
    private final int readerPoolMaxSegments;
    private final double rerunExponentialWaitMultiplier;
    private final int rerunInitialWaitQueueSize;
    private final int rerunMaxProcessingQueueSize;
    private final int rndFunctionMemoryMaxPages;
    private final int rndFunctionMemoryPageSize;
    private final String root;
    private final int sampleByIndexSearchPageSize;
    private final int[] sharedWorkerAffinity;
    private final int sharedWorkerCount;
    private final boolean sharedWorkerHaltOnError;
<span class="fc" id="L188">    private final WorkerPoolConfiguration sharedWorkerPoolConfiguration = new PropWorkerPoolConfiguration();</span>
    private final long sharedWorkerSleepThreshold;
    private final long sharedWorkerSleepTimeout;
    private final long sharedWorkerYieldThreshold;
    private final boolean simulateCrashEnabled;
    private final String snapshotInstanceId;
    private final boolean snapshotRecoveryEnabled;
    private final String snapshotRoot;
    private final long spinLockTimeout;
    private final int sqlAnalyticColumnPoolCapacity;
    private final int sqlAnalyticRowIdMaxPages;
    private final int sqlAnalyticRowIdPageSize;
    private final int sqlAnalyticStoreMaxPages;
    private final int sqlAnalyticStorePageSize;
    private final int sqlAnalyticTreeKeyMaxPages;
    private final int sqlAnalyticTreeKeyPageSize;
    private final int sqlBindVariablePoolSize;
    private final int sqlCharacterStoreCapacity;
    private final int sqlCharacterStoreSequencePoolCapacity;
    private final int sqlColumnCastModelPoolCapacity;
    private final int sqlColumnPoolCapacity;
    private final double sqlCompactMapLoadFactor;
    private final int sqlCopyBufferSize;
    private final int sqlCopyModelPoolCapacity;
    private final int sqlCreateTableModelPoolCapacity;
    private final int sqlDistinctTimestampKeyCapacity;
    private final double sqlDistinctTimestampLoadFactor;
    private final int sqlDoubleToStrCastScale;
    private final int sqlExplainModelPoolCapacity;
    private final int sqlExpressionPoolCapacity;
    private final double sqlFastMapLoadFactor;
    private final int sqlFloatToStrCastScale;
    private final int sqlGroupByMapCapacity;
    private final int sqlGroupByPoolCapacity;
    private final int sqlHashJoinLightValueMaxPages;
    private final int sqlHashJoinLightValuePageSize;
    private final int sqlHashJoinValueMaxPages;
    private final int sqlHashJoinValuePageSize;
    private final int sqlInsertModelPoolCapacity;
    private final int sqlJitBindVarsMemoryMaxPages;
    private final int sqlJitBindVarsMemoryPageSize;
    private final boolean sqlJitDebugEnabled;
    private final int sqlJitIRMemoryMaxPages;
    private final int sqlJitIRMemoryPageSize;
    private final int sqlJitMode;
    private final int sqlJitPageAddressCacheThreshold;
    private final int sqlJitRowsThreshold;
    private final int sqlJoinContextPoolCapacity;
    private final int sqlJoinMetadataMaxResizes;
    private final int sqlJoinMetadataPageSize;
    private final long sqlLatestByRowCount;
    private final int sqlLexerPoolCapacity;
    private final int sqlMapKeyCapacity;
    private final int sqlMapMaxPages;
    private final int sqlMapMaxResizes;
    private final int sqlMapPageSize;
    private final int sqlMaxNegativeLimit;
    private final int sqlMaxSymbolNotEqualsCount;
    private final int sqlModelPoolCapacity;
    private final int sqlPageFrameMaxRows;
    private final int sqlPageFrameMinRows;
    private final boolean sqlParallelFilterEnabled;
    private final boolean sqlParallelFilterPreTouchEnabled;
    private final int sqlRenameTableModelPoolCapacity;
    private final int sqlSmallMapKeyCapacity;
    private final int sqlSmallMapPageSize;
    private final int sqlSortKeyMaxPages;
    private final long sqlSortKeyPageSize;
    private final int sqlSortLightValueMaxPages;
    private final long sqlSortLightValuePageSize;
    private final int sqlSortValueMaxPages;
    private final int sqlSortValuePageSize;
    private final int sqlStrFunctionBufferMaxSize;
    private final int sqlTxnScoreboardEntryCount;
    private final int sqlWithClauseModelPoolCapacity;
<span class="fc" id="L263">    private final StaticContentProcessorConfiguration staticContentProcessorConfiguration = new PropStaticContentProcessorConfiguration();</span>
    private final String systemTableNamePrefix;
    private final boolean tableTypeConversionEnabled;
<span class="fc" id="L266">    private final TelemetryConfiguration telemetryConfiguration = new PropTelemetryConfiguration();</span>
    private final boolean telemetryDisableCompletely;
    private final boolean telemetryEnabled;
    private final boolean telemetryHideTables;
    private final int telemetryQueueCapacity;
<span class="fc" id="L271">    private final TextConfiguration textConfiguration = new PropTextConfiguration();</span>
    private final int vectorAggregateQueueCapacity;
<span class="fc" id="L273">    private final WorkerPoolConfiguration walApplyPoolConfiguration = new PropWalApplyPoolConfiguration();</span>
    private final long walApplySleepTimeout;
    private final int[] walApplyWorkerAffinity;
    private final int walApplyWorkerCount;
    private final boolean walApplyWorkerHaltOnError;
    private final long walApplyWorkerSleepThreshold;
    private final long walApplyWorkerYieldThreshold;
    private final int walCommitSquashRowLimit;
    private final boolean walEnabledDefault;
    private final long walPurgeInterval;
    private final int walRecreateDistressedSequencerAttempts;
    private final long walSegmentRolloverRowCount;
    private final boolean walSupported;
    private final int walTxnNotificationQueueCapacity;
    private final long workStealTimeoutNanos;
    private final long writerAsyncCommandBusyWaitTimeout;
    private final long writerAsyncCommandMaxWaitTimeout;
    private final int writerAsyncCommandQueueCapacity;
    private final long writerAsyncCommandQueueSlotSize;
    private final long writerDataAppendPageSize;
    private final long writerDataIndexKeyAppendPageSize;
    private final long writerDataIndexValueAppendPageSize;
    private final long writerFileOpenOpts;
    private final long writerMiscAppendPageSize;
    private final int writerTickRowsCountMod;
    private long cairoSqlCopyMaxIndexChunkSize;
    private int connectionPoolInitialCapacity;
    private int connectionStringPoolCapacity;
    private int dateAdapterPoolCapacity;
    private short floatDefaultColumnType;
    private boolean httpAllowDeflateBeforeSend;
    private boolean httpFrozenClock;
    private int httpMinBindIPv4Address;
    private int httpMinBindPort;
    private boolean httpMinNetConnectionHint;
    private int httpMinNetConnectionLimit;
    private long httpMinNetConnectionQueueTimeout;
    private int httpMinNetConnectionRcvBuf;
    private int httpMinNetConnectionSndBuf;
    private long httpMinNetConnectionTimeout;
    private int[] httpMinWorkerAffinity;
    private int httpMinWorkerCount;
    private boolean httpMinWorkerHaltOnError;
    private long httpMinWorkerSleepThreshold;
    private long httpMinWorkerSleepTimeout;
    private long httpMinWorkerYieldThreshold;
    private int httpNetBindIPv4Address;
    private int httpNetBindPort;
    private boolean httpNetConnectionHint;
    private int httpNetConnectionLimit;
    private long httpNetConnectionQueueTimeout;
    private int httpNetConnectionRcvBuf;
    private int httpNetConnectionSndBuf;
    private long httpNetConnectionTimeout;
    private boolean httpReadOnlySecurityContext;
    private boolean httpServerKeepAlive;
    private String httpVersion;
    private int[] httpWorkerAffinity;
    private int httpWorkerCount;
    private boolean httpWorkerHaltOnError;
    private long httpWorkerSleepThreshold;
    private long httpWorkerSleepTimeout;
    private long httpWorkerYieldThreshold;
    private CharSequence indexFileName;
    private short integerDefaultColumnType;
    private boolean interruptOnClosedConnection;
    private int jsonCacheLimit;
    private int jsonCacheSize;
    private int jsonQueryConnectionCheckFrequency;
    private int jsonQueryDoubleScale;
    private int jsonQueryFloatScale;
    private String keepAliveHeader;
    private String lineTcpAuthDbPath;
    private long lineTcpCommitIntervalDefault;
    private double lineTcpCommitIntervalFraction;
    private int lineTcpConnectionPoolInitialCapacity;
    private int lineTcpDefaultPartitionBy;
    private boolean lineTcpDisconnectOnError;
    private int[] lineTcpIOWorkerAffinity;
    private int lineTcpIOWorkerCount;
    private boolean lineTcpIOWorkerPoolHaltOnError;
    private long lineTcpIOWorkerSleepThreshold;
    private long lineTcpIOWorkerYieldThreshold;
    private long lineTcpMaintenanceInterval;
    private int lineTcpMaxMeasurementSize;
    private int lineTcpMsgBufferSize;
    private int lineTcpNetBindIPv4Address;
    private int lineTcpNetBindPort;
    private boolean lineTcpNetConnectionHint;
    private int lineTcpNetConnectionLimit;
    private long lineTcpNetConnectionQueueTimeout;
    private int lineTcpNetConnectionRcvBuf;
    private long lineTcpNetConnectionTimeout;
    private LineProtoTimestampAdapter lineTcpTimestampAdapter;
    private int lineTcpWriterQueueCapacity;
    private int[] lineTcpWriterWorkerAffinity;
    private int lineTcpWriterWorkerCount;
    private boolean lineTcpWriterWorkerPoolHaltOnError;
    private long lineTcpWriterWorkerSleepThreshold;
    private long lineTcpWriterWorkerYieldThreshold;
    private int lineUdpBindIPV4Address;
    private int lineUdpDefaultPartitionBy;
    private int lineUdpPort;
    private long maxHttpQueryResponseRowLimit;
    private double maxRequiredDelimiterStdDev;
    private double maxRequiredLineLengthStdDev;
    private int metadataStringPoolCapacity;
    private MimeTypesCache mimeTypesCache;
    private long minIdleMsBeforeWriterRelease;
    private int multipartHeaderBufferSize;
    private long multipartIdleSpinCount;
    private int netTestConnectionBufferSize;
    private int pgBinaryParamsCapacity;
    private int pgCharacterStoreCapacity;
    private int pgCharacterStorePoolCapacity;
    private int pgConnectionPoolInitialCapacity;
    private boolean pgDaemonPool;
    private DateLocale pgDefaultLocale;
    private boolean pgHaltOnError;
    private int pgInsertCacheBlockCount;
    private boolean pgInsertCacheEnabled;
    private int pgInsertCacheRowCount;
    private int pgInsertPoolCapacity;
    private int pgMaxBlobSizeOnQuery;
    private int pgNamedStatementCacheCapacity;
    private int pgNamesStatementPoolCapacity;
    private int pgNetBindIPv4Address;
    private int pgNetBindPort;
    private boolean pgNetConnectionHint;
    private int pgNetConnectionLimit;
    private long pgNetConnectionQueueTimeout;
    private int pgNetConnectionRcvBuf;
    private int pgNetConnectionSndBuf;
    private long pgNetIdleConnectionTimeout;
    private String pgPassword;
    private int pgPendingWritersCacheCapacity;
    private String pgReadOnlyPassword;
    private boolean pgReadOnlySecurityContext;
    private boolean pgReadOnlyUserEnabled;
    private String pgReadOnlyUsername;
    private int pgRecvBufferSize;
    private int pgSelectCacheBlockCount;
    private boolean pgSelectCacheEnabled;
    private int pgSelectCacheRowCount;
    private int pgSendBufferSize;
    private int pgUpdateCacheBlockCount;
    private boolean pgUpdateCacheEnabled;
    private int pgUpdateCacheRowCount;
    private String pgUsername;
    private int[] pgWorkerAffinity;
    private int pgWorkerCount;
    private long pgWorkerSleepThreshold;
    private long pgWorkerYieldThreshold;
    private String publicDirectory;
    private int recvBufferSize;
    private int requestHeaderBufferSize;
    private int rollBufferLimit;
    private int rollBufferSize;
    private int sendBufferSize;
    private boolean stringAsTagSupported;
    private boolean stringToCharCastAllowed;
    private boolean symbolAsFieldSupported;
    private long symbolCacheWaitUsBeforeReload;
    private int textAnalysisMaxLines;
    private int textLexerStringPoolCapacity;
    private int timestampAdapterPoolCapacity;
    private int utf8SinkSize;
    private final int walApplyLookAheadTransactionCount;

    public PropServerConfiguration(
            String root,
            Properties properties,
            @Nullable Map&lt;String, String&gt; env,
            Log log,
            final BuildInformation buildInformation
<span class="fc" id="L448">    ) throws ServerConfigurationException, JsonException {</span>

<span class="fc" id="L450">        this.log = log;</span>
<span class="fc" id="L451">        this.isReadOnlyInstance = getBoolean(properties, env, PropertyKey.READ_ONLY_INSTANCE, false);</span>
<span class="fc" id="L452">        this.cairoTableRegistryAutoReloadFrequency = getLong(properties, env, PropertyKey.CAIRO_TABLE_REGISTRY_AUTO_RELOAD_FREQUENCY, 500);</span>

<span class="fc" id="L454">        boolean configValidationStrict = getBoolean(properties, env, PropertyKey.CONFIG_VALIDATION_STRICT, false);</span>
<span class="fc" id="L455">        validateProperties(properties, configValidationStrict);</span>

<span class="fc" id="L457">        this.mkdirMode = getInt(properties, env, PropertyKey.CAIRO_MKDIR_MODE, 509);</span>
<span class="fc" id="L458">        this.maxFileNameLength = getInt(properties, env, PropertyKey.CAIRO_MAX_FILE_NAME_LENGTH, 127);</span>
<span class="fc" id="L459">        this.walEnabledDefault = getBoolean(properties, env, PropertyKey.CAIRO_WAL_ENABLED_DEFAULT, false);</span>
<span class="fc" id="L460">        this.walPurgeInterval = getLong(properties, env, PropertyKey.CAIRO_WAL_PURGE_INTERVAL, 30_000);</span>
<span class="fc" id="L461">        this.walTxnNotificationQueueCapacity = getQueueCapacity(properties, env, PropertyKey.CAIRO_WAL_TXN_NOTIFICATION_QUEUE_CAPACITY, 4096);</span>
<span class="fc" id="L462">        this.walRecreateDistressedSequencerAttempts = getInt(properties, env, PropertyKey.CAIRO_WAL_RECREATE_DISTRESSED_SEQUENCER_ATTEMPTS, 3);</span>
<span class="fc" id="L463">        this.walSupported = getBoolean(properties, env, PropertyKey.CAIRO_WAL_SUPPORTED, true);</span>
<span class="fc" id="L464">        this.walSegmentRolloverRowCount = getLong(properties, env, PropertyKey.CAIRO_WAL_SEGMENT_ROLLOVER_ROW_COUNT, 200_000);</span>
<span class="fc" id="L465">        this.walCommitSquashRowLimit = getInt(properties, env, PropertyKey.CAIRO_WAL_COMMIT_SQUASH_ROW_LIMIT, 512 * 1024);</span>
<span class="fc" id="L466">        this.walApplyLookAheadTransactionCount = getInt(properties, env, PropertyKey.CAIRO_WAL_APPLY_LOOK_AHEAD_TXN_COUNT, 20);</span>
<span class="fc" id="L467">        this.tableTypeConversionEnabled = getBoolean(properties, env, PropertyKey.TABLE_TYPE_CONVERSION_ENABLED, true);</span>

<span class="fc" id="L469">        this.dbDirectory = getString(properties, env, PropertyKey.CAIRO_ROOT, DB_DIRECTORY);</span>
        String tmpRoot;
<span class="pc bpc" id="L471" title="1 of 2 branches missed.">        if (new File(this.dbDirectory).isAbsolute()) {</span>
<span class="nc" id="L472">            this.root = this.dbDirectory;</span>
<span class="nc" id="L473">            this.confRoot = rootSubdir(this.root, CONFIG_DIRECTORY); // ../conf</span>
<span class="nc" id="L474">            this.snapshotRoot = rootSubdir(this.root, SNAPSHOT_DIRECTORY); // ../snapshot</span>
<span class="nc" id="L475">            tmpRoot = rootSubdir(this.root, TMP_DIRECTORY); // ../tmp</span>
        } else {
<span class="fc" id="L477">            this.root = new File(root, this.dbDirectory).getAbsolutePath();</span>
<span class="fc" id="L478">            this.confRoot = new File(root, CONFIG_DIRECTORY).getAbsolutePath();</span>
<span class="fc" id="L479">            this.snapshotRoot = new File(root, SNAPSHOT_DIRECTORY).getAbsolutePath();</span>
<span class="fc" id="L480">            tmpRoot = new File(root, TMP_DIRECTORY).getAbsolutePath();</span>
        }
<span class="fc" id="L482">        this.cairoAttachPartitionSuffix = getString(properties, env, PropertyKey.CAIRO_ATTACH_PARTITION_SUFFIX, TableUtils.ATTACHABLE_DIR_MARKER);</span>
<span class="fc" id="L483">        this.cairoAttachPartitionCopy = getBoolean(properties, env, PropertyKey.CAIRO_ATTACH_PARTITION_COPY, false);</span>

<span class="fc" id="L485">        this.snapshotInstanceId = getString(properties, env, PropertyKey.CAIRO_SNAPSHOT_INSTANCE_ID, &quot;&quot;);</span>
<span class="fc" id="L486">        this.snapshotRecoveryEnabled = getBoolean(properties, env, PropertyKey.CAIRO_SNAPSHOT_RECOVERY_ENABLED, true);</span>
<span class="fc" id="L487">        this.simulateCrashEnabled = getBoolean(properties, env, PropertyKey.CAIRO_SIMULATE_CRASH_ENABLED, false);</span>

<span class="fc" id="L489">        int cpuAvailable = Runtime.getRuntime().availableProcessors();</span>
<span class="fc" id="L490">        int cpuUsed = 0;</span>
<span class="fc" id="L491">        int cpuSpare = 0;</span>
<span class="pc bpc" id="L492" title="1 of 2 branches missed.">        if (cpuAvailable &gt; 16) {</span>
<span class="nc" id="L493">            cpuSpare = 2;</span>
<span class="pc bpc" id="L494" title="1 of 2 branches missed.">        } else if (cpuAvailable &gt; 8) {</span>
<span class="nc" id="L495">            cpuSpare = 1;</span>
        }
<span class="fc" id="L497">        final FilesFacade ff = cairoConfiguration.getFilesFacade();</span>
<span class="fc" id="L498">        try (Path path = new Path()) {</span>
<span class="fc" id="L499">            ff.mkdirs(path.of(this.root).slash$(), this.mkdirMode);</span>
<span class="fc" id="L500">            path.of(this.root).concat(TableUtils.TAB_INDEX_FILE_NAME).$();</span>
<span class="fc" id="L501">            final int tableIndexFd = TableUtils.openFileRWOrFail(ff, path, CairoConfiguration.O_NONE);</span>
<span class="fc" id="L502">            final long fileSize = ff.length(tableIndexFd);</span>
<span class="fc bfc" id="L503" title="All 2 branches covered.">            if (fileSize &lt; Long.BYTES) {</span>
<span class="pc bpc" id="L504" title="1 of 2 branches missed.">                if (!ff.allocate(tableIndexFd, Files.PAGE_SIZE)) {</span>
<span class="nc" id="L505">                    ff.close(tableIndexFd);</span>
<span class="nc" id="L506">                    throw CairoException.critical(ff.errno()).put(&quot;Could not allocate [file=&quot;).put(path).put(&quot;, actual=&quot;).put(fileSize).put(&quot;, desired=&quot;).put(Files.PAGE_SIZE).put(']');</span>
                }
            }

<span class="fc" id="L510">            final long tableIndexMem = TableUtils.mapRWOrClose(ff, tableIndexFd, Files.PAGE_SIZE, MemoryTag.MMAP_DEFAULT);</span>
<span class="fc" id="L511">            Rnd rnd = new Rnd(getCairoConfiguration().getMicrosecondClock().getTicks(), getCairoConfiguration().getMillisecondClock().getTicks());</span>
<span class="fc bfc" id="L512" title="All 2 branches covered.">            if (Os.compareAndSwap(tableIndexMem + Long.BYTES, 0, rnd.nextLong()) == 0) {</span>
<span class="fc" id="L513">                Unsafe.getUnsafe().putLong(tableIndexMem + Long.BYTES * 2, rnd.nextLong());</span>
            }
<span class="fc" id="L515">            this.instanceHashLo = Unsafe.getUnsafe().getLong(tableIndexMem + Long.BYTES);</span>
<span class="fc" id="L516">            this.instanceHashHi = Unsafe.getUnsafe().getLong(tableIndexMem + Long.BYTES * 2);</span>
<span class="fc" id="L517">            ff.munmap(tableIndexMem, Files.PAGE_SIZE, MemoryTag.MMAP_DEFAULT);</span>
<span class="fc" id="L518">            ff.close(tableIndexFd);</span>

<span class="fc" id="L520">            this.httpMinServerEnabled = getBoolean(properties, env, PropertyKey.HTTP_MIN_ENABLED, true);</span>
<span class="pc bpc" id="L521" title="1 of 2 branches missed.">            if (httpMinServerEnabled) {</span>
<span class="fc" id="L522">                this.httpMinWorkerHaltOnError = getBoolean(properties, env, PropertyKey.HTTP_MIN_WORKER_HALT_ON_ERROR, false);</span>
<span class="pc bpc" id="L523" title="1 of 2 branches missed.">                this.httpMinWorkerCount = getInt(properties, env, PropertyKey.HTTP_MIN_WORKER_COUNT, cpuAvailable &gt; 16 ? 1 : 0);</span>
<span class="fc" id="L524">                cpuUsed += this.httpMinWorkerCount;</span>
<span class="fc" id="L525">                this.httpMinWorkerAffinity = getAffinity(properties, env, PropertyKey.HTTP_MIN_WORKER_AFFINITY, httpMinWorkerCount);</span>
<span class="fc" id="L526">                this.httpMinWorkerYieldThreshold = getLong(properties, env, PropertyKey.HTTP_MIN_WORKER_YIELD_THRESHOLD, 10);</span>
<span class="fc" id="L527">                this.httpMinWorkerSleepThreshold = getLong(properties, env, PropertyKey.HTTP_MIN_WORKER_SLEEP_THRESHOLD, 100);</span>
<span class="fc" id="L528">                this.httpMinWorkerSleepTimeout = getLong(properties, env, PropertyKey.HTTP_MIN_WORKER_SLEEP_TIMEOUT, 50);</span>

                // deprecated
<span class="fc" id="L531">                String httpMinBindTo = getString(properties, env, PropertyKey.HTTP_MIN_BIND_TO, &quot;0.0.0.0:9003&quot;);</span>

<span class="fc" id="L533">                parseBindTo(properties, env, PropertyKey.HTTP_MIN_NET_BIND_TO, httpMinBindTo, (a, p) -&gt; {</span>
<span class="fc" id="L534">                    httpMinBindIPv4Address = a;</span>
<span class="fc" id="L535">                    httpMinBindPort = p;</span>
<span class="fc" id="L536">                });</span>

<span class="fc" id="L538">                this.httpMinNetConnectionLimit = getInt(properties, env, PropertyKey.HTTP_MIN_NET_CONNECTION_LIMIT, 4);</span>

                // deprecated
<span class="fc" id="L541">                this.httpMinNetConnectionTimeout = getLong(properties, env, PropertyKey.HTTP_MIN_NET_IDLE_CONNECTION_TIMEOUT, 5 * 60 * 1000L);</span>
<span class="fc" id="L542">                this.httpMinNetConnectionTimeout = getLong(properties, env, PropertyKey.HTTP_MIN_NET_CONNECTION_TIMEOUT, this.httpMinNetConnectionTimeout);</span>

                // deprecated
<span class="fc" id="L545">                this.httpMinNetConnectionQueueTimeout = getLong(properties, env, PropertyKey.HTTP_MIN_NET_QUEUED_CONNECTION_TIMEOUT, 5 * 1000L);</span>
<span class="fc" id="L546">                this.httpMinNetConnectionQueueTimeout = getLong(properties, env, PropertyKey.HTTP_MIN_NET_CONNECTION_QUEUE_TIMEOUT, this.httpMinNetConnectionQueueTimeout);</span>

                // deprecated
<span class="fc" id="L549">                this.httpMinNetConnectionSndBuf = getIntSize(properties, env, PropertyKey.HTTP_MIN_NET_SND_BUF_SIZE, 1024);</span>
<span class="fc" id="L550">                this.httpMinNetConnectionSndBuf = getIntSize(properties, env, PropertyKey.HTTP_MIN_NET_CONNECTION_SNDBUF, this.httpMinNetConnectionSndBuf);</span>

                // deprecated
<span class="fc" id="L553">                this.httpMinNetConnectionRcvBuf = getIntSize(properties, env, PropertyKey.HTTP_NET_RCV_BUF_SIZE, 1024);</span>
<span class="fc" id="L554">                this.httpMinNetConnectionRcvBuf = getIntSize(properties, env, PropertyKey.HTTP_MIN_NET_CONNECTION_RCVBUF, this.httpMinNetConnectionRcvBuf);</span>
<span class="fc" id="L555">                this.httpMinNetConnectionHint = getBoolean(properties, env, PropertyKey.HTTP_MIN_NET_CONNECTION_HINT, false);</span>
            }

<span class="fc" id="L558">            this.httpServerEnabled = getBoolean(properties, env, PropertyKey.HTTP_ENABLED, true);</span>
<span class="fc bfc" id="L559" title="All 2 branches covered.">            if (httpServerEnabled) {</span>
<span class="fc" id="L560">                this.connectionPoolInitialCapacity = getInt(properties, env, PropertyKey.HTTP_CONNECTION_POOL_INITIAL_CAPACITY, 4);</span>
<span class="fc" id="L561">                this.connectionStringPoolCapacity = getInt(properties, env, PropertyKey.HTTP_CONNECTION_STRING_POOL_CAPACITY, 128);</span>
<span class="fc" id="L562">                this.multipartHeaderBufferSize = getIntSize(properties, env, PropertyKey.HTTP_MULTIPART_HEADER_BUFFER_SIZE, 512);</span>
<span class="fc" id="L563">                this.multipartIdleSpinCount = getLong(properties, env, PropertyKey.HTTP_MULTIPART_IDLE_SPIN_COUNT, 10_000);</span>
<span class="fc" id="L564">                this.recvBufferSize = getIntSize(properties, env, PropertyKey.HTTP_RECEIVE_BUFFER_SIZE, Numbers.SIZE_1MB);</span>
<span class="fc" id="L565">                this.requestHeaderBufferSize = getIntSize(properties, env, PropertyKey.HTTP_REQUEST_HEADER_BUFFER_SIZE, 32 * 2014);</span>
<span class="fc" id="L566">                this.httpWorkerCount = getInt(properties, env, PropertyKey.HTTP_WORKER_COUNT, 0);</span>
<span class="fc" id="L567">                cpuUsed += this.httpWorkerCount;</span>
<span class="fc" id="L568">                this.httpWorkerAffinity = getAffinity(properties, env, PropertyKey.HTTP_WORKER_AFFINITY, httpWorkerCount);</span>
<span class="fc" id="L569">                this.httpWorkerHaltOnError = getBoolean(properties, env, PropertyKey.HTTP_WORKER_HALT_ON_ERROR, false);</span>
<span class="fc" id="L570">                this.httpWorkerYieldThreshold = getLong(properties, env, PropertyKey.HTTP_WORKER_YIELD_THRESHOLD, 10);</span>
<span class="fc" id="L571">                this.httpWorkerSleepThreshold = getLong(properties, env, PropertyKey.HTTP_WORKER_SLEEP_THRESHOLD, 10_000);</span>
<span class="fc" id="L572">                this.httpWorkerSleepTimeout = getLong(properties, env, PropertyKey.HTTP_WORKER_SLEEP_TIMEOUT, 10);</span>
<span class="fc" id="L573">                this.sendBufferSize = getIntSize(properties, env, PropertyKey.HTTP_SEND_BUFFER_SIZE, 2 * Numbers.SIZE_1MB);</span>
<span class="fc" id="L574">                this.indexFileName = getString(properties, env, PropertyKey.HTTP_STATIC_INDEX_FILE_NAME, &quot;index.html&quot;);</span>
<span class="fc" id="L575">                this.httpFrozenClock = getBoolean(properties, env, PropertyKey.HTTP_FROZEN_CLOCK, false);</span>
<span class="fc" id="L576">                this.httpAllowDeflateBeforeSend = getBoolean(properties, env, PropertyKey.HTTP_ALLOW_DEFLATE_BEFORE_SEND, false);</span>
<span class="fc" id="L577">                this.httpServerKeepAlive = getBoolean(properties, env, PropertyKey.HTTP_SERVER_KEEP_ALIVE, true);</span>
<span class="fc" id="L578">                this.httpVersion = getString(properties, env, PropertyKey.HTTP_VERSION, &quot;HTTP/1.1&quot;);</span>
<span class="pc bpc" id="L579" title="1 of 2 branches missed.">                if (!httpVersion.endsWith(&quot; &quot;)) {</span>
<span class="fc" id="L580">                    httpVersion += ' ';</span>
                }

<span class="fc" id="L583">                int keepAliveTimeout = getInt(properties, env, PropertyKey.HTTP_KEEP_ALIVE_TIMEOUT, 5);</span>
<span class="fc" id="L584">                int keepAliveMax = getInt(properties, env, PropertyKey.HTTP_KEEP_ALIVE_MAX, 10_000);</span>

<span class="pc bpc" id="L586" title="1 of 4 branches missed.">                if (keepAliveTimeout &gt; 0 &amp;&amp; keepAliveMax &gt; 0) {</span>
<span class="fc" id="L587">                    this.keepAliveHeader = &quot;Keep-Alive: timeout=&quot; + keepAliveTimeout + &quot;, max=&quot; + keepAliveMax + Misc.EOL;</span>
                } else {
<span class="fc" id="L589">                    this.keepAliveHeader = null;</span>
                }

<span class="fc" id="L592">                final String publicDirectory = getString(properties, env, PropertyKey.HTTP_STATIC_PUBLIC_DIRECTORY, &quot;public&quot;);</span>
                // translate public directory into absolute path
                // this will generate some garbage, but this is ok - we're just doing this once on startup
<span class="pc bpc" id="L595" title="1 of 2 branches missed.">                if (new File(publicDirectory).isAbsolute()) {</span>
<span class="nc" id="L596">                    this.publicDirectory = publicDirectory;</span>
                } else {
<span class="fc" id="L598">                    this.publicDirectory = new File(root, publicDirectory).getAbsolutePath();</span>
                }

                // maintain deprecated property name for the time being
<span class="fc" id="L602">                this.httpNetConnectionLimit = getInt(properties, env, PropertyKey.HTTP_NET_ACTIVE_CONNECTION_LIMIT, 64);</span>
<span class="fc" id="L603">                this.httpNetConnectionLimit = getInt(properties, env, PropertyKey.HTTP_NET_CONNECTION_LIMIT, this.httpNetConnectionLimit);</span>
<span class="fc" id="L604">                this.httpNetConnectionHint = getBoolean(properties, env, PropertyKey.HTTP_NET_CONNECTION_HINT, false);</span>
                // deprecated
<span class="fc" id="L606">                this.httpNetConnectionTimeout = getLong(properties, env, PropertyKey.HTTP_NET_IDLE_CONNECTION_TIMEOUT, 5 * 60 * 1000L);</span>
<span class="fc" id="L607">                this.httpNetConnectionTimeout = getLong(properties, env, PropertyKey.HTTP_NET_CONNECTION_TIMEOUT, this.httpNetConnectionTimeout);</span>

                // deprecated
<span class="fc" id="L610">                this.httpNetConnectionQueueTimeout = getLong(properties, env, PropertyKey.HTTP_NET_QUEUED_CONNECTION_TIMEOUT, 5 * 1000L);</span>
<span class="fc" id="L611">                this.httpNetConnectionQueueTimeout = getLong(properties, env, PropertyKey.HTTP_NET_CONNECTION_QUEUE_TIMEOUT, this.httpNetConnectionQueueTimeout);</span>

                // deprecated
<span class="fc" id="L614">                this.httpNetConnectionSndBuf = getIntSize(properties, env, PropertyKey.HTTP_NET_SND_BUF_SIZE, 2 * Numbers.SIZE_1MB);</span>
<span class="fc" id="L615">                this.httpNetConnectionSndBuf = getIntSize(properties, env, PropertyKey.HTTP_NET_CONNECTION_SNDBUF, this.httpNetConnectionSndBuf);</span>

                // deprecated
<span class="fc" id="L618">                this.httpNetConnectionRcvBuf = getIntSize(properties, env, PropertyKey.HTTP_NET_RCV_BUF_SIZE, 2 * Numbers.SIZE_1MB);</span>
<span class="fc" id="L619">                this.httpNetConnectionRcvBuf = getIntSize(properties, env, PropertyKey.HTTP_NET_CONNECTION_RCVBUF, this.httpNetConnectionRcvBuf);</span>

<span class="fc" id="L621">                this.dateAdapterPoolCapacity = getInt(properties, env, PropertyKey.HTTP_TEXT_DATE_ADAPTER_POOL_CAPACITY, 16);</span>
<span class="fc" id="L622">                this.jsonCacheLimit = getIntSize(properties, env, PropertyKey.HTTP_TEXT_JSON_CACHE_LIMIT, 16384);</span>
<span class="fc" id="L623">                this.jsonCacheSize = getIntSize(properties, env, PropertyKey.HTTP_TEXT_JSON_CACHE_SIZE, 8192);</span>
<span class="fc" id="L624">                this.maxRequiredDelimiterStdDev = getDouble(properties, env, PropertyKey.HTTP_TEXT_MAX_REQUIRED_DELIMITER_STDDEV, 0.1222d);</span>
<span class="fc" id="L625">                this.maxRequiredLineLengthStdDev = getDouble(properties, env, PropertyKey.HTTP_TEXT_MAX_REQUIRED_LINE_LENGTH_STDDEV, 0.8);</span>
<span class="fc" id="L626">                this.metadataStringPoolCapacity = getInt(properties, env, PropertyKey.HTTP_TEXT_METADATA_STRING_POOL_CAPACITY, 128);</span>

<span class="fc" id="L628">                this.rollBufferLimit = getIntSize(properties, env, PropertyKey.HTTP_TEXT_ROLL_BUFFER_LIMIT, 1024 * 4096);</span>
<span class="fc" id="L629">                this.rollBufferSize = getIntSize(properties, env, PropertyKey.HTTP_TEXT_ROLL_BUFFER_SIZE, 1024);</span>
<span class="fc" id="L630">                this.textAnalysisMaxLines = getInt(properties, env, PropertyKey.HTTP_TEXT_ANALYSIS_MAX_LINES, 1000);</span>
<span class="fc" id="L631">                this.textLexerStringPoolCapacity = getInt(properties, env, PropertyKey.HTTP_TEXT_LEXER_STRING_POOL_CAPACITY, 64);</span>
<span class="fc" id="L632">                this.timestampAdapterPoolCapacity = getInt(properties, env, PropertyKey.HTTP_TEXT_TIMESTAMP_ADAPTER_POOL_CAPACITY, 64);</span>
<span class="fc" id="L633">                this.utf8SinkSize = getIntSize(properties, env, PropertyKey.HTTP_TEXT_UTF8_SINK_SIZE, 4096);</span>

<span class="fc" id="L635">                this.jsonQueryConnectionCheckFrequency = getInt(properties, env, PropertyKey.HTTP_JSON_QUERY_CONNECTION_CHECK_FREQUENCY, 1_000_000);</span>
<span class="fc" id="L636">                this.jsonQueryFloatScale = getInt(properties, env, PropertyKey.HTTP_JSON_QUERY_FLOAT_SCALE, 4);</span>
<span class="fc" id="L637">                this.jsonQueryDoubleScale = getInt(properties, env, PropertyKey.HTTP_JSON_QUERY_DOUBLE_SCALE, 12);</span>
<span class="fc" id="L638">                this.httpReadOnlySecurityContext = getBoolean(properties, env, PropertyKey.HTTP_SECURITY_READONLY, false);</span>
<span class="fc" id="L639">                this.maxHttpQueryResponseRowLimit = getLong(properties, env, PropertyKey.HTTP_SECURITY_MAX_RESPONSE_ROWS, Long.MAX_VALUE);</span>
<span class="fc" id="L640">                this.interruptOnClosedConnection = getBoolean(properties, env, PropertyKey.HTTP_SECURITY_INTERRUPT_ON_CLOSED_CONNECTION, true);</span>

<span class="fc" id="L642">                String httpBindTo = getString(properties, env, PropertyKey.HTTP_BIND_TO, &quot;0.0.0.0:9000&quot;);</span>
<span class="fc" id="L643">                parseBindTo(properties, env, PropertyKey.HTTP_NET_BIND_TO, httpBindTo, (a, p) -&gt; {</span>
<span class="fc" id="L644">                    httpNetBindIPv4Address = a;</span>
<span class="fc" id="L645">                    httpNetBindPort = p;</span>
<span class="fc" id="L646">                });</span>

                // load mime types
<span class="fc" id="L649">                path.of(new File(new File(root, CONFIG_DIRECTORY), &quot;mime.types&quot;).getAbsolutePath()).$();</span>
<span class="fc" id="L650">                this.mimeTypesCache = new MimeTypesCache(FilesFacadeImpl.INSTANCE, path);</span>
            }

<span class="fc" id="L653">            this.maxRerunWaitCapMs = getLong(properties, env, PropertyKey.HTTP_BUSY_RETRY_MAXIMUM_WAIT_BEFORE_RETRY, 1000);</span>
<span class="fc" id="L654">            this.rerunExponentialWaitMultiplier = getDouble(properties, env, PropertyKey.HTTP_BUSY_RETRY_EXPONENTIAL_WAIT_MULTIPLIER, 2.0);</span>
<span class="fc" id="L655">            this.rerunInitialWaitQueueSize = getIntSize(properties, env, PropertyKey.HTTP_BUSY_RETRY_INITIAL_WAIT_QUEUE_SIZE, 64);</span>
<span class="fc" id="L656">            this.rerunMaxProcessingQueueSize = getIntSize(properties, env, PropertyKey.HTTP_BUSY_RETRY_MAX_PROCESSING_QUEUE_SIZE, 4096);</span>

<span class="fc" id="L658">            this.circuitBreakerThrottle = getInt(properties, env, PropertyKey.CIRCUIT_BREAKER_THROTTLE, 2_000_000);</span>
<span class="fc" id="L659">            this.circuitBreakerTimeout = (long) (getDouble(properties, env, PropertyKey.QUERY_TIMEOUT_SEC, 60) * Timestamps.SECOND_MILLIS);</span>
<span class="fc" id="L660">            this.netTestConnectionBufferSize = getInt(properties, env, PropertyKey.CIRCUIT_BREAKER_BUFFER_SIZE, 64);</span>
<span class="fc" id="L661">            this.netTestConnectionBufferSize = getInt(properties, env, PropertyKey.NET_TEST_CONNECTION_BUFFER_SIZE, netTestConnectionBufferSize);</span>

<span class="fc" id="L663">            this.pgEnabled = getBoolean(properties, env, PropertyKey.PG_ENABLED, true);</span>
<span class="pc bpc" id="L664" title="1 of 2 branches missed.">            if (pgEnabled) {</span>
                // deprecated
<span class="fc" id="L666">                pgNetConnectionLimit = getInt(properties, env, PropertyKey.PG_NET_ACTIVE_CONNECTION_LIMIT, 64);</span>
<span class="fc" id="L667">                pgNetConnectionLimit = getInt(properties, env, PropertyKey.PG_NET_CONNECTION_LIMIT, pgNetConnectionLimit);</span>
<span class="fc" id="L668">                pgNetConnectionHint = getBoolean(properties, env, PropertyKey.PG_NET_CONNECTION_HINT, false);</span>
<span class="fc" id="L669">                parseBindTo(properties, env, PropertyKey.PG_NET_BIND_TO, &quot;0.0.0.0:8812&quot;, (a, p) -&gt; {</span>
<span class="fc" id="L670">                    pgNetBindIPv4Address = a;</span>
<span class="fc" id="L671">                    pgNetBindPort = p;</span>
<span class="fc" id="L672">                });</span>

                // deprecated
<span class="fc" id="L675">                this.pgNetIdleConnectionTimeout = getLong(properties, env, PropertyKey.PG_NET_IDLE_TIMEOUT, 300_000);</span>
<span class="fc" id="L676">                this.pgNetIdleConnectionTimeout = getLong(properties, env, PropertyKey.PG_NET_CONNECTION_TIMEOUT, this.pgNetIdleConnectionTimeout);</span>
<span class="fc" id="L677">                this.pgNetConnectionQueueTimeout = getLong(properties, env, PropertyKey.PG_NET_CONNECTION_QUEUE_TIMEOUT, 300_000);</span>

                // deprecated
<span class="fc" id="L680">                this.pgNetConnectionRcvBuf = getIntSize(properties, env, PropertyKey.PG_NET_RECV_BUF_SIZE, -1);</span>
<span class="fc" id="L681">                this.pgNetConnectionRcvBuf = getIntSize(properties, env, PropertyKey.PG_NET_CONNECTION_RCVBUF, this.pgNetConnectionRcvBuf);</span>

                // deprecated
<span class="fc" id="L684">                this.pgNetConnectionSndBuf = getIntSize(properties, env, PropertyKey.PG_NET_SEND_BUF_SIZE, -1);</span>
<span class="fc" id="L685">                this.pgNetConnectionSndBuf = getIntSize(properties, env, PropertyKey.PG_NET_CONNECTION_SNDBUF, this.pgNetConnectionSndBuf);</span>

<span class="fc" id="L687">                this.pgCharacterStoreCapacity = getInt(properties, env, PropertyKey.PG_CHARACTER_STORE_CAPACITY, 4096);</span>
<span class="fc" id="L688">                this.pgBinaryParamsCapacity = getInt(properties, env, PropertyKey.PG_BINARY_PARAM_COUNT_CAPACITY, 2);</span>
<span class="fc" id="L689">                this.pgCharacterStorePoolCapacity = getInt(properties, env, PropertyKey.PG_CHARACTER_STORE_POOL_CAPACITY, 64);</span>
<span class="fc" id="L690">                this.pgConnectionPoolInitialCapacity = getInt(properties, env, PropertyKey.PG_CONNECTION_POOL_CAPACITY, 4);</span>
<span class="fc" id="L691">                this.pgPassword = getString(properties, env, PropertyKey.PG_PASSWORD, &quot;quest&quot;);</span>
<span class="fc" id="L692">                this.pgUsername = getString(properties, env, PropertyKey.PG_USER, &quot;admin&quot;);</span>
<span class="fc" id="L693">                this.pgReadOnlyPassword = getString(properties, env, PropertyKey.PG_RO_PASSWORD, &quot;quest&quot;);</span>
<span class="fc" id="L694">                this.pgReadOnlyUsername = getString(properties, env, PropertyKey.PG_RO_USER, &quot;user&quot;);</span>
<span class="fc" id="L695">                this.pgReadOnlyUserEnabled = getBoolean(properties, env, PropertyKey.PG_RO_USER_ENABLED, false);</span>
<span class="fc" id="L696">                this.pgReadOnlySecurityContext = getBoolean(properties, env, PropertyKey.PG_SECURITY_READONLY, false);</span>
<span class="fc" id="L697">                this.pgMaxBlobSizeOnQuery = getIntSize(properties, env, PropertyKey.PG_MAX_BLOB_SIZE_ON_QUERY, 512 * 1024);</span>
<span class="fc" id="L698">                this.pgRecvBufferSize = getIntSize(properties, env, PropertyKey.PG_RECV_BUFFER_SIZE, Numbers.SIZE_1MB);</span>
<span class="fc" id="L699">                this.pgSendBufferSize = getIntSize(properties, env, PropertyKey.PG_SEND_BUFFER_SIZE, Numbers.SIZE_1MB);</span>
<span class="fc" id="L700">                final String dateLocale = getString(properties, env, PropertyKey.PG_DATE_LOCALE, &quot;en&quot;);</span>
<span class="fc" id="L701">                this.pgDefaultLocale = DateLocaleFactory.INSTANCE.getLocale(dateLocale);</span>
<span class="pc bpc" id="L702" title="1 of 2 branches missed.">                if (this.pgDefaultLocale == null) {</span>
<span class="nc" id="L703">                    throw ServerConfigurationException.forInvalidKey(PropertyKey.PG_DATE_LOCALE.getPropertyPath(), dateLocale);</span>
                }
<span class="fc" id="L705">                this.pgWorkerCount = getInt(properties, env, PropertyKey.PG_WORKER_COUNT, 0);</span>
<span class="fc" id="L706">                cpuUsed += this.pgWorkerCount;</span>
<span class="fc" id="L707">                this.pgWorkerAffinity = getAffinity(properties, env, PropertyKey.PG_WORKER_AFFINITY, pgWorkerCount);</span>
<span class="fc" id="L708">                this.pgHaltOnError = getBoolean(properties, env, PropertyKey.PG_HALT_ON_ERROR, false);</span>
<span class="fc" id="L709">                this.pgWorkerYieldThreshold = getLong(properties, env, PropertyKey.PG_WORKER_YIELD_THRESHOLD, 10);</span>
<span class="fc" id="L710">                this.pgWorkerSleepThreshold = getLong(properties, env, PropertyKey.PG_WORKER_SLEEP_THRESHOLD, 10_000);</span>
<span class="fc" id="L711">                this.pgDaemonPool = getBoolean(properties, env, PropertyKey.PG_DAEMON_POOL, true);</span>
<span class="fc" id="L712">                this.pgSelectCacheEnabled = getBoolean(properties, env, PropertyKey.PG_SELECT_CACHE_ENABLED, true);</span>
<span class="fc" id="L713">                this.pgSelectCacheBlockCount = getInt(properties, env, PropertyKey.PG_SELECT_CACHE_BLOCK_COUNT, 8);</span>
<span class="fc" id="L714">                this.pgSelectCacheRowCount = getInt(properties, env, PropertyKey.PG_SELECT_CACHE_ROW_COUNT, 8);</span>
<span class="fc" id="L715">                this.pgInsertCacheEnabled = getBoolean(properties, env, PropertyKey.PG_INSERT_CACHE_ENABLED, true);</span>
<span class="fc" id="L716">                this.pgInsertCacheBlockCount = getInt(properties, env, PropertyKey.PG_INSERT_CACHE_BLOCK_COUNT, 4);</span>
<span class="fc" id="L717">                this.pgInsertCacheRowCount = getInt(properties, env, PropertyKey.PG_INSERT_CACHE_ROW_COUNT, 4);</span>
<span class="fc" id="L718">                this.pgInsertPoolCapacity = getInt(properties, env, PropertyKey.PG_INSERT_POOL_CAPACITY, 16);</span>
<span class="fc" id="L719">                this.pgUpdateCacheEnabled = getBoolean(properties, env, PropertyKey.PG_UPDATE_CACHE_ENABLED, true);</span>
<span class="fc" id="L720">                this.pgUpdateCacheBlockCount = getInt(properties, env, PropertyKey.PG_UPDATE_CACHE_BLOCK_COUNT, 4);</span>
<span class="fc" id="L721">                this.pgUpdateCacheRowCount = getInt(properties, env, PropertyKey.PG_UPDATE_CACHE_ROW_COUNT, 4);</span>
<span class="fc" id="L722">                this.pgNamedStatementCacheCapacity = getInt(properties, env, PropertyKey.PG_NAMED_STATEMENT_CACHE_CAPACITY, 32);</span>
<span class="fc" id="L723">                this.pgNamesStatementPoolCapacity = getInt(properties, env, PropertyKey.PG_NAMED_STATEMENT_POOL_CAPACITY, 32);</span>
<span class="fc" id="L724">                this.pgPendingWritersCacheCapacity = getInt(properties, env, PropertyKey.PG_PENDING_WRITERS_CACHE_CAPACITY, 16);</span>
            }

<span class="fc" id="L727">            this.walApplyWorkerCount = getInt(properties, env, PropertyKey.WAL_APPLY_WORKER_COUNT, cpuAvailable);</span>
<span class="fc" id="L728">            this.walApplyWorkerAffinity = getAffinity(properties, env, PropertyKey.WAL_APPLY_WORKER_AFFINITY, walApplyWorkerCount);</span>
<span class="fc" id="L729">            this.walApplyWorkerHaltOnError = getBoolean(properties, env, PropertyKey.WAL_APPLY_WORKER_HALT_ON_ERROR, false);</span>
<span class="fc" id="L730">            this.walApplyWorkerSleepThreshold = getLong(properties, env, PropertyKey.WAL_APPLY_WORKER_SLEEP_THRESHOLD, 10_000);</span>
<span class="fc" id="L731">            this.walApplySleepTimeout = getLong(properties, env, PropertyKey.WAL_APPLY_WORKER_SLEEP_TIMEOUT, 10);</span>
<span class="fc" id="L732">            this.walApplyWorkerYieldThreshold = getLong(properties, env, PropertyKey.WAL_APPLY_WORKER_YIELD_THRESHOLD, 10);</span>

<span class="fc" id="L734">            this.commitMode = getCommitMode(properties, env, PropertyKey.CAIRO_COMMIT_MODE);</span>
<span class="fc" id="L735">            this.createAsSelectRetryCount = getInt(properties, env, PropertyKey.CAIRO_CREATE_AS_SELECT_RETRY_COUNT, 5);</span>
<span class="fc" id="L736">            this.defaultMapType = getString(properties, env, PropertyKey.CAIRO_DEFAULT_MAP_TYPE, &quot;fast&quot;);</span>
<span class="fc" id="L737">            this.defaultSymbolCacheFlag = getBoolean(properties, env, PropertyKey.CAIRO_DEFAULT_SYMBOL_CACHE_FLAG, true);</span>
<span class="fc" id="L738">            this.defaultSymbolCapacity = getInt(properties, env, PropertyKey.CAIRO_DEFAULT_SYMBOL_CAPACITY, 256);</span>
<span class="fc" id="L739">            this.fileOperationRetryCount = getInt(properties, env, PropertyKey.CAIRO_FILE_OPERATION_RETRY_COUNT, 30);</span>
<span class="fc" id="L740">            this.idleCheckInterval = getLong(properties, env, PropertyKey.CAIRO_IDLE_CHECK_INTERVAL, 5 * 60 * 1000L);</span>
<span class="fc" id="L741">            this.inactiveReaderTTL = getLong(properties, env, PropertyKey.CAIRO_INACTIVE_READER_TTL, 120_000);</span>
<span class="fc" id="L742">            this.inactiveWriterTTL = getLong(properties, env, PropertyKey.CAIRO_INACTIVE_WRITER_TTL, 600_000);</span>
<span class="fc" id="L743">            this.inactiveWalWriterTTL = getLong(properties, env, PropertyKey.CAIRO_WAL_INACTIVE_WRITER_TTL, 60_000);</span>
<span class="fc" id="L744">            this.indexValueBlockSize = Numbers.ceilPow2(getIntSize(properties, env, PropertyKey.CAIRO_INDEX_VALUE_BLOCK_SIZE, 256));</span>
<span class="fc" id="L745">            this.maxSwapFileCount = getInt(properties, env, PropertyKey.CAIRO_MAX_SWAP_FILE_COUNT, 30);</span>
<span class="fc" id="L746">            this.parallelIndexThreshold = getInt(properties, env, PropertyKey.CAIRO_PARALLEL_INDEX_THRESHOLD, 100000);</span>
<span class="fc" id="L747">            this.readerPoolMaxSegments = getInt(properties, env, PropertyKey.CAIRO_READER_POOL_MAX_SEGMENTS, 5);</span>
<span class="fc" id="L748">            this.spinLockTimeout = getLong(properties, env, PropertyKey.CAIRO_SPIN_LOCK_TIMEOUT, 1_000);</span>
<span class="fc" id="L749">            this.httpSqlCacheEnabled = getBoolean(properties, env, PropertyKey.HTTP_QUERY_CACHE_ENABLED, true);</span>
<span class="fc" id="L750">            this.httpSqlCacheBlockCount = getInt(properties, env, PropertyKey.HTTP_QUERY_CACHE_BLOCK_COUNT, 4);</span>
<span class="fc" id="L751">            this.httpSqlCacheRowCount = getInt(properties, env, PropertyKey.HTTP_QUERY_CACHE_ROW_COUNT, 4);</span>
<span class="fc" id="L752">            this.sqlCharacterStoreCapacity = getInt(properties, env, PropertyKey.CAIRO_CHARACTER_STORE_CAPACITY, 1024);</span>
<span class="fc" id="L753">            this.sqlCharacterStoreSequencePoolCapacity = getInt(properties, env, PropertyKey.CAIRO_CHARACTER_STORE_SEQUENCE_POOL_CAPACITY, 64);</span>
<span class="fc" id="L754">            this.sqlColumnPoolCapacity = getInt(properties, env, PropertyKey.CAIRO_COLUMN_POOL_CAPACITY, 4096);</span>
<span class="fc" id="L755">            this.sqlCompactMapLoadFactor = getDouble(properties, env, PropertyKey.CAIRO_COMPACT_MAP_LOAD_FACTOR, 0.7);</span>
<span class="fc" id="L756">            this.sqlExpressionPoolCapacity = getInt(properties, env, PropertyKey.CAIRO_EXPRESSION_POOL_CAPACITY, 8192);</span>
<span class="fc" id="L757">            this.sqlFastMapLoadFactor = getDouble(properties, env, PropertyKey.CAIRO_FAST_MAP_LOAD_FACTOR, 0.7);</span>
<span class="fc" id="L758">            this.sqlJoinContextPoolCapacity = getInt(properties, env, PropertyKey.CAIRO_SQL_JOIN_CONTEXT_POOL_CAPACITY, 64);</span>
<span class="fc" id="L759">            this.sqlLexerPoolCapacity = getInt(properties, env, PropertyKey.CAIRO_LEXER_POOL_CAPACITY, 2048);</span>
<span class="fc" id="L760">            this.sqlMapKeyCapacity = getInt(properties, env, PropertyKey.CAIRO_SQL_MAP_KEY_CAPACITY, 2048 * 1024);</span>
<span class="fc" id="L761">            this.sqlSmallMapKeyCapacity = getInt(properties, env, PropertyKey.CAIRO_SQL_SMALL_MAP_KEY_CAPACITY, 1024);</span>
<span class="fc" id="L762">            this.sqlSmallMapPageSize = getIntSize(properties, env, PropertyKey.CAIRO_SQL_SMALL_MAP_PAGE_SIZE, 32 * 1024);</span>
<span class="fc" id="L763">            this.sqlMapPageSize = getIntSize(properties, env, PropertyKey.CAIRO_SQL_MAP_PAGE_SIZE, 4 * Numbers.SIZE_1MB);</span>
<span class="fc" id="L764">            this.sqlMapMaxPages = getIntSize(properties, env, PropertyKey.CAIRO_SQL_MAP_MAX_PAGES, Integer.MAX_VALUE);</span>
<span class="fc" id="L765">            this.sqlMapMaxResizes = getIntSize(properties, env, PropertyKey.CAIRO_SQL_MAP_MAX_RESIZES, Integer.MAX_VALUE);</span>
<span class="fc" id="L766">            this.sqlExplainModelPoolCapacity = getInt(properties, env, PropertyKey.CAIRO_SQL_EXPLAIN_MODEL_POOL_CAPACITY, 32);</span>
<span class="fc" id="L767">            this.sqlModelPoolCapacity = getInt(properties, env, PropertyKey.CAIRO_MODEL_POOL_CAPACITY, 1024);</span>
<span class="fc" id="L768">            this.sqlMaxNegativeLimit = getInt(properties, env, PropertyKey.CAIRO_SQL_MAX_NEGATIVE_LIMIT, 10_000);</span>
<span class="fc" id="L769">            this.sqlSortKeyPageSize = getLongSize(properties, env, PropertyKey.CAIRO_SQL_SORT_KEY_PAGE_SIZE, 4 * Numbers.SIZE_1MB);</span>
<span class="fc" id="L770">            this.sqlSortKeyMaxPages = getIntSize(properties, env, PropertyKey.CAIRO_SQL_SORT_KEY_MAX_PAGES, Integer.MAX_VALUE);</span>
<span class="fc" id="L771">            this.sqlSortLightValuePageSize = getLongSize(properties, env, PropertyKey.CAIRO_SQL_SORT_LIGHT_VALUE_PAGE_SIZE, 8 * 1048576);</span>
<span class="fc" id="L772">            this.sqlSortLightValueMaxPages = getIntSize(properties, env, PropertyKey.CAIRO_SQL_SORT_LIGHT_VALUE_MAX_PAGES, Integer.MAX_VALUE);</span>
<span class="fc" id="L773">            this.sqlHashJoinValuePageSize = getIntSize(properties, env, PropertyKey.CAIRO_SQL_HASH_JOIN_VALUE_PAGE_SIZE, 16777216);</span>
<span class="fc" id="L774">            this.sqlHashJoinValueMaxPages = getIntSize(properties, env, PropertyKey.CAIRO_SQL_HASH_JOIN_VALUE_MAX_PAGES, Integer.MAX_VALUE);</span>
<span class="fc" id="L775">            this.sqlLatestByRowCount = getInt(properties, env, PropertyKey.CAIRO_SQL_LATEST_BY_ROW_COUNT, 1000);</span>
<span class="fc" id="L776">            this.sqlHashJoinLightValuePageSize = getIntSize(properties, env, PropertyKey.CAIRO_SQL_HASH_JOIN_LIGHT_VALUE_PAGE_SIZE, 1048576);</span>
<span class="fc" id="L777">            this.sqlHashJoinLightValueMaxPages = getIntSize(properties, env, PropertyKey.CAIRO_SQL_HASH_JOIN_LIGHT_VALUE_MAX_PAGES, Integer.MAX_VALUE);</span>
<span class="fc" id="L778">            this.sqlSortValuePageSize = getIntSize(properties, env, PropertyKey.CAIRO_SQL_SORT_VALUE_PAGE_SIZE, 16777216);</span>
<span class="fc" id="L779">            this.sqlSortValueMaxPages = getIntSize(properties, env, PropertyKey.CAIRO_SQL_SORT_VALUE_MAX_PAGES, Integer.MAX_VALUE);</span>
<span class="fc" id="L780">            this.workStealTimeoutNanos = getLong(properties, env, PropertyKey.CAIRO_WORK_STEAL_TIMEOUT_NANOS, 10_000);</span>
<span class="fc" id="L781">            this.parallelIndexingEnabled = getBoolean(properties, env, PropertyKey.CAIRO_PARALLEL_INDEXING_ENABLED, true);</span>
<span class="fc" id="L782">            this.sqlJoinMetadataPageSize = getIntSize(properties, env, PropertyKey.CAIRO_SQL_JOIN_METADATA_PAGE_SIZE, 16384);</span>
<span class="fc" id="L783">            this.sqlJoinMetadataMaxResizes = getIntSize(properties, env, PropertyKey.CAIRO_SQL_JOIN_METADATA_MAX_RESIZES, Integer.MAX_VALUE);</span>
<span class="fc" id="L784">            this.sqlAnalyticColumnPoolCapacity = getInt(properties, env, PropertyKey.CAIRO_SQL_ANALYTIC_COLUMN_POOL_CAPACITY, 64);</span>
<span class="fc" id="L785">            this.sqlCreateTableModelPoolCapacity = getInt(properties, env, PropertyKey.CAIRO_SQL_CREATE_TABEL_MODEL_POOL_CAPACITY, 16);</span>
<span class="fc" id="L786">            this.sqlColumnCastModelPoolCapacity = getInt(properties, env, PropertyKey.CAIRO_SQL_COLUMN_CAST_MODEL_POOL_CAPACITY, 16);</span>
<span class="fc" id="L787">            this.sqlRenameTableModelPoolCapacity = getInt(properties, env, PropertyKey.CAIRO_SQL_RENAME_TABLE_MODEL_POOL_CAPACITY, 16);</span>
<span class="fc" id="L788">            this.sqlWithClauseModelPoolCapacity = getInt(properties, env, PropertyKey.CAIRO_SQL_WITH_CLAUSE_MODEL_POOL_CAPACITY, 128);</span>
<span class="fc" id="L789">            this.sqlInsertModelPoolCapacity = getInt(properties, env, PropertyKey.CAIRO_SQL_INSERT_MODEL_POOL_CAPACITY, 64);</span>
<span class="fc" id="L790">            this.sqlCopyModelPoolCapacity = getInt(properties, env, PropertyKey.CAIRO_SQL_COPY_MODEL_POOL_CAPACITY, 32);</span>
<span class="fc" id="L791">            this.sqlCopyBufferSize = getIntSize(properties, env, PropertyKey.CAIRO_SQL_COPY_BUFFER_SIZE, 2 * Numbers.SIZE_1MB);</span>
<span class="fc" id="L792">            this.columnPurgeQueueCapacity = getQueueCapacity(properties, env, PropertyKey.CAIRO_SQL_COLUMN_PURGE_QUEUE_CAPACITY, 128);</span>
<span class="fc" id="L793">            this.columnPurgeTaskPoolCapacity = getIntSize(properties, env, PropertyKey.CAIRO_SQL_COLUMN_PURGE_TASK_POOL_CAPACITY, 256);</span>
<span class="fc" id="L794">            this.columnPurgeRetryDelayLimit = getLong(properties, env, PropertyKey.CAIRO_SQL_COLUMN_PURGE_RETRY_DELAY_LIMIT, 60_000_000L);</span>
<span class="fc" id="L795">            this.columnPurgeRetryDelay = getLong(properties, env, PropertyKey.CAIRO_SQL_COLUMN_PURGE_RETRY_DELAY, 10_000);</span>
<span class="fc" id="L796">            this.columnPurgeRetryDelayMultiplier = getDouble(properties, env, PropertyKey.CAIRO_SQL_COLUMN_PURGE_RETRY_DELAY_MULTIPLIER, 10.0);</span>
<span class="fc" id="L797">            this.systemTableNamePrefix = getString(properties, env, PropertyKey.CAIRO_SQL_SYSTEM_TABLE_PREFIX, &quot;sys.&quot;);</span>

<span class="fc" id="L799">            this.cairoPageFrameReduceQueueCapacity = Numbers.ceilPow2(getInt(properties, env, PropertyKey.CAIRO_PAGE_FRAME_REDUCE_QUEUE_CAPACITY, 64));</span>
<span class="fc" id="L800">            this.cairoPageFrameReduceRowIdListCapacity = Numbers.ceilPow2(getInt(properties, env, PropertyKey.CAIRO_PAGE_FRAME_ROWID_LIST_CAPACITY, 256));</span>
<span class="fc" id="L801">            this.cairoPageFrameReduceColumnListCapacity = Numbers.ceilPow2(getInt(properties, env, PropertyKey.CAIRO_PAGE_FRAME_COLUMN_LIST_CAPACITY, 16));</span>
<span class="fc" id="L802">            this.sqlParallelFilterEnabled = getBoolean(properties, env, PropertyKey.CAIRO_SQL_PARALLEL_FILTER_ENABLED, true);</span>
<span class="fc" id="L803">            this.sqlParallelFilterPreTouchEnabled = getBoolean(properties, env, PropertyKey.CAIRO_SQL_PARALLEL_FILTER_PRETOUCH_ENABLED, true);</span>
<span class="fc" id="L804">            this.cairoPageFrameReduceShardCount = getInt(properties, env, PropertyKey.CAIRO_PAGE_FRAME_SHARD_COUNT, 4);</span>
<span class="fc" id="L805">            this.cairoPageFrameReduceTaskPoolCapacity = getInt(properties, env, PropertyKey.CAIRO_PAGE_FRAME_TASK_POOL_CAPACITY, 4);</span>

<span class="fc" id="L807">            this.writerDataIndexKeyAppendPageSize = Files.ceilPageSize(getLongSize(properties, env, PropertyKey.CAIRO_WRITER_DATA_INDEX_KEY_APPEND_PAGE_SIZE, 512 * 1024));</span>
<span class="fc" id="L808">            this.writerDataIndexValueAppendPageSize = Files.ceilPageSize(getLongSize(properties, env, PropertyKey.CAIRO_WRITER_DATA_INDEX_VALUE_APPEND_PAGE_SIZE, 16 * Numbers.SIZE_1MB));</span>
<span class="fc" id="L809">            this.writerDataAppendPageSize = Files.ceilPageSize(getLongSize(properties, env, PropertyKey.CAIRO_WRITER_DATA_APPEND_PAGE_SIZE, 16 * Numbers.SIZE_1MB));</span>
<span class="fc" id="L810">            this.writerMiscAppendPageSize = Files.ceilPageSize(getLongSize(properties, env, PropertyKey.CAIRO_WRITER_MISC_APPEND_PAGE_SIZE, Files.PAGE_SIZE));</span>

<span class="fc" id="L812">            this.sampleByIndexSearchPageSize = getIntSize(properties, env, PropertyKey.CAIRO_SQL_SAMPLEBY_PAGE_SIZE, 0);</span>
<span class="fc" id="L813">            this.sqlDoubleToStrCastScale = getInt(properties, env, PropertyKey.CAIRO_SQL_DOUBLE_CAST_SCALE, 12);</span>
<span class="fc" id="L814">            this.sqlFloatToStrCastScale = getInt(properties, env, PropertyKey.CAIRO_SQL_FLOAT_CAST_SCALE, 4);</span>
<span class="fc" id="L815">            this.sqlGroupByMapCapacity = getInt(properties, env, PropertyKey.CAIRO_SQL_GROUPBY_MAP_CAPACITY, 1024);</span>
<span class="fc" id="L816">            this.sqlGroupByPoolCapacity = getInt(properties, env, PropertyKey.CAIRO_SQL_GROUPBY_POOL_CAPACITY, 1024);</span>
<span class="fc" id="L817">            this.sqlMaxSymbolNotEqualsCount = getInt(properties, env, PropertyKey.CAIRO_SQL_MAX_SYMBOL_NOT_EQUALS_COUNT, 100);</span>
<span class="fc" id="L818">            this.sqlBindVariablePoolSize = getInt(properties, env, PropertyKey.CAIRO_SQL_BIND_VARIABLE_POOL_SIZE, 8);</span>
<span class="fc" id="L819">            final String sqlCopyFormatsFile = getString(properties, env, PropertyKey.CAIRO_SQL_COPY_FORMATS_FILE, &quot;/text_loader.json&quot;);</span>
<span class="fc" id="L820">            final String dateLocale = getString(properties, env, PropertyKey.CAIRO_DATE_LOCALE, &quot;en&quot;);</span>
<span class="fc" id="L821">            this.locale = DateLocaleFactory.INSTANCE.getLocale(dateLocale);</span>
<span class="pc bpc" id="L822" title="1 of 2 branches missed.">            if (this.locale == null) {</span>
<span class="nc" id="L823">                throw ServerConfigurationException.forInvalidKey(PropertyKey.CAIRO_DATE_LOCALE.getPropertyPath(), dateLocale);</span>
            }
<span class="fc" id="L825">            this.sqlDistinctTimestampKeyCapacity = getInt(properties, env, PropertyKey.CAIRO_SQL_DISTINCT_TIMESTAMP_KEY_CAPACITY, 512);</span>
<span class="fc" id="L826">            this.sqlDistinctTimestampLoadFactor = getDouble(properties, env, PropertyKey.CAIRO_SQL_DISTINCT_TIMESTAMP_LOAD_FACTOR, 0.5);</span>
<span class="fc" id="L827">            this.sqlPageFrameMinRows = getInt(properties, env, PropertyKey.CAIRO_SQL_PAGE_FRAME_MIN_ROWS, 1_000);</span>
<span class="fc" id="L828">            this.sqlPageFrameMaxRows = getInt(properties, env, PropertyKey.CAIRO_SQL_PAGE_FRAME_MAX_ROWS, 1_000_000);</span>

<span class="fc" id="L830">            this.sqlJitMode = getSqlJitMode(properties, env);</span>
<span class="fc" id="L831">            this.sqlJitIRMemoryPageSize = getIntSize(properties, env, PropertyKey.CAIRO_SQL_JIT_IR_MEMORY_PAGE_SIZE, 8 * 1024);</span>
<span class="fc" id="L832">            this.sqlJitIRMemoryMaxPages = getInt(properties, env, PropertyKey.CAIRO_SQL_JIT_IR_MEMORY_MAX_PAGES, 8);</span>
<span class="fc" id="L833">            this.sqlJitBindVarsMemoryPageSize = getIntSize(properties, env, PropertyKey.CAIRO_SQL_JIT_BIND_VARS_MEMORY_PAGE_SIZE, 4 * 1024);</span>
<span class="fc" id="L834">            this.sqlJitBindVarsMemoryMaxPages = getInt(properties, env, PropertyKey.CAIRO_SQL_JIT_BIND_VARS_MEMORY_MAX_PAGES, 8);</span>
<span class="fc" id="L835">            this.sqlJitRowsThreshold = getIntSize(properties, env, PropertyKey.CAIRO_SQL_JIT_ROWS_THRESHOLD, 1024 * 1024);</span>
<span class="fc" id="L836">            this.sqlJitPageAddressCacheThreshold = getIntSize(properties, env, PropertyKey.CAIRO_SQL_JIT_PAGE_ADDRESS_CACHE_THRESHOLD, 1024 * 1024);</span>
<span class="fc" id="L837">            this.sqlJitDebugEnabled = getBoolean(properties, env, PropertyKey.CAIRO_SQL_JIT_DEBUG_ENABLED, false);</span>

<span class="fc" id="L839">            String value = getString(properties, env, PropertyKey.CAIRO_WRITER_FO_OPTS, &quot;o_none&quot;);</span>
<span class="fc" id="L840">            long lopts = CairoConfiguration.O_NONE;</span>
<span class="fc" id="L841">            String[] opts = value.split(&quot;\\|&quot;);</span>
<span class="fc bfc" id="L842" title="All 2 branches covered.">            for (String opt : opts) {</span>
<span class="fc" id="L843">                int index = WRITE_FO_OPTS.keyIndex(opt.trim());</span>
<span class="pc bpc" id="L844" title="1 of 2 branches missed.">                if (index &lt; 0) {</span>
<span class="fc" id="L845">                    lopts |= WRITE_FO_OPTS.valueAt(index);</span>
                }
            }
<span class="fc" id="L848">            writerFileOpenOpts = lopts;</span>

<span class="fc" id="L850">            this.inputFormatConfiguration = new InputFormatConfiguration(</span>
                    new DateFormatFactory(),
                    DateLocaleFactory.INSTANCE,
                    new TimestampFormatFactory(),
                    this.locale
            );

<span class="fc" id="L857">            try (JsonLexer lexer = new JsonLexer(1024, 1024)) {</span>
<span class="fc" id="L858">                inputFormatConfiguration.parseConfiguration(lexer, confRoot, sqlCopyFormatsFile);</span>
            }

<span class="fc" id="L861">            this.cairoSqlCopyRoot = getString(properties, env, PropertyKey.CAIRO_SQL_COPY_ROOT, null);</span>
<span class="fc" id="L862">            String cairoSqlCopyWorkRoot = getString(properties, env, PropertyKey.CAIRO_SQL_COPY_WORK_ROOT, tmpRoot);</span>
<span class="fc bfc" id="L863" title="All 2 branches covered.">            if (cairoSqlCopyRoot != null) {</span>
<span class="fc" id="L864">                this.cairoSqlCopyWorkRoot = getCanonicalPath(cairoSqlCopyWorkRoot);</span>
            } else {
<span class="fc" id="L866">                this.cairoSqlCopyWorkRoot = null;</span>
            }

<span class="fc bfc" id="L869" title="All 2 branches covered.">            if (pathEquals(root, this.cairoSqlCopyWorkRoot) ||</span>
<span class="fc bfc" id="L870" title="All 2 branches covered.">                    pathEquals(this.root, this.cairoSqlCopyWorkRoot) ||</span>
<span class="fc bfc" id="L871" title="All 2 branches covered.">                    pathEquals(this.confRoot, this.cairoSqlCopyWorkRoot) ||</span>
<span class="fc bfc" id="L872" title="All 2 branches covered.">                    pathEquals(this.snapshotRoot, this.cairoSqlCopyWorkRoot)) {</span>
<span class="fc" id="L873">                throw new ServerConfigurationException(&quot;Configuration value for &quot; + PropertyKey.CAIRO_SQL_COPY_WORK_ROOT.getPropertyPath() + &quot; can't point to root, data, conf or snapshot dirs. &quot;);</span>
            }

<span class="fc" id="L876">            this.cairoSqlCopyMaxIndexChunkSize = getLongSize(properties, env, PropertyKey.CAIRO_SQL_COPY_MAX_INDEX_CHUNK_SIZE, 100 * Numbers.SIZE_1MB);</span>
<span class="fc" id="L877">            this.cairoSqlCopyMaxIndexChunkSize -= (cairoSqlCopyMaxIndexChunkSize % CsvFileIndexer.INDEX_ENTRY_SIZE);</span>
<span class="pc bpc" id="L878" title="1 of 2 branches missed.">            if (this.cairoSqlCopyMaxIndexChunkSize &lt; 16) {</span>
<span class="nc" id="L879">                throw new ServerConfigurationException(&quot;invalid configuration value [key=&quot; + PropertyKey.CAIRO_SQL_COPY_MAX_INDEX_CHUNK_SIZE.getPropertyPath() +</span>
                        &quot;, description=max import chunk size can't be smaller than 16]&quot;);
            }
<span class="fc" id="L882">            this.cairoSqlCopyQueueCapacity = Numbers.ceilPow2(getInt(properties, env, PropertyKey.CAIRO_SQL_COPY_QUEUE_CAPACITY, 32));</span>
<span class="fc" id="L883">            this.cairoSqlCopyLogRetentionDays = getInt(properties, env, PropertyKey.CAIRO_SQL_COPY_LOG_RETENTION_DAYS, 3);</span>
<span class="fc" id="L884">            this.o3MinLagUs = getLong(properties, env, PropertyKey.CAIRO_O3_MIN_LAG, 1_000) * 1_000L;</span>

<span class="fc" id="L886">            this.backupRoot = getString(properties, env, PropertyKey.CAIRO_SQL_BACKUP_ROOT, null);</span>
<span class="fc" id="L887">            this.backupDirTimestampFormat = getTimestampFormat(properties, env);</span>
<span class="fc" id="L888">            this.backupTempDirName = getString(properties, env, PropertyKey.CAIRO_SQL_BACKUP_DIR_TMP_NAME, &quot;tmp&quot;);</span>
<span class="fc" id="L889">            this.backupMkdirMode = getInt(properties, env, PropertyKey.CAIRO_SQL_BACKUP_MKDIR_MODE, 509);</span>
<span class="fc" id="L890">            this.columnIndexerQueueCapacity = getQueueCapacity(properties, env, PropertyKey.CAIRO_COLUMN_INDEXER_QUEUE_CAPACITY, 64);</span>
<span class="fc" id="L891">            this.vectorAggregateQueueCapacity = getQueueCapacity(properties, env, PropertyKey.CAIRO_VECTOR_AGGREGATE_QUEUE_CAPACITY, 128);</span>
<span class="fc" id="L892">            this.o3CallbackQueueCapacity = getQueueCapacity(properties, env, PropertyKey.CAIRO_O3_CALLBACK_QUEUE_CAPACITY, 128);</span>
<span class="fc" id="L893">            this.o3PartitionQueueCapacity = getQueueCapacity(properties, env, PropertyKey.CAIRO_O3_PARTITION_QUEUE_CAPACITY, 128);</span>
<span class="fc" id="L894">            this.o3OpenColumnQueueCapacity = getQueueCapacity(properties, env, PropertyKey.CAIRO_O3_OPEN_COLUMN_QUEUE_CAPACITY, 128);</span>
<span class="fc" id="L895">            this.o3CopyQueueCapacity = getQueueCapacity(properties, env, PropertyKey.CAIRO_O3_COPY_QUEUE_CAPACITY, 128);</span>
<span class="fc" id="L896">            this.o3PurgeDiscoveryQueueCapacity = Numbers.ceilPow2(getInt(properties, env, PropertyKey.CAIRO_O3_PURGE_DISCOVERY_QUEUE_CAPACITY, 128));</span>
<span class="fc" id="L897">            this.o3ColumnMemorySize = (int) Files.ceilPageSize(getIntSize(properties, env, PropertyKey.CAIRO_O3_COLUMN_MEMORY_SIZE, 8 * Numbers.SIZE_1MB));</span>
<span class="fc" id="L898">            this.maxUncommittedRows = getInt(properties, env, PropertyKey.CAIRO_MAX_UNCOMMITTED_ROWS, 500_000);</span>

<span class="fc" id="L900">            long o3MaxLag = getLong(properties, env, PropertyKey.CAIRO_COMMIT_LAG, 10 * Dates.MINUTE_MILLIS);</span>
<span class="fc" id="L901">            this.o3MaxLag = getLong(properties, env, PropertyKey.CAIRO_O3_MAX_LAG, o3MaxLag) * 1_000;</span>

<span class="fc" id="L903">            this.o3QuickSortEnabled = getBoolean(properties, env, PropertyKey.CAIRO_O3_QUICKSORT_ENABLED, false);</span>
<span class="fc" id="L904">            this.rndFunctionMemoryPageSize = Numbers.ceilPow2(getIntSize(properties, env, PropertyKey.CAIRO_RND_MEMORY_PAGE_SIZE, 8192));</span>
<span class="fc" id="L905">            this.rndFunctionMemoryMaxPages = Numbers.ceilPow2(getInt(properties, env, PropertyKey.CAIRO_RND_MEMORY_MAX_PAGES, 128));</span>
<span class="fc" id="L906">            this.sqlStrFunctionBufferMaxSize = Numbers.ceilPow2(getInt(properties, env, PropertyKey.CAIRO_SQL_STR_FUNCTION_BUFFER_MAX_SIZE, Numbers.SIZE_1MB));</span>
<span class="fc" id="L907">            this.sqlAnalyticStorePageSize = Numbers.ceilPow2(getIntSize(properties, env, PropertyKey.CAIRO_SQL_ANALYTIC_STORE_PAGE_SIZE, Numbers.SIZE_1MB));</span>
<span class="fc" id="L908">            this.sqlAnalyticStoreMaxPages = getInt(properties, env, PropertyKey.CAIRO_SQL_ANALYTIC_STORE_MAX_PAGES, Integer.MAX_VALUE);</span>
<span class="fc" id="L909">            this.sqlAnalyticRowIdPageSize = Numbers.ceilPow2(getIntSize(properties, env, PropertyKey.CAIRO_SQL_ANALYTIC_ROWID_PAGE_SIZE, 512 * 1024));</span>
<span class="fc" id="L910">            this.sqlAnalyticRowIdMaxPages = getInt(properties, env, PropertyKey.CAIRO_SQL_ANALYTIC_ROWID_MAX_PAGES, Integer.MAX_VALUE);</span>
<span class="fc" id="L911">            this.sqlAnalyticTreeKeyPageSize = Numbers.ceilPow2(getIntSize(properties, env, PropertyKey.CAIRO_SQL_ANALYTIC_TREE_PAGE_SIZE, 512 * 1024));</span>
<span class="fc" id="L912">            this.sqlAnalyticTreeKeyMaxPages = getInt(properties, env, PropertyKey.CAIRO_SQL_ANALYTIC_TREE_MAX_PAGES, Integer.MAX_VALUE);</span>
<span class="fc" id="L913">            this.sqlTxnScoreboardEntryCount = Numbers.ceilPow2(getInt(properties, env, PropertyKey.CAIRO_O3_TXN_SCOREBOARD_ENTRY_COUNT, 16384));</span>
<span class="fc" id="L914">            this.latestByQueueCapacity = Numbers.ceilPow2(getInt(properties, env, PropertyKey.CAIRO_LATESTBY_QUEUE_CAPACITY, 32));</span>
<span class="fc" id="L915">            this.telemetryEnabled = getBoolean(properties, env, PropertyKey.TELEMETRY_ENABLED, true);</span>
<span class="fc" id="L916">            this.telemetryDisableCompletely = getBoolean(properties, env, PropertyKey.TELEMETRY_DISABLE_COMPLETELY, false);</span>
<span class="fc" id="L917">            this.telemetryQueueCapacity = Numbers.ceilPow2(getInt(properties, env, PropertyKey.TELEMETRY_QUEUE_CAPACITY, 512));</span>
<span class="fc" id="L918">            this.telemetryHideTables = getBoolean(properties, env, PropertyKey.TELEMETRY_HIDE_TABLES, true);</span>
<span class="fc" id="L919">            this.o3PartitionPurgeListCapacity = getInt(properties, env, PropertyKey.CAIRO_O3_PARTITION_PURGE_LIST_INITIAL_CAPACITY, 1);</span>
<span class="fc" id="L920">            this.ioURingEnabled = getBoolean(properties, env, PropertyKey.CAIRO_IO_URING_ENABLED, true);</span>
<span class="fc" id="L921">            this.cairoMaxCrashFiles = getInt(properties, env, PropertyKey.CAIRO_MAX_CRASH_FILES, 100);</span>

<span class="fc" id="L923">            parseBindTo(properties, env, PropertyKey.LINE_UDP_BIND_TO, &quot;0.0.0.0:9009&quot;, (a, p) -&gt; {</span>
<span class="fc" id="L924">                this.lineUdpBindIPV4Address = a;</span>
<span class="fc" id="L925">                this.lineUdpPort = p;</span>
<span class="fc" id="L926">            });</span>

<span class="fc" id="L928">            this.lineUdpGroupIPv4Address = getIPv4Address(properties, env, PropertyKey.LINE_UDP_JOIN, &quot;232.1.2.3&quot;);</span>
<span class="fc" id="L929">            this.lineUdpCommitRate = getInt(properties, env, PropertyKey.LINE_UDP_COMMIT_RATE, 1_000_000);</span>
<span class="fc" id="L930">            this.lineUdpMsgBufferSize = getIntSize(properties, env, PropertyKey.LINE_UDP_MSG_BUFFER_SIZE, 2048);</span>
<span class="fc" id="L931">            this.lineUdpMsgCount = getInt(properties, env, PropertyKey.LINE_UDP_MSG_COUNT, 10_000);</span>
<span class="fc" id="L932">            this.lineUdpReceiveBufferSize = getIntSize(properties, env, PropertyKey.LINE_UDP_RECEIVE_BUFFER_SIZE, 8 * Numbers.SIZE_1MB);</span>
<span class="fc" id="L933">            this.lineUdpEnabled = getBoolean(properties, env, PropertyKey.LINE_UDP_ENABLED, true);</span>
<span class="fc" id="L934">            this.lineUdpOwnThreadAffinity = getInt(properties, env, PropertyKey.LINE_UDP_OWN_THREAD_AFFINITY, -1);</span>
<span class="fc" id="L935">            this.lineUdpOwnThread = getBoolean(properties, env, PropertyKey.LINE_UDP_OWN_THREAD, false);</span>
<span class="fc" id="L936">            this.lineUdpUnicast = getBoolean(properties, env, PropertyKey.LINE_UDP_UNICAST, false);</span>
<span class="fc" id="L937">            this.lineUdpCommitMode = getCommitMode(properties, env, PropertyKey.LINE_UDP_COMMIT_MODE);</span>
<span class="fc" id="L938">            this.lineUdpTimestampAdapter = getLineTimestampAdaptor(properties, env, PropertyKey.LINE_UDP_TIMESTAMP);</span>
<span class="fc" id="L939">            String defaultUdpPartitionByProperty = getString(properties, env, PropertyKey.LINE_DEFAULT_PARTITION_BY, &quot;DAY&quot;);</span>
<span class="fc" id="L940">            this.lineUdpDefaultPartitionBy = PartitionBy.fromString(defaultUdpPartitionByProperty);</span>
<span class="pc bpc" id="L941" title="1 of 2 branches missed.">            if (this.lineUdpDefaultPartitionBy == -1) {</span>
<span class="nc" id="L942">                log.info().$(&quot;invalid partition by &quot;).$(lineUdpDefaultPartitionBy).$(&quot;), will use DAY for UDP&quot;).$();</span>
<span class="nc" id="L943">                this.lineUdpDefaultPartitionBy = PartitionBy.DAY;</span>
            }

<span class="fc" id="L946">            this.lineTcpEnabled = getBoolean(properties, env, PropertyKey.LINE_TCP_ENABLED, true);</span>
<span class="pc bpc" id="L947" title="1 of 2 branches missed.">            if (lineTcpEnabled) {</span>
                // obsolete
<span class="fc" id="L949">                lineTcpNetConnectionLimit = getInt(properties, env, PropertyKey.LINE_TCP_NET_ACTIVE_CONNECTION_LIMIT, 256);</span>
<span class="fc" id="L950">                lineTcpNetConnectionLimit = getInt(properties, env, PropertyKey.LINE_TCP_NET_CONNECTION_LIMIT, lineTcpNetConnectionLimit);</span>
<span class="fc" id="L951">                lineTcpNetConnectionHint = getBoolean(properties, env, PropertyKey.LINE_TCP_NET_CONNECTION_HINT, false);</span>
<span class="fc" id="L952">                parseBindTo(properties, env, PropertyKey.LINE_TCP_NET_BIND_TO, &quot;0.0.0.0:9009&quot;, (a, p) -&gt; {</span>
<span class="fc" id="L953">                    lineTcpNetBindIPv4Address = a;</span>
<span class="fc" id="L954">                    lineTcpNetBindPort = p;</span>
<span class="fc" id="L955">                });</span>

                // deprecated
<span class="fc" id="L958">                this.lineTcpNetConnectionTimeout = getLong(properties, env, PropertyKey.LINE_TCP_NET_IDLE_TIMEOUT, 0);</span>
<span class="fc" id="L959">                this.lineTcpNetConnectionTimeout = getLong(properties, env, PropertyKey.LINE_TCP_NET_CONNECTION_TIMEOUT, this.lineTcpNetConnectionTimeout);</span>

                // deprecated
<span class="fc" id="L962">                this.lineTcpNetConnectionQueueTimeout = getLong(properties, env, PropertyKey.LINE_TCP_NET_QUEUED_TIMEOUT, 5_000);</span>
<span class="fc" id="L963">                this.lineTcpNetConnectionQueueTimeout = getLong(properties, env, PropertyKey.LINE_TCP_NET_CONNECTION_QUEUE_TIMEOUT, this.lineTcpNetConnectionQueueTimeout);</span>

                // deprecated
<span class="fc" id="L966">                this.lineTcpNetConnectionRcvBuf = getIntSize(properties, env, PropertyKey.LINE_TCP_NET_RECV_BUF_SIZE, -1);</span>
<span class="fc" id="L967">                this.lineTcpNetConnectionRcvBuf = getIntSize(properties, env, PropertyKey.LINE_TCP_NET_CONNECTION_RCVBUF, this.lineTcpNetConnectionRcvBuf);</span>

<span class="fc" id="L969">                this.lineTcpConnectionPoolInitialCapacity = getInt(properties, env, PropertyKey.LINE_TCP_CONNECTION_POOL_CAPACITY, 8);</span>
<span class="fc" id="L970">                this.lineTcpTimestampAdapter = getLineTimestampAdaptor(properties, env, PropertyKey.LINE_TCP_TIMESTAMP);</span>
<span class="fc" id="L971">                this.lineTcpMsgBufferSize = getIntSize(properties, env, PropertyKey.LINE_TCP_MSG_BUFFER_SIZE, 32768);</span>
<span class="fc" id="L972">                this.lineTcpMaxMeasurementSize = getIntSize(properties, env, PropertyKey.LINE_TCP_MAX_MEASUREMENT_SIZE, 32768);</span>
<span class="pc bpc" id="L973" title="1 of 2 branches missed.">                if (lineTcpMaxMeasurementSize &gt; lineTcpMsgBufferSize) {</span>
<span class="nc" id="L974">                    throw new IllegalArgumentException(</span>
<span class="nc" id="L975">                            PropertyKey.LINE_TCP_MAX_MEASUREMENT_SIZE.getPropertyPath() + &quot; (&quot; + this.lineTcpMaxMeasurementSize + &quot;) cannot be more than line.tcp.msg.buffer.size (&quot; + this.lineTcpMsgBufferSize + &quot;)&quot;);</span>
                }
<span class="fc" id="L977">                this.lineTcpWriterQueueCapacity = getQueueCapacity(properties, env, PropertyKey.LINE_TCP_WRITER_QUEUE_CAPACITY, 128);</span>
<span class="fc" id="L978">                this.lineTcpWriterWorkerCount = getInt(properties, env, PropertyKey.LINE_TCP_WRITER_WORKER_COUNT, 1);</span>
<span class="fc" id="L979">                cpuUsed += this.lineTcpWriterWorkerCount;</span>
<span class="fc" id="L980">                this.lineTcpWriterWorkerAffinity = getAffinity(properties, env, PropertyKey.LINE_TCP_WRITER_WORKER_AFFINITY, lineTcpWriterWorkerCount);</span>
<span class="fc" id="L981">                this.lineTcpWriterWorkerPoolHaltOnError = getBoolean(properties, env, PropertyKey.LINE_TCP_WRITER_HALT_ON_ERROR, false);</span>
<span class="fc" id="L982">                this.lineTcpWriterWorkerYieldThreshold = getLong(properties, env, PropertyKey.LINE_TCP_WRITER_WORKER_YIELD_THRESHOLD, 10);</span>
<span class="fc" id="L983">                this.lineTcpWriterWorkerSleepThreshold = getLong(properties, env, PropertyKey.LINE_TCP_WRITER_WORKER_SLEEP_THRESHOLD, 10_000);</span>
<span class="fc" id="L984">                this.symbolCacheWaitUsBeforeReload = getLong(properties, env, PropertyKey.LINE_TCP_SYMBOL_CACHE_WAIT_US_BEFORE_RELOAD, 500_000);</span>

                int ilpTcpWorkerCount;
<span class="pc bpc" id="L987" title="1 of 2 branches missed.">                if (cpuAvailable &lt; 9) {</span>
<span class="fc" id="L988">                    ilpTcpWorkerCount = 0;</span>
<span class="nc bnc" id="L989" title="All 2 branches missed.">                } else if (cpuAvailable &lt; 17) {</span>
<span class="nc" id="L990">                    ilpTcpWorkerCount = 2;</span>
                } else {
<span class="nc" id="L992">                    ilpTcpWorkerCount = 6;</span>
                }
<span class="fc" id="L994">                this.lineTcpIOWorkerCount = getInt(properties, env, PropertyKey.LINE_TCP_IO_WORKER_COUNT, ilpTcpWorkerCount);</span>
<span class="fc" id="L995">                cpuUsed += this.lineTcpIOWorkerCount;</span>
<span class="fc" id="L996">                this.lineTcpIOWorkerAffinity = getAffinity(properties, env, PropertyKey.LINE_TCP_IO_WORKER_AFFINITY, lineTcpIOWorkerCount);</span>
<span class="fc" id="L997">                this.lineTcpIOWorkerPoolHaltOnError = getBoolean(properties, env, PropertyKey.LINE_TCP_IO_HALT_ON_ERROR, false);</span>
<span class="fc" id="L998">                this.lineTcpIOWorkerYieldThreshold = getLong(properties, env, PropertyKey.LINE_TCP_IO_WORKER_YIELD_THRESHOLD, 10);</span>
<span class="fc" id="L999">                this.lineTcpIOWorkerSleepThreshold = getLong(properties, env, PropertyKey.LINE_TCP_IO_WORKER_SLEEP_THRESHOLD, 10_000);</span>
<span class="fc" id="L1000">                this.lineTcpMaintenanceInterval = getLong(properties, env, PropertyKey.LINE_TCP_MAINTENANCE_JOB_INTERVAL, 1000);</span>
<span class="fc" id="L1001">                this.lineTcpCommitIntervalFraction = getDouble(properties, env, PropertyKey.LINE_TCP_COMMIT_INTERVAL_FRACTION, 0.5);</span>
<span class="fc" id="L1002">                this.lineTcpCommitIntervalDefault = getLong(properties, env, PropertyKey.LINE_TCP_COMMIT_INTERVAL_DEFAULT, COMMIT_INTERVAL_DEFAULT);</span>
<span class="fc bfc" id="L1003" title="All 2 branches covered.">                if (this.lineTcpCommitIntervalDefault &lt; 1L) {</span>
<span class="fc" id="L1004">                    log.info().$(&quot;invalid default commit interval &quot;).$(lineTcpCommitIntervalDefault).$(&quot;), will use &quot;).$(COMMIT_INTERVAL_DEFAULT).$();</span>
<span class="fc" id="L1005">                    this.lineTcpCommitIntervalDefault = COMMIT_INTERVAL_DEFAULT;</span>
                }
<span class="fc" id="L1007">                this.lineTcpAuthDbPath = getString(properties, env, PropertyKey.LINE_TCP_AUTH_DB_PATH, null);</span>
                // deprecated
<span class="fc" id="L1009">                String defaultTcpPartitionByProperty = getString(properties, env, PropertyKey.LINE_TCP_DEFAULT_PARTITION_BY, &quot;DAY&quot;);</span>
<span class="fc" id="L1010">                defaultTcpPartitionByProperty = getString(properties, env, PropertyKey.LINE_DEFAULT_PARTITION_BY, defaultTcpPartitionByProperty);</span>
<span class="fc" id="L1011">                this.lineTcpDefaultPartitionBy = PartitionBy.fromString(defaultTcpPartitionByProperty);</span>
<span class="pc bpc" id="L1012" title="1 of 2 branches missed.">                if (this.lineTcpDefaultPartitionBy == -1) {</span>
<span class="nc" id="L1013">                    log.info().$(&quot;invalid partition by &quot;).$(defaultTcpPartitionByProperty).$(&quot;), will use DAY for TCP&quot;).$();</span>
<span class="nc" id="L1014">                    this.lineTcpDefaultPartitionBy = PartitionBy.DAY;</span>
                }
<span class="pc bpc" id="L1016" title="1 of 2 branches missed.">                if (null != lineTcpAuthDbPath) {</span>
<span class="nc" id="L1017">                    this.lineTcpAuthDbPath = new File(root, this.lineTcpAuthDbPath).getAbsolutePath();</span>
                }
<span class="fc" id="L1019">                this.minIdleMsBeforeWriterRelease = getLong(properties, env, PropertyKey.LINE_TCP_MIN_IDLE_MS_BEFORE_WRITER_RELEASE, 500);</span>
<span class="fc" id="L1020">                this.lineTcpDisconnectOnError = getBoolean(properties, env, PropertyKey.LINE_TCP_DISCONNECT_ON_ERROR, true);</span>
<span class="fc" id="L1021">                this.stringToCharCastAllowed = getBoolean(properties, env, PropertyKey.LINE_TCP_UNDOCUMENTED_STRING_TO_CHAR_CAST_ALLOWED, false);</span>
<span class="fc" id="L1022">                this.symbolAsFieldSupported = getBoolean(properties, env, PropertyKey.LINE_TCP_UNDOCUMENTED_SYMBOL_AS_FIELD_SUPPORTED, false);</span>
<span class="fc" id="L1023">                this.stringAsTagSupported = getBoolean(properties, env, PropertyKey.LINE_TCP_UNDOCUMENTED_STRING_AS_TAG_SUPPORTED, false);</span>
<span class="fc" id="L1024">                String floatDefaultColumnTypeName = getString(properties, env, PropertyKey.LINE_FLOAT_DEFAULT_COLUMN_TYPE, ColumnType.nameOf(ColumnType.DOUBLE));</span>
<span class="fc" id="L1025">                this.floatDefaultColumnType = ColumnType.tagOf(floatDefaultColumnTypeName);</span>
<span class="fc bfc" id="L1026" title="All 4 branches covered.">                if (floatDefaultColumnType != ColumnType.DOUBLE &amp;&amp; floatDefaultColumnType != ColumnType.FLOAT) {</span>
<span class="fc" id="L1027">                    log.info().$(&quot;invalid default column type for float &quot;).$(floatDefaultColumnTypeName).$(&quot;), will use DOUBLE&quot;).$();</span>
<span class="fc" id="L1028">                    this.floatDefaultColumnType = ColumnType.DOUBLE;</span>
                }
<span class="fc" id="L1030">                String integerDefaultColumnTypeName = getString(properties, env, PropertyKey.LINE_INTEGER_DEFAULT_COLUMN_TYPE, ColumnType.nameOf(ColumnType.LONG));</span>
<span class="fc" id="L1031">                this.integerDefaultColumnType = ColumnType.tagOf(integerDefaultColumnTypeName);</span>
<span class="fc bfc" id="L1032" title="All 8 branches covered.">                if (integerDefaultColumnType != ColumnType.LONG &amp;&amp; integerDefaultColumnType != ColumnType.INT &amp;&amp; integerDefaultColumnType != ColumnType.SHORT &amp;&amp; integerDefaultColumnType != ColumnType.BYTE) {</span>
<span class="fc" id="L1033">                    log.info().$(&quot;invalid default column type for integer &quot;).$(integerDefaultColumnTypeName).$(&quot;), will use LONG&quot;).$();</span>
<span class="fc" id="L1034">                    this.integerDefaultColumnType = ColumnType.LONG;</span>
                }
            }
<span class="fc" id="L1037">            this.ilpAutoCreateNewColumns = getBoolean(properties, env, PropertyKey.LINE_AUTO_CREATE_NEW_COLUMNS, true);</span>
<span class="fc" id="L1038">            this.ilpAutoCreateNewTables = getBoolean(properties, env, PropertyKey.LINE_AUTO_CREATE_NEW_TABLES, true);</span>

<span class="fc" id="L1040">            this.sharedWorkerCount = getInt(properties, env, PropertyKey.SHARED_WORKER_COUNT, Math.max(2, cpuAvailable - cpuSpare - cpuUsed));</span>
<span class="fc" id="L1041">            this.sharedWorkerAffinity = getAffinity(properties, env, PropertyKey.SHARED_WORKER_AFFINITY, sharedWorkerCount);</span>
<span class="fc" id="L1042">            this.sharedWorkerHaltOnError = getBoolean(properties, env, PropertyKey.SHARED_WORKER_HALT_ON_ERROR, false);</span>
<span class="fc" id="L1043">            this.sharedWorkerYieldThreshold = getLong(properties, env, PropertyKey.SHARED_WORKER_YIELD_THRESHOLD, 10);</span>
<span class="fc" id="L1044">            this.sharedWorkerSleepThreshold = getLong(properties, env, PropertyKey.SHARED_WORKER_SLEEP_THRESHOLD, 10_000);</span>
<span class="fc" id="L1045">            this.sharedWorkerSleepTimeout = getLong(properties, env, PropertyKey.SHARED_WORKER_SLEEP_TIMEOUT, 10);</span>

<span class="fc" id="L1047">            this.metricsEnabled = getBoolean(properties, env, PropertyKey.METRICS_ENABLED, false);</span>
<span class="fc" id="L1048">            this.writerAsyncCommandBusyWaitTimeout = getLong(properties, env, PropertyKey.CAIRO_WRITER_ALTER_BUSY_WAIT_TIMEOUT, 500);</span>
<span class="fc" id="L1049">            this.writerAsyncCommandMaxWaitTimeout = getLong(properties, env, PropertyKey.CAIRO_WRITER_ALTER_MAX_WAIT_TIMEOUT, 30_000);</span>
<span class="fc" id="L1050">            this.writerTickRowsCountMod = Numbers.ceilPow2(getInt(properties, env, PropertyKey.CAIRO_WRITER_TICK_ROWS_COUNT, 1024)) - 1;</span>
<span class="fc" id="L1051">            this.writerAsyncCommandQueueCapacity = Numbers.ceilPow2(getInt(properties, env, PropertyKey.CAIRO_WRITER_COMMAND_QUEUE_CAPACITY, 32));</span>
<span class="fc" id="L1052">            this.writerAsyncCommandQueueSlotSize = Numbers.ceilPow2(getLongSize(properties, env, PropertyKey.CAIRO_WRITER_COMMAND_QUEUE_SLOT_SIZE, 2048));</span>

<span class="fc" id="L1054">            this.queryCacheEventQueueCapacity = Numbers.ceilPow2(getInt(properties, env, PropertyKey.CAIRO_QUERY_CACHE_EVENT_QUEUE_CAPACITY, 4));</span>

<span class="fc" id="L1056">            this.buildInformation = buildInformation;</span>
<span class="fc" id="L1057">            this.binaryEncodingMaxLength = getInt(properties, env, PropertyKey.BINARYDATA_ENCODING_MAXLENGTH, 32768);</span>
        }
<span class="fc" id="L1059">    }</span>

    public static String rootSubdir(CharSequence dbRoot, CharSequence subdir) {
<span class="fc bfc" id="L1062" title="All 2 branches covered.">        if (dbRoot != null) {</span>
<span class="fc" id="L1063">            int len = dbRoot.length();</span>
<span class="fc" id="L1064">            int end = len;</span>
<span class="fc" id="L1065">            boolean needsSlash = true;</span>
<span class="pc bpc" id="L1066" title="1 of 2 branches missed.">            for (int i = len - 1; i &gt; -1; --i) {</span>
<span class="fc bfc" id="L1067" title="All 2 branches covered.">                if (dbRoot.charAt(i) == Files.SEPARATOR) {</span>
<span class="fc bfc" id="L1068" title="All 2 branches covered.">                    if (i == len - 1) {</span>
<span class="fc" id="L1069">                        continue;</span>
                    }
<span class="fc" id="L1071">                    end = i + 1;</span>
<span class="fc" id="L1072">                    needsSlash = false;</span>
<span class="fc" id="L1073">                    break;</span>
                }
            }
<span class="fc" id="L1076">            StringSink sink = Misc.getThreadLocalBuilder();</span>
<span class="fc" id="L1077">            sink.put(dbRoot, 0, end);</span>
<span class="pc bpc" id="L1078" title="1 of 2 branches missed.">            if (needsSlash) {</span>
<span class="nc" id="L1079">                sink.put(Files.SEPARATOR);</span>
            }
<span class="fc" id="L1081">            return sink.put(subdir).toString();</span>
        }
<span class="fc" id="L1083">        return null;</span>
    }

    @Override
    public CairoConfiguration getCairoConfiguration() {
<span class="fc" id="L1088">        return cairoConfiguration;</span>
    }

    @Override
    public HttpMinServerConfiguration getHttpMinServerConfiguration() {
<span class="fc" id="L1093">        return httpMinServerConfiguration;</span>
    }

    @Override
    public HttpServerConfiguration getHttpServerConfiguration() {
<span class="fc" id="L1098">        return httpServerConfiguration;</span>
    }

    @Override
    public LineTcpReceiverConfiguration getLineTcpReceiverConfiguration() {
<span class="fc" id="L1103">        return lineTcpReceiverConfiguration;</span>
    }

    @Override
    public LineUdpReceiverConfiguration getLineUdpReceiverConfiguration() {
<span class="fc" id="L1108">        return lineUdpReceiverConfiguration;</span>
    }

    @Override
    public MetricsConfiguration getMetricsConfiguration() {
<span class="fc" id="L1113">        return metricsConfiguration;</span>
    }

    @Override
    public PGWireConfiguration getPGWireConfiguration() {
<span class="fc" id="L1118">        return pgWireConfiguration;</span>
    }

    @Override
    public WorkerPoolConfiguration getWalApplyPoolConfiguration() {
<span class="fc" id="L1123">        return walApplyPoolConfiguration;</span>
    }

    @Override
    public WorkerPoolConfiguration getWorkerPoolConfiguration() {
<span class="fc" id="L1128">        return sharedWorkerPoolConfiguration;</span>
    }

    private static void registerDeprecated(PropertyKey old, PropertyKey... replacements) {
<span class="fc" id="L1132">        registerReplacements(DEPRECATED_SETTINGS, old, replacements);</span>
<span class="fc" id="L1133">    }</span>

    private static void registerObsolete(String old, PropertyKey... replacements) {
<span class="fc" id="L1136">        registerReplacements(OBSOLETE_SETTINGS, old, replacements);</span>
<span class="fc" id="L1137">    }</span>

    private static &lt;KeyT&gt; void registerReplacements(
            Map&lt;KeyT, String&gt; map,
            KeyT old,
            PropertyKey... replacements) {
<span class="fc" id="L1143">        StringBuilder sb = new StringBuilder(&quot;Replaced by &quot;);</span>
<span class="fc bfc" id="L1144" title="All 2 branches covered.">        for (int index = 0; index &lt; replacements.length; ++index) {</span>
<span class="fc bfc" id="L1145" title="All 2 branches covered.">            if (index &gt; 0) {</span>
<span class="pc bpc" id="L1146" title="1 of 2 branches missed.">                sb.append(index &lt; (replacements.length - 1)</span>
<span class="nc" id="L1147">                        ? &quot;, &quot;</span>
<span class="fc" id="L1148">                        : &quot; and &quot;);</span>
            }
<span class="fc" id="L1150">            String replacement = replacements[index].getPropertyPath();</span>
<span class="fc" id="L1151">            sb.append('`');</span>
<span class="fc" id="L1152">            sb.append(replacement);</span>
<span class="fc" id="L1153">            sb.append('`');</span>
        }
<span class="fc" id="L1155">        map.put(old, sb.toString());</span>
<span class="fc" id="L1156">    }</span>

    private int[] getAffinity(Properties properties, @Nullable Map&lt;String, String&gt; env, PropertyKey key, int workerCount) throws ServerConfigurationException {
<span class="fc" id="L1159">        final int[] result = new int[workerCount];</span>
<span class="fc" id="L1160">        String value = overrideWithEnv(properties, env, key);</span>
<span class="fc bfc" id="L1161" title="All 2 branches covered.">        if (value == null) {</span>
<span class="fc" id="L1162">            Arrays.fill(result, -1);</span>
        } else {
<span class="fc" id="L1164">            String[] affinity = value.split(&quot;,&quot;);</span>
<span class="pc bpc" id="L1165" title="1 of 2 branches missed.">            if (affinity.length != workerCount) {</span>
<span class="nc" id="L1166">                throw ServerConfigurationException.forInvalidKey(key.getPropertyPath(), &quot;wrong number of affinity values&quot;);</span>
            }
<span class="fc bfc" id="L1168" title="All 2 branches covered.">            for (int i = 0; i &lt; workerCount; i++) {</span>
                try {
<span class="fc" id="L1170">                    result[i] = Numbers.parseInt(affinity[i]);</span>
<span class="nc" id="L1171">                } catch (NumericException e) {</span>
<span class="nc" id="L1172">                    throw ServerConfigurationException.forInvalidKey(key.getPropertyPath(), &quot;Invalid affinity value: &quot; + affinity[i]);</span>
<span class="fc" id="L1173">                }</span>
            }
        }
<span class="fc" id="L1176">        return result;</span>
    }

    private int getCommitMode(Properties properties, @Nullable Map&lt;String, String&gt; env, PropertyKey key) {
<span class="fc" id="L1180">        final String commitMode = overrideWithEnv(properties, env, key);</span>

<span class="fc bfc" id="L1182" title="All 2 branches covered.">        if (commitMode == null) {</span>
<span class="fc" id="L1183">            return CommitMode.NOSYNC;</span>
        }

<span class="pc bpc" id="L1186" title="1 of 2 branches missed.">        if (Chars.equalsLowerCaseAscii(commitMode, &quot;nosync&quot;)) {</span>
<span class="nc" id="L1187">            return CommitMode.NOSYNC;</span>
        }

<span class="pc bpc" id="L1190" title="1 of 2 branches missed.">        if (Chars.equalsLowerCaseAscii(commitMode, &quot;async&quot;)) {</span>
<span class="fc" id="L1191">            return CommitMode.ASYNC;</span>
        }

<span class="nc bnc" id="L1194" title="All 2 branches missed.">        if (Chars.equalsLowerCaseAscii(commitMode, &quot;sync&quot;)) {</span>
<span class="nc" id="L1195">            return CommitMode.SYNC;</span>
        }

<span class="nc" id="L1198">        return CommitMode.NOSYNC;</span>
    }

    private double getDouble(Properties properties, @Nullable Map&lt;String, String&gt; env, PropertyKey key, double defaultValue) throws ServerConfigurationException {
<span class="fc" id="L1202">        final String value = overrideWithEnv(properties, env, key);</span>
        try {
<span class="fc bfc" id="L1204" title="All 2 branches covered.">            return value != null ? Numbers.parseDouble(value) : defaultValue;</span>
<span class="fc" id="L1205">        } catch (NumericException e) {</span>
<span class="fc" id="L1206">            throw ServerConfigurationException.forInvalidKey(key.getPropertyPath(), value);</span>
        }
    }

    private int getInt(Properties properties, @Nullable Map&lt;String, String&gt; env, PropertyKey key, int defaultValue) throws ServerConfigurationException {
<span class="fc" id="L1211">        final String value = overrideWithEnv(properties, env, key);</span>
        try {
<span class="fc bfc" id="L1213" title="All 2 branches covered.">            return value != null ? Numbers.parseInt(value) : defaultValue;</span>
<span class="fc" id="L1214">        } catch (NumericException e) {</span>
<span class="fc" id="L1215">            throw ServerConfigurationException.forInvalidKey(key.getPropertyPath(), value);</span>
        }
    }

    private LineProtoTimestampAdapter getLineTimestampAdaptor(Properties properties, Map&lt;String, String&gt; env, PropertyKey propNm) {
<span class="fc" id="L1220">        final String lineUdpTimestampSwitch = getString(properties, env, propNm, &quot;n&quot;);</span>
<span class="fc bfc" id="L1221" title="All 6 branches covered.">        switch (lineUdpTimestampSwitch) {</span>
            case &quot;u&quot;:
<span class="fc" id="L1223">                return LineProtoMicroTimestampAdapter.INSTANCE;</span>
            case &quot;ms&quot;:
<span class="fc" id="L1225">                return LineProtoMilliTimestampAdapter.INSTANCE;</span>
            case &quot;s&quot;:
<span class="fc" id="L1227">                return LineProtoSecondTimestampAdapter.INSTANCE;</span>
            case &quot;m&quot;:
<span class="fc" id="L1229">                return LineProtoMinuteTimestampAdapter.INSTANCE;</span>
            case &quot;h&quot;:
<span class="fc" id="L1231">                return LineProtoHourTimestampAdapter.INSTANCE;</span>
            default:
<span class="fc" id="L1233">                return LineProtoNanoTimestampAdapter.INSTANCE;</span>
        }
    }

    private long getLong(Properties properties, @Nullable Map&lt;String, String&gt; env, PropertyKey key, long defaultValue) throws ServerConfigurationException {
<span class="fc" id="L1238">        final String value = overrideWithEnv(properties, env, key);</span>
        try {
<span class="fc bfc" id="L1240" title="All 2 branches covered.">            return value != null ? Numbers.parseLong(value) : defaultValue;</span>
<span class="fc" id="L1241">        } catch (NumericException e) {</span>
<span class="fc" id="L1242">            throw ServerConfigurationException.forInvalidKey(key.getPropertyPath(), value);</span>
        }
    }

    private long getLongSize(Properties properties, @Nullable Map&lt;String, String&gt; env, PropertyKey key, long defaultValue) throws ServerConfigurationException {
<span class="fc" id="L1247">        final String value = overrideWithEnv(properties, env, key);</span>
        try {
<span class="fc bfc" id="L1249" title="All 2 branches covered.">            return value != null ? Numbers.parseLongSize(value) : defaultValue;</span>
<span class="nc" id="L1250">        } catch (NumericException e) {</span>
<span class="nc" id="L1251">            throw ServerConfigurationException.forInvalidKey(key.getPropertyPath(), value);</span>
        }
    }

    private int getQueueCapacity(Properties properties, @Nullable Map&lt;String, String&gt; env, PropertyKey key, int defaultValue) throws ServerConfigurationException {
<span class="fc" id="L1256">        final int value = getInt(properties, env, key, defaultValue);</span>
<span class="pc bpc" id="L1257" title="1 of 2 branches missed.">        if (!Numbers.isPow2(value)) {</span>
<span class="nc" id="L1258">            throw ServerConfigurationException.forInvalidKey(key.getPropertyPath(), &quot;Value must be power of 2, e.g. 1,2,4,8,16,32,64...&quot;);</span>
        }
<span class="fc" id="L1260">        return value;</span>
    }

    private int getSqlJitMode(Properties properties, @Nullable Map&lt;String, String&gt; env) {
<span class="fc" id="L1264">        final String jitMode = overrideWithEnv(properties, env, PropertyKey.CAIRO_SQL_JIT_MODE);</span>

<span class="fc bfc" id="L1266" title="All 2 branches covered.">        if (jitMode == null) {</span>
<span class="fc" id="L1267">            return SqlJitMode.JIT_MODE_ENABLED;</span>
        }

<span class="fc bfc" id="L1270" title="All 2 branches covered.">        if (Chars.equalsLowerCaseAscii(jitMode, &quot;on&quot;)) {</span>
<span class="fc" id="L1271">            return SqlJitMode.JIT_MODE_ENABLED;</span>
        }

<span class="fc bfc" id="L1274" title="All 2 branches covered.">        if (Chars.equalsLowerCaseAscii(jitMode, &quot;off&quot;)) {</span>
<span class="fc" id="L1275">            return SqlJitMode.JIT_MODE_DISABLED;</span>
        }

<span class="fc bfc" id="L1278" title="All 2 branches covered.">        if (Chars.equalsLowerCaseAscii(jitMode, &quot;scalar&quot;)) {</span>
<span class="fc" id="L1279">            return SqlJitMode.JIT_MODE_FORCE_SCALAR;</span>
        }

<span class="fc" id="L1282">        return SqlJitMode.JIT_MODE_ENABLED;</span>
    }

    private String getString(Properties properties, @Nullable Map&lt;String, String&gt; env, PropertyKey key, String defaultValue) {
<span class="fc" id="L1286">        String value = overrideWithEnv(properties, env, key);</span>
<span class="fc bfc" id="L1287" title="All 2 branches covered.">        if (value == null) {</span>
<span class="fc" id="L1288">            return defaultValue;</span>
        }
<span class="fc" id="L1290">        return value;</span>
    }

    private DateFormat getTimestampFormat(Properties properties, @Nullable Map&lt;String, String&gt; env) {
<span class="fc" id="L1294">        final String pattern = overrideWithEnv(properties, env, PropertyKey.CAIRO_SQL_BACKUP_DIR_DATETIME_FORMAT);</span>
<span class="fc" id="L1295">        TimestampFormatCompiler compiler = new TimestampFormatCompiler();</span>
        //noinspection ReplaceNullCheck
<span class="pc bpc" id="L1297" title="1 of 2 branches missed.">        if (null != pattern) {</span>
<span class="nc" id="L1298">            return compiler.compile(pattern);</span>
        }
<span class="fc" id="L1300">        return compiler.compile(&quot;yyyy-MM-dd&quot;);</span>
    }

    private String overrideWithEnv(Properties properties, @Nullable Map&lt;String, String&gt; env, PropertyKey key) {
<span class="fc" id="L1304">        String envCandidate = &quot;QDB_&quot; + key.getPropertyPath().replace('.', '_').toUpperCase();</span>
<span class="fc bfc" id="L1305" title="All 2 branches covered.">        String envValue = env != null ? env.get(envCandidate) : null;</span>
<span class="fc bfc" id="L1306" title="All 2 branches covered.">        if (envValue != null) {</span>
<span class="fc" id="L1307">            log.info().$(&quot;env config [key=&quot;).$(envCandidate).I$();</span>
<span class="fc" id="L1308">            return envValue;</span>
        }
<span class="fc" id="L1310">        return properties.getProperty(key.getPropertyPath());</span>
    }

    private boolean pathEquals(String p1, String p2) {
        try {
<span class="pc bpc" id="L1315" title="1 of 4 branches missed.">            if (p1 == null || p2 == null) {</span>
<span class="fc" id="L1316">                return false;</span>
            }
            //unfortunately java.io.Files.isSameFile() doesn't work on files that don't exist
<span class="fc" id="L1319">            return new File(p1).getCanonicalPath().replace(File.separatorChar, '/')</span>
<span class="fc" id="L1320">                    .equals(new File(p2).getCanonicalPath().replace(File.separatorChar, '/'));</span>
<span class="nc" id="L1321">        } catch (IOException e) {</span>
<span class="nc" id="L1322">            log.info().$(&quot;Can't validate configuration property [key=&quot;).$(PropertyKey.CAIRO_SQL_COPY_WORK_ROOT.getPropertyPath())</span>
<span class="nc" id="L1323">                    .$(&quot;, value=&quot;).$(p2).$(&quot;]&quot;);</span>
<span class="nc" id="L1324">            return false;</span>
        }
    }

    private void validateProperties(Properties properties, boolean configValidationStrict) throws ServerConfigurationException {
<span class="fc" id="L1329">        ValidationResult validation = validate(properties);</span>
<span class="fc bfc" id="L1330" title="All 2 branches covered.">        if (validation != null) {</span>
<span class="fc bfc" id="L1331" title="All 4 branches covered.">            if (validation.isError &amp;&amp; configValidationStrict) {</span>
<span class="fc" id="L1332">                throw new ServerConfigurationException(validation.message);</span>
            } else {
<span class="fc" id="L1334">                log.advisory().$(validation.message).$();</span>
            }
        }
<span class="fc" id="L1337">    }</span>

    static ValidationResult validate(Properties properties) {
        // Settings that used to be valid but no longer are.
<span class="fc" id="L1341">        Map&lt;String, String&gt; obsolete = new HashMap&lt;&gt;();</span>

        // Settings that are still valid but are now superseded by newer ones.
<span class="fc" id="L1344">        Map&lt;String, String&gt; deprecated = new HashMap&lt;&gt;();</span>

        // Settings that are not recognized.
<span class="fc" id="L1347">        Set&lt;String&gt; incorrect = new HashSet&lt;&gt;();</span>

<span class="fc bfc" id="L1349" title="All 2 branches covered.">        for (String propName : properties.stringPropertyNames()) {</span>
<span class="fc" id="L1350">            Optional&lt;PropertyKey&gt; prop = PropertyKey.getByString(propName);</span>
<span class="fc bfc" id="L1351" title="All 2 branches covered.">            if (prop.isPresent()) {</span>
<span class="fc" id="L1352">                String deprecationMsg = DEPRECATED_SETTINGS.get(prop.get());</span>
<span class="fc bfc" id="L1353" title="All 2 branches covered.">                if (deprecationMsg != null) {</span>
<span class="fc" id="L1354">                    deprecated.put(propName, deprecationMsg);</span>
                }
<span class="fc" id="L1356">            } else {</span>
<span class="fc" id="L1357">                String obsoleteMsg = OBSOLETE_SETTINGS.get(propName);</span>
<span class="fc bfc" id="L1358" title="All 2 branches covered.">                if (obsoleteMsg != null) {</span>
<span class="fc" id="L1359">                    obsolete.put(propName, obsoleteMsg);</span>
                } else {
<span class="fc" id="L1361">                    incorrect.add(propName);</span>
                }
            }
<span class="fc" id="L1364">        }</span>

<span class="fc bfc" id="L1366" title="All 6 branches covered.">        if (obsolete.isEmpty() &amp;&amp; deprecated.isEmpty() &amp;&amp; incorrect.isEmpty()) {</span>
<span class="fc" id="L1367">            return null;</span>
        }

<span class="fc" id="L1370">        boolean isError = false;</span>

<span class="fc" id="L1372">        StringBuilder sb = new StringBuilder(&quot;Configuration issues:\n&quot;);</span>

<span class="fc bfc" id="L1374" title="All 2 branches covered.">        if (!incorrect.isEmpty()) {</span>
<span class="fc" id="L1375">            isError = true;</span>
<span class="fc" id="L1376">            sb.append(&quot;    Invalid settings (not recognized, probable typos):\n&quot;);</span>
<span class="fc bfc" id="L1377" title="All 2 branches covered.">            for (String key : incorrect) {</span>
<span class="fc" id="L1378">                sb.append(&quot;        * &quot;);</span>
<span class="fc" id="L1379">                sb.append(key);</span>
<span class="fc" id="L1380">                sb.append('\n');</span>
<span class="fc" id="L1381">            }</span>
        }

<span class="fc bfc" id="L1384" title="All 2 branches covered.">        if (!obsolete.isEmpty()) {</span>
<span class="fc" id="L1385">            isError = true;</span>
<span class="fc" id="L1386">            sb.append(&quot;    Obsolete settings (no longer recognized):\n&quot;);</span>
<span class="fc bfc" id="L1387" title="All 2 branches covered.">            for (Map.Entry&lt;String, String&gt; entry : obsolete.entrySet()) {</span>
<span class="fc" id="L1388">                sb.append(&quot;        * &quot;);</span>
<span class="fc" id="L1389">                sb.append(entry.getKey());</span>
<span class="fc" id="L1390">                sb.append(&quot;: &quot;);</span>
<span class="fc" id="L1391">                sb.append(entry.getValue());</span>
<span class="fc" id="L1392">                sb.append('\n');</span>
<span class="fc" id="L1393">            }</span>
        }

<span class="fc bfc" id="L1396" title="All 2 branches covered.">        if (!deprecated.isEmpty()) {</span>
<span class="fc" id="L1397">            sb.append(&quot;    Deprecated settings (recognized but superseded by newer settings):\n&quot;);</span>
<span class="fc bfc" id="L1398" title="All 2 branches covered.">            for (Map.Entry&lt;String, String&gt; entry : deprecated.entrySet()) {</span>
<span class="fc" id="L1399">                sb.append(&quot;        * &quot;);</span>
<span class="fc" id="L1400">                sb.append(entry.getKey());</span>
<span class="fc" id="L1401">                sb.append(&quot;: &quot;);</span>
<span class="fc" id="L1402">                sb.append(entry.getValue());</span>
<span class="fc" id="L1403">                sb.append('\n');</span>
<span class="fc" id="L1404">            }</span>
        }

<span class="fc" id="L1407">        return new ValidationResult(isError, sb.toString());</span>
    }

    protected boolean getBoolean(Properties properties, @Nullable Map&lt;String, String&gt; env, PropertyKey key, boolean defaultValue) {
<span class="fc" id="L1411">        final String value = overrideWithEnv(properties, env, key);</span>
<span class="fc bfc" id="L1412" title="All 2 branches covered.">        return value == null ? defaultValue : Boolean.parseBoolean(value);</span>
    }

    String getCanonicalPath(String path) throws ServerConfigurationException {
        try {
<span class="fc" id="L1417">            return new File(path).getCanonicalPath();</span>
<span class="nc" id="L1418">        } catch (IOException e) {</span>
<span class="nc" id="L1419">            throw new ServerConfigurationException(&quot;Cannot calculate canonical path for configuration property [key=&quot; + PropertyKey.CAIRO_SQL_COPY_WORK_ROOT.getPropertyPath() + &quot;,value=&quot; + path + &quot;]&quot;);</span>
        }
    }

    @SuppressWarnings(&quot;SameParameterValue&quot;)
    protected int getIPv4Address(Properties properties, Map&lt;String, String&gt; env, PropertyKey key, String defaultValue) throws ServerConfigurationException {
<span class="fc" id="L1425">        final String value = getString(properties, env, key, defaultValue);</span>
        try {
<span class="fc" id="L1427">            return Net.parseIPv4(value);</span>
<span class="fc" id="L1428">        } catch (NetworkError e) {</span>
<span class="fc" id="L1429">            throw ServerConfigurationException.forInvalidKey(key.getPropertyPath(), value);</span>
        }
    }

    protected int getIntSize(Properties properties, @Nullable Map&lt;String, String&gt; env, PropertyKey key, int defaultValue) throws ServerConfigurationException {
<span class="fc" id="L1434">        final String value = overrideWithEnv(properties, env, key);</span>
        try {
<span class="fc bfc" id="L1436" title="All 2 branches covered.">            return value != null ? Numbers.parseIntSize(value) : defaultValue;</span>
<span class="fc" id="L1437">        } catch (NumericException e) {</span>
<span class="fc" id="L1438">            throw ServerConfigurationException.forInvalidKey(key.getPropertyPath(), value);</span>
        }
    }

    protected void parseBindTo(
            Properties properties,
            Map&lt;String, String&gt; env,
            PropertyKey key,
            String defaultValue,
            BindToParser parser
    ) throws ServerConfigurationException {

<span class="fc" id="L1450">        final String bindTo = getString(properties, env, key, defaultValue);</span>
<span class="fc" id="L1451">        final int colonIndex = bindTo.indexOf(':');</span>
<span class="fc bfc" id="L1452" title="All 2 branches covered.">        if (colonIndex == -1) {</span>
<span class="fc" id="L1453">            throw ServerConfigurationException.forInvalidKey(key.getPropertyPath(), bindTo);</span>
        }

<span class="fc" id="L1456">        final String ipv4Str = bindTo.substring(0, colonIndex);</span>
        final int ipv4;
        try {
<span class="fc" id="L1459">            ipv4 = Net.parseIPv4(ipv4Str);</span>
<span class="fc" id="L1460">        } catch (NetworkError e) {</span>
<span class="fc" id="L1461">            throw ServerConfigurationException.forInvalidKey(key.getPropertyPath(), ipv4Str);</span>
<span class="fc" id="L1462">        }</span>

<span class="fc" id="L1464">        final String portStr = bindTo.substring(colonIndex + 1);</span>
        final int port;
        try {
<span class="fc" id="L1467">            port = Numbers.parseInt(portStr);</span>
<span class="fc" id="L1468">        } catch (NumericException e) {</span>
<span class="fc" id="L1469">            throw ServerConfigurationException.forInvalidKey(key.getPropertyPath(), portStr);</span>
<span class="fc" id="L1470">        }</span>

<span class="fc" id="L1472">        parser.onReady(ipv4, port);</span>
<span class="fc" id="L1473">    }</span>

    @FunctionalInterface
    protected interface BindToParser {
        void onReady(int address, int port);
    }

    static class ValidationResult {
        final boolean isError;
        final String message;

<span class="fc" id="L1484">        private ValidationResult(boolean isError, String message) {</span>
<span class="fc" id="L1485">            this.isError = isError;</span>
<span class="fc" id="L1486">            this.message = message;</span>
<span class="fc" id="L1487">        }</span>
    }

<span class="fc" id="L1490">    class PropCairoConfiguration implements CairoConfiguration {</span>

        @Override
        public boolean attachPartitionCopy() {
<span class="fc" id="L1494">            return cairoAttachPartitionCopy;</span>
        }

        @Override
        public boolean enableTestFactories() {
<span class="fc" id="L1499">            return false;</span>
        }

        @Override
        public boolean getAllowTableRegistrySharedWrite() {
<span class="nc" id="L1504">            return false;</span>
        }

        @Override
        public int getAnalyticColumnPoolCapacity() {
<span class="fc" id="L1509">            return sqlAnalyticColumnPoolCapacity;</span>
        }

        @Override
        public String getAttachPartitionSuffix() {
<span class="fc" id="L1514">            return cairoAttachPartitionSuffix;</span>
        }

        @Override
        public DateFormat getBackupDirTimestampFormat() {
<span class="nc" id="L1519">            return backupDirTimestampFormat;</span>
        }

        @Override
        public int getBackupMkDirMode() {
<span class="nc" id="L1524">            return backupMkdirMode;</span>
        }

        @Override
        public CharSequence getBackupRoot() {
<span class="fc" id="L1529">            return backupRoot;</span>
        }

        @Override
        public CharSequence getBackupTempDirName() {
<span class="nc" id="L1534">            return backupTempDirName;</span>
        }

        @Override
        public int getBinaryEncodingMaxLength() {
<span class="nc" id="L1539">            return binaryEncodingMaxLength;</span>
        }

        @Override
        public int getBindVariablePoolSize() {
<span class="fc" id="L1544">            return sqlBindVariablePoolSize;</span>
        }

        @Override
        public BuildInformation getBuildInformation() {
<span class="fc" id="L1549">            return buildInformation;</span>
        }

        @Override
        public SqlExecutionCircuitBreakerConfiguration getCircuitBreakerConfiguration() {
<span class="fc" id="L1554">            return circuitBreakerConfiguration;</span>
        }

        @Override
        public int getColumnCastModelPoolCapacity() {
<span class="fc" id="L1559">            return sqlColumnCastModelPoolCapacity;</span>
        }

        @Override
        public int getColumnIndexerQueueCapacity() {
<span class="fc" id="L1564">            return columnIndexerQueueCapacity;</span>
        }

        @Override
        public int getColumnPurgeQueueCapacity() {
<span class="fc" id="L1569">            return columnPurgeQueueCapacity;</span>
        }

        @Override
        public long getColumnPurgeRetryDelay() {
<span class="fc" id="L1574">            return columnPurgeRetryDelay;</span>
        }

        @Override
        public long getColumnPurgeRetryDelayLimit() {
<span class="fc" id="L1579">            return columnPurgeRetryDelayLimit;</span>
        }

        @Override
        public double getColumnPurgeRetryDelayMultiplier() {
<span class="fc" id="L1584">            return columnPurgeRetryDelayMultiplier;</span>
        }

        @Override
        public int getColumnPurgeTaskPoolCapacity() {
<span class="fc" id="L1589">            return columnPurgeTaskPoolCapacity;</span>
        }

        @Override
        public int getCommitMode() {
<span class="fc" id="L1594">            return commitMode;</span>
        }

        @Override
        public CharSequence getConfRoot() {
<span class="fc" id="L1599">            return confRoot;</span>
        }

        @Override
        public int getCopyPoolCapacity() {
<span class="fc" id="L1604">            return sqlCopyModelPoolCapacity;</span>
        }

        @Override
        public int getCreateAsSelectRetryCount() {
<span class="fc" id="L1609">            return createAsSelectRetryCount;</span>
        }

        @Override
        public int getCreateTableModelPoolCapacity() {
<span class="fc" id="L1614">            return sqlCreateTableModelPoolCapacity;</span>
        }

        @Override
        public long getDataAppendPageSize() {
<span class="fc" id="L1619">            return writerDataAppendPageSize;</span>
        }

        @Override
        public long getDataIndexKeyAppendPageSize() {
<span class="fc" id="L1624">            return writerDataIndexKeyAppendPageSize;</span>
        }

        @Override
        public long getDataIndexValueAppendPageSize() {
<span class="fc" id="L1629">            return writerDataIndexValueAppendPageSize;</span>
        }

        @Override
        public long getDatabaseIdHi() {
<span class="fc" id="L1634">            return instanceHashHi;</span>
        }

        @Override
        public long getDatabaseIdLo() {
<span class="fc" id="L1639">            return instanceHashLo;</span>
        }

        @Override
        public CharSequence getDbDirectory() {
<span class="fc" id="L1644">            return dbDirectory;</span>
        }

        @Override
        public DateLocale getDefaultDateLocale() {
<span class="nc" id="L1649">            return locale;</span>
        }

        @Override
        public CharSequence getDefaultMapType() {
<span class="fc" id="L1654">            return defaultMapType;</span>
        }

        @Override
        public boolean getDefaultSymbolCacheFlag() {
<span class="fc" id="L1659">            return defaultSymbolCacheFlag;</span>
        }

        @Override
        public int getDefaultSymbolCapacity() {
<span class="fc" id="L1664">            return defaultSymbolCapacity;</span>
        }

        @Override
        public int getDoubleToStrCastScale() {
<span class="fc" id="L1669">            return sqlDoubleToStrCastScale;</span>
        }

        @Override
        public int getExplainPoolCapacity() {
<span class="fc" id="L1674">            return sqlExplainModelPoolCapacity;</span>
        }

        @Override
        public int getFileOperationRetryCount() {
<span class="fc" id="L1679">            return fileOperationRetryCount;</span>
        }

        @Override
        public FilesFacade getFilesFacade() {
<span class="fc" id="L1684">            return FilesFacadeImpl.INSTANCE;</span>
        }

        @Override
        public int getFloatToStrCastScale() {
<span class="fc" id="L1689">            return sqlFloatToStrCastScale;</span>
        }

        @Override
        public int getGroupByMapCapacity() {
<span class="nc" id="L1694">            return sqlGroupByMapCapacity;</span>
        }

        @Override
        public int getGroupByPoolCapacity() {
<span class="fc" id="L1699">            return sqlGroupByPoolCapacity;</span>
        }

        @Override
        public long getIdleCheckInterval() {
<span class="fc" id="L1704">            return idleCheckInterval;</span>
        }

        @Override
        public long getInactiveReaderTTL() {
<span class="fc" id="L1709">            return inactiveReaderTTL;</span>
        }

        @Override
        public long getInactiveWalWriterTTL() {
<span class="fc" id="L1714">            return inactiveWalWriterTTL;</span>
        }

        @Override
        public long getInactiveWriterTTL() {
<span class="fc" id="L1719">            return inactiveWriterTTL;</span>
        }

        @Override
        public int getIndexValueBlockSize() {
<span class="fc" id="L1724">            return indexValueBlockSize;</span>
        }

        @Override
        public int getInsertPoolCapacity() {
<span class="fc" id="L1729">            return sqlInsertModelPoolCapacity;</span>
        }

        @Override
        public int getLatestByQueueCapacity() {
<span class="fc" id="L1734">            return latestByQueueCapacity;</span>
        }

        @Override
        public int getMaxCrashFiles() {
<span class="fc" id="L1739">            return cairoMaxCrashFiles;</span>
        }

        @Override
        public int getMaxFileNameLength() {
<span class="fc" id="L1744">            return maxFileNameLength;</span>
        }

        @Override
        public int getMaxSwapFileCount() {
<span class="fc" id="L1749">            return maxSwapFileCount;</span>
        }

        @Override
        public int getMaxSymbolNotEqualsCount() {
<span class="nc" id="L1754">            return sqlMaxSymbolNotEqualsCount;</span>
        }

        @Override
        public int getMaxUncommittedRows() {
<span class="fc" id="L1759">            return maxUncommittedRows;</span>
        }

        @Override
        public int getMetadataPoolCapacity() {
<span class="nc" id="L1764">            return sqlModelPoolCapacity;</span>
        }

        @Override
        public long getMiscAppendPageSize() {
<span class="fc" id="L1769">            return writerMiscAppendPageSize;</span>
        }

        @Override
        public int getMkDirMode() {
<span class="fc" id="L1774">            return mkdirMode;</span>
        }

        @Override
        public int getO3CallbackQueueCapacity() {
<span class="fc" id="L1779">            return o3CallbackQueueCapacity;</span>
        }

        @Override
        public int getO3ColumnMemorySize() {
<span class="fc" id="L1784">            return o3ColumnMemorySize;</span>
        }

        @Override
        public int getO3CopyQueueCapacity() {
<span class="fc" id="L1789">            return o3CopyQueueCapacity;</span>
        }

        @Override
        public long getO3MaxLag() {
<span class="fc" id="L1794">            return o3MaxLag;</span>
        }

        @Override
        public long getO3MinLag() {
<span class="fc" id="L1799">            return o3MinLagUs;</span>
        }

        @Override
        public int getO3OpenColumnQueueCapacity() {
<span class="fc" id="L1804">            return o3OpenColumnQueueCapacity;</span>
        }

        @Override
        public int getO3PartitionQueueCapacity() {
<span class="fc" id="L1809">            return o3PartitionQueueCapacity;</span>
        }

        @Override
        public int getO3PurgeDiscoveryQueueCapacity() {
<span class="fc" id="L1814">            return o3PurgeDiscoveryQueueCapacity;</span>
        }

        @Override
        public int getPageFrameReduceColumnListCapacity() {
<span class="fc" id="L1819">            return cairoPageFrameReduceColumnListCapacity;</span>
        }

        @Override
        public int getPageFrameReduceQueueCapacity() {
<span class="fc" id="L1824">            return cairoPageFrameReduceQueueCapacity;</span>
        }

        @Override
        public int getPageFrameReduceRowIdListCapacity() {
<span class="fc" id="L1829">            return cairoPageFrameReduceRowIdListCapacity;</span>
        }

        @Override
        public int getPageFrameReduceShardCount() {
<span class="fc" id="L1834">            return cairoPageFrameReduceShardCount;</span>
        }

        @Override
        public int getPageFrameReduceTaskPoolCapacity() {
<span class="fc" id="L1839">            return cairoPageFrameReduceTaskPoolCapacity;</span>
        }

        @Override
        public int getParallelIndexThreshold() {
<span class="fc" id="L1844">            return parallelIndexThreshold;</span>
        }

        @Override
        public int getPartitionPurgeListCapacity() {
<span class="fc" id="L1849">            return o3PartitionPurgeListCapacity;</span>
        }

        @Override
        public int getQueryCacheEventQueueCapacity() {
<span class="fc" id="L1854">            return queryCacheEventQueueCapacity;</span>
        }

        @Override
        public int getReaderPoolMaxSegments() {
<span class="fc" id="L1859">            return readerPoolMaxSegments;</span>
        }

        @Override
        public int getRenameTableModelPoolCapacity() {
<span class="fc" id="L1864">            return sqlRenameTableModelPoolCapacity;</span>
        }

        @Override
        public int getRndFunctionMemoryMaxPages() {
<span class="fc" id="L1869">            return rndFunctionMemoryMaxPages;</span>
        }

        @Override
        public int getRndFunctionMemoryPageSize() {
<span class="fc" id="L1874">            return rndFunctionMemoryPageSize;</span>
        }

        @Override
        public CharSequence getRoot() {
<span class="fc" id="L1879">            return root;</span>
        }

        @Override
        public int getSampleByIndexSearchPageSize() {
<span class="fc" id="L1884">            return sampleByIndexSearchPageSize;</span>
        }

        @Override
        public boolean getSimulateCrashEnabled() {
<span class="nc" id="L1889">            return simulateCrashEnabled;</span>
        }

        @Override
        public CharSequence getSnapshotInstanceId() {
<span class="fc" id="L1894">            return snapshotInstanceId;</span>
        }

        @Override
        public CharSequence getSnapshotRoot() {
<span class="fc" id="L1899">            return snapshotRoot;</span>
        }

        @Override
        public long getSpinLockTimeout() {
<span class="fc" id="L1904">            return spinLockTimeout;</span>
        }

        @Override
        public int getSqlAnalyticRowIdMaxPages() {
<span class="fc" id="L1909">            return sqlAnalyticRowIdMaxPages;</span>
        }

        @Override
        public int getSqlAnalyticRowIdPageSize() {
<span class="fc" id="L1914">            return sqlAnalyticRowIdPageSize;</span>
        }

        @Override
        public int getSqlAnalyticStoreMaxPages() {
<span class="fc" id="L1919">            return sqlAnalyticStoreMaxPages;</span>
        }

        @Override
        public int getSqlAnalyticStorePageSize() {
<span class="fc" id="L1924">            return sqlAnalyticStorePageSize;</span>
        }

        @Override
        public int getSqlAnalyticTreeKeyMaxPages() {
<span class="fc" id="L1929">            return sqlAnalyticTreeKeyMaxPages;</span>
        }

        @Override
        public int getSqlAnalyticTreeKeyPageSize() {
<span class="fc" id="L1934">            return sqlAnalyticTreeKeyPageSize;</span>
        }

        @Override
        public int getSqlCharacterStoreCapacity() {
<span class="fc" id="L1939">            return sqlCharacterStoreCapacity;</span>
        }

        @Override
        public int getSqlCharacterStoreSequencePoolCapacity() {
<span class="fc" id="L1944">            return sqlCharacterStoreSequencePoolCapacity;</span>
        }

        @Override
        public int getSqlColumnPoolCapacity() {
<span class="fc" id="L1949">            return sqlColumnPoolCapacity;</span>
        }

        @Override
        public double getSqlCompactMapLoadFactor() {
<span class="fc" id="L1954">            return sqlCompactMapLoadFactor;</span>
        }

        @Override
        public int getSqlCopyBufferSize() {
<span class="fc" id="L1959">            return sqlCopyBufferSize;</span>
        }

        @Override
        public CharSequence getSqlCopyInputRoot() {
<span class="fc" id="L1964">            return cairoSqlCopyRoot;</span>
        }

        @Override
        public CharSequence getSqlCopyInputWorkRoot() {
<span class="fc" id="L1969">            return cairoSqlCopyWorkRoot;</span>
        }

        @Override
        public int getSqlCopyLogRetentionDays() {
<span class="nc" id="L1974">            return cairoSqlCopyLogRetentionDays;</span>
        }

        @Override
        public long getSqlCopyMaxIndexChunkSize() {
<span class="fc" id="L1979">            return cairoSqlCopyMaxIndexChunkSize;</span>
        }

        @Override
        public int getSqlCopyQueueCapacity() {
<span class="fc" id="L1984">            return cairoSqlCopyQueueCapacity;</span>
        }

        @Override
        public int getSqlDistinctTimestampKeyCapacity() {
<span class="fc" id="L1989">            return sqlDistinctTimestampKeyCapacity;</span>
        }

        @Override
        public double getSqlDistinctTimestampLoadFactor() {
<span class="fc" id="L1994">            return sqlDistinctTimestampLoadFactor;</span>
        }

        @Override
        public int getSqlExpressionPoolCapacity() {
<span class="fc" id="L1999">            return sqlExpressionPoolCapacity;</span>
        }

        @Override
        public double getSqlFastMapLoadFactor() {
<span class="fc" id="L2004">            return sqlFastMapLoadFactor;</span>
        }

        @Override
        public int getSqlHashJoinLightValueMaxPages() {
<span class="fc" id="L2009">            return sqlHashJoinLightValueMaxPages;</span>
        }

        @Override
        public int getSqlHashJoinLightValuePageSize() {
<span class="fc" id="L2014">            return sqlHashJoinLightValuePageSize;</span>
        }

        @Override
        public int getSqlHashJoinValueMaxPages() {
<span class="fc" id="L2019">            return sqlHashJoinValueMaxPages;</span>
        }

        @Override
        public int getSqlHashJoinValuePageSize() {
<span class="fc" id="L2024">            return sqlHashJoinValuePageSize;</span>
        }

        @Override
        public int getSqlJitBindVarsMemoryMaxPages() {
<span class="fc" id="L2029">            return sqlJitBindVarsMemoryMaxPages;</span>
        }

        @Override
        public int getSqlJitBindVarsMemoryPageSize() {
<span class="fc" id="L2034">            return sqlJitBindVarsMemoryPageSize;</span>
        }

        @Override
        public int getSqlJitIRMemoryMaxPages() {
<span class="fc" id="L2039">            return sqlJitIRMemoryMaxPages;</span>
        }

        @Override
        public int getSqlJitIRMemoryPageSize() {
<span class="fc" id="L2044">            return sqlJitIRMemoryPageSize;</span>
        }

        @Override
        public int getSqlJitMode() {
<span class="fc" id="L2049">            return sqlJitMode;</span>
        }

        @Override
        public int getSqlJitPageAddressCacheThreshold() {
<span class="fc" id="L2054">            return sqlJitPageAddressCacheThreshold;</span>
        }

        @Override
        public int getSqlJitRowsThreshold() {
<span class="fc" id="L2059">            return sqlJitRowsThreshold;</span>
        }

        @Override
        public int getSqlJoinContextPoolCapacity() {
<span class="fc" id="L2064">            return sqlJoinContextPoolCapacity;</span>
        }

        @Override
        public int getSqlJoinMetadataMaxResizes() {
<span class="fc" id="L2069">            return sqlJoinMetadataMaxResizes;</span>
        }

        @Override
        public int getSqlJoinMetadataPageSize() {
<span class="fc" id="L2074">            return sqlJoinMetadataPageSize;</span>
        }

        @Override
        public long getSqlLatestByRowCount() {
<span class="fc" id="L2079">            return sqlLatestByRowCount;</span>
        }

        @Override
        public int getSqlLexerPoolCapacity() {
<span class="fc" id="L2084">            return sqlLexerPoolCapacity;</span>
        }

        @Override
        public int getSqlMapKeyCapacity() {
<span class="fc" id="L2089">            return sqlMapKeyCapacity;</span>
        }

        @Override
        public int getSqlMapMaxPages() {
<span class="fc" id="L2094">            return sqlMapMaxPages;</span>
        }

        @Override
        public int getSqlMapMaxResizes() {
<span class="fc" id="L2099">            return sqlMapMaxResizes;</span>
        }

        @Override
        public int getSqlMapPageSize() {
<span class="fc" id="L2104">            return sqlMapPageSize;</span>
        }

        @Override
        public int getSqlMaxNegativeLimit() {
<span class="fc" id="L2109">            return sqlMaxNegativeLimit;</span>
        }

        @Override
        public int getSqlModelPoolCapacity() {
<span class="fc" id="L2114">            return sqlModelPoolCapacity;</span>
        }

        @Override
        public int getSqlPageFrameMaxRows() {
<span class="fc" id="L2119">            return sqlPageFrameMaxRows;</span>
        }

        @Override
        public int getSqlPageFrameMinRows() {
<span class="fc" id="L2124">            return sqlPageFrameMinRows;</span>
        }

        @Override
        public int getSqlSmallMapKeyCapacity() {
<span class="fc" id="L2129">            return sqlSmallMapKeyCapacity;</span>
        }

        @Override
        public int getSqlSmallMapPageSize() {
<span class="fc" id="L2134">            return sqlSmallMapPageSize;</span>
        }

        @Override
        public int getSqlSortKeyMaxPages() {
<span class="fc" id="L2139">            return sqlSortKeyMaxPages;</span>
        }

        @Override
        public long getSqlSortKeyPageSize() {
<span class="fc" id="L2144">            return sqlSortKeyPageSize;</span>
        }

        @Override
        public int getSqlSortLightValueMaxPages() {
<span class="fc" id="L2149">            return sqlSortLightValueMaxPages;</span>
        }

        @Override
        public long getSqlSortLightValuePageSize() {
<span class="fc" id="L2154">            return sqlSortLightValuePageSize;</span>
        }

        @Override
        public int getSqlSortValueMaxPages() {
<span class="fc" id="L2159">            return sqlSortValueMaxPages;</span>
        }

        @Override
        public int getSqlSortValuePageSize() {
<span class="fc" id="L2164">            return sqlSortValuePageSize;</span>
        }

        @Override
        public int getStrFunctionMaxBufferLength() {
<span class="nc" id="L2169">            return sqlStrFunctionBufferMaxSize;</span>
        }

        @Override
        public CharSequence getSystemTableNamePrefix() {
<span class="fc" id="L2174">            return systemTableNamePrefix;</span>
        }

        @Override
        public long getTableRegistryAutoReloadFrequency() {
<span class="nc" id="L2179">            return cairoTableRegistryAutoReloadFrequency;</span>
        }

        public TelemetryConfiguration getTelemetryConfiguration() {
<span class="fc" id="L2183">            return telemetryConfiguration;</span>
        }

        @Override
        public TextConfiguration getTextConfiguration() {
<span class="fc" id="L2188">            return textConfiguration;</span>
        }

        @Override
        public int getTxnScoreboardEntryCount() {
<span class="fc" id="L2193">            return sqlTxnScoreboardEntryCount;</span>
        }

        @Override
        public int getVectorAggregateQueueCapacity() {
<span class="fc" id="L2198">            return vectorAggregateQueueCapacity;</span>
        }

        @Override
        public int getWalApplyLookAheadTransactionCount() {
<span class="fc" id="L2203">            return walApplyLookAheadTransactionCount;</span>
        }

        @Override
        public int getWalCommitSquashRowLimit() {
<span class="fc" id="L2208">            return walCommitSquashRowLimit;</span>
        }

        @Override
        public boolean getWalEnabledDefault() {
<span class="fc" id="L2213">            return walEnabledDefault;</span>
        }

        @Override
        public long getWalPurgeInterval() {
<span class="fc" id="L2218">            return walPurgeInterval;</span>
        }

        @Override
        public int getWalRecreateDistressedSequencerAttempts() {
<span class="fc" id="L2223">            return walRecreateDistressedSequencerAttempts;</span>
        }

        @Override
        public long getWalSegmentRolloverRowCount() {
<span class="fc" id="L2228">            return walSegmentRolloverRowCount;</span>
        }

        @Override
        public int getWalTxnNotificationQueueCapacity() {
<span class="fc" id="L2233">            return walTxnNotificationQueueCapacity;</span>
        }

        @Override
        public int getWithClauseModelPoolCapacity() {
<span class="fc" id="L2238">            return sqlWithClauseModelPoolCapacity;</span>
        }

        @Override
        public long getWorkStealTimeoutNanos() {
<span class="fc" id="L2243">            return workStealTimeoutNanos;</span>
        }

        @Override
        public long getWriterAsyncCommandBusyWaitTimeout() {
<span class="fc" id="L2248">            return writerAsyncCommandBusyWaitTimeout;</span>
        }

        @Override
        public long getWriterAsyncCommandMaxTimeout() {
<span class="fc" id="L2253">            return writerAsyncCommandMaxWaitTimeout;</span>
        }

        @Override
        public int getWriterCommandQueueCapacity() {
<span class="fc" id="L2258">            return writerAsyncCommandQueueCapacity;</span>
        }

        @Override
        public long getWriterCommandQueueSlotSize() {
<span class="fc" id="L2263">            return writerAsyncCommandQueueSlotSize;</span>
        }

        @Override
        public long getWriterFileOpenOpts() {
<span class="fc" id="L2268">            return writerFileOpenOpts;</span>
        }

        @Override
        public int getWriterTickRowsCountMod() {
<span class="fc" id="L2273">            return writerTickRowsCountMod;</span>
        }

        @Override
        public boolean isIOURingEnabled() {
<span class="fc" id="L2278">            return ioURingEnabled;</span>
        }

        @Override
        public boolean isO3QuickSortEnabled() {
<span class="fc" id="L2283">            return o3QuickSortEnabled;</span>
        }

        @Override
        public boolean isParallelIndexingEnabled() {
<span class="fc" id="L2288">            return parallelIndexingEnabled;</span>
        }

        @Override
        public boolean isReadOnlyInstance() {
<span class="fc" id="L2293">            return isReadOnlyInstance;</span>
        }

        @Override
        public boolean isSnapshotRecoveryEnabled() {
<span class="fc" id="L2298">            return snapshotRecoveryEnabled;</span>
        }

        @Override
        public boolean isSqlJitDebugEnabled() {
<span class="fc" id="L2303">            return sqlJitDebugEnabled;</span>
        }

        @Override
        public boolean isSqlParallelFilterEnabled() {
<span class="fc" id="L2308">            return sqlParallelFilterEnabled;</span>
        }

        @Override
        public boolean isSqlParallelFilterPreTouchEnabled() {
<span class="fc" id="L2313">            return sqlParallelFilterPreTouchEnabled;</span>
        }

        @Override
        public boolean isTableTypeConversionEnabled() {
<span class="fc" id="L2318">            return tableTypeConversionEnabled;</span>
        }

        public boolean isWalSupported() {
<span class="fc" id="L2322">            return walSupported;</span>
        }

        @Override
        public boolean mangleTableDirNames() {
<span class="fc" id="L2327">            return false;</span>
        }
    }

<span class="fc" id="L2331">    private class PropHttpContextConfiguration implements HttpContextConfiguration {</span>

        @Override
        public boolean allowDeflateBeforeSend() {
<span class="fc" id="L2335">            return httpAllowDeflateBeforeSend;</span>
        }

        @Override
        public MillisecondClock getClock() {
<span class="pc bpc" id="L2340" title="1 of 2 branches missed.">            return httpFrozenClock ? StationaryMillisClock.INSTANCE : MillisecondClockImpl.INSTANCE;</span>
        }

        @Override
        public int getConnectionPoolInitialCapacity() {
<span class="fc" id="L2345">            return connectionPoolInitialCapacity;</span>
        }

        @Override
        public int getConnectionStringPoolCapacity() {
<span class="fc" id="L2350">            return connectionStringPoolCapacity;</span>
        }

        @Override
        public boolean getDumpNetworkTraffic() {
<span class="fc" id="L2355">            return false;</span>
        }

        @Override
        public String getHttpVersion() {
<span class="fc" id="L2360">            return httpVersion;</span>
        }

        @Override
        public int getMultipartHeaderBufferSize() {
<span class="fc" id="L2365">            return multipartHeaderBufferSize;</span>
        }

        @Override
        public long getMultipartIdleSpinCount() {
<span class="fc" id="L2370">            return multipartIdleSpinCount;</span>
        }

        @Override
        public NetworkFacade getNetworkFacade() {
<span class="fc" id="L2375">            return NetworkFacadeImpl.INSTANCE;</span>
        }

        @Override
        public int getRecvBufferSize() {
<span class="fc" id="L2380">            return recvBufferSize;</span>
        }

        @Override
        public int getRequestHeaderBufferSize() {
<span class="fc" id="L2385">            return requestHeaderBufferSize;</span>
        }

        @Override
        public int getSendBufferSize() {
<span class="fc" id="L2390">            return sendBufferSize;</span>
        }

        @Override
        public boolean getServerKeepAlive() {
<span class="fc" id="L2395">            return httpServerKeepAlive;</span>
        }

        @Override
        public boolean readOnlySecurityContext() {
<span class="pc bpc" id="L2400" title="1 of 4 branches missed.">            return httpReadOnlySecurityContext || isReadOnlyInstance;</span>
        }
    }

<span class="fc" id="L2404">    private class PropHttpIODispatcherConfiguration implements IODispatcherConfiguration {</span>
        @Override
        public int getBindIPv4Address() {
<span class="fc" id="L2407">            return httpNetBindIPv4Address;</span>
        }

        @Override
        public int getBindPort() {
<span class="fc" id="L2412">            return httpNetBindPort;</span>
        }

        @Override
        public MillisecondClock getClock() {
<span class="fc" id="L2417">            return MillisecondClockImpl.INSTANCE;</span>
        }

        @Override
        public String getDispatcherLogName() {
<span class="fc" id="L2422">            return &quot;http-server&quot;;</span>
        }

        @Override
        public EpollFacade getEpollFacade() {
<span class="fc" id="L2427">            return EpollFacadeImpl.INSTANCE;</span>
        }

        @Override
        public boolean getHint() {
<span class="fc" id="L2432">            return httpNetConnectionHint;</span>
        }

        @Override
        public int getInitialBias() {
<span class="fc" id="L2437">            return IOOperation.READ;</span>
        }

        @Override
        public KqueueFacade getKqueueFacade() {
<span class="fc" id="L2442">            return KqueueFacadeImpl.INSTANCE;</span>
        }

        @Override
        public int getLimit() {
<span class="fc" id="L2447">            return httpNetConnectionLimit;</span>
        }

        @Override
        public NetworkFacade getNetworkFacade() {
<span class="fc" id="L2452">            return NetworkFacadeImpl.INSTANCE;</span>
        }

        @Override
        public long getQueueTimeout() {
<span class="fc" id="L2457">            return httpNetConnectionQueueTimeout;</span>
        }

        @Override
        public int getRcvBufSize() {
<span class="fc" id="L2462">            return httpNetConnectionRcvBuf;</span>
        }

        @Override
        public SelectFacade getSelectFacade() {
<span class="fc" id="L2467">            return SelectFacadeImpl.INSTANCE;</span>
        }

        @Override
        public int getSndBufSize() {
<span class="fc" id="L2472">            return httpNetConnectionSndBuf;</span>
        }

        @Override
        public int getTestConnectionBufferSize() {
<span class="fc" id="L2477">            return netTestConnectionBufferSize;</span>
        }

        @Override
        public long getTimeout() {
<span class="fc" id="L2482">            return httpNetConnectionTimeout;</span>
        }
    }

<span class="fc" id="L2486">    private class PropHttpMinIODispatcherConfiguration implements IODispatcherConfiguration {</span>
        @Override
        public int getBindIPv4Address() {
<span class="fc" id="L2489">            return httpMinBindIPv4Address;</span>
        }

        @Override
        public int getBindPort() {
<span class="fc" id="L2494">            return httpMinBindPort;</span>
        }

        @Override
        public MillisecondClock getClock() {
<span class="fc" id="L2499">            return MillisecondClockImpl.INSTANCE;</span>
        }

        @Override
        public String getDispatcherLogName() {
<span class="fc" id="L2504">            return &quot;http-min-server&quot;;</span>
        }

        @Override
        public EpollFacade getEpollFacade() {
<span class="nc" id="L2509">            return EpollFacadeImpl.INSTANCE;</span>
        }

        @Override
        public boolean getHint() {
<span class="fc" id="L2514">            return httpMinNetConnectionHint;</span>
        }

        @Override
        public int getInitialBias() {
<span class="fc" id="L2519">            return IOOperation.READ;</span>
        }

        @Override
        public KqueueFacade getKqueueFacade() {
<span class="fc" id="L2524">            return KqueueFacadeImpl.INSTANCE;</span>
        }

        @Override
        public int getLimit() {
<span class="fc" id="L2529">            return httpMinNetConnectionLimit;</span>
        }

        @Override
        public NetworkFacade getNetworkFacade() {
<span class="fc" id="L2534">            return NetworkFacadeImpl.INSTANCE;</span>
        }

        @Override
        public long getQueueTimeout() {
<span class="fc" id="L2539">            return httpMinNetConnectionQueueTimeout;</span>
        }

        @Override
        public int getRcvBufSize() {
<span class="fc" id="L2544">            return httpMinNetConnectionRcvBuf;</span>
        }

        @Override
        public SelectFacade getSelectFacade() {
<span class="nc" id="L2549">            return SelectFacadeImpl.INSTANCE;</span>
        }

        @Override
        public int getSndBufSize() {
<span class="fc" id="L2554">            return httpMinNetConnectionSndBuf;</span>
        }

        @Override
        public int getTestConnectionBufferSize() {
<span class="fc" id="L2559">            return netTestConnectionBufferSize;</span>
        }

        public long getTimeout() {
<span class="fc" id="L2563">            return httpMinNetConnectionTimeout;</span>
        }
    }

<span class="fc" id="L2567">    private class PropHttpMinServerConfiguration implements HttpMinServerConfiguration {</span>

        @Override
        public IODispatcherConfiguration getDispatcherConfiguration() {
<span class="fc" id="L2571">            return httpMinIODispatcherConfiguration;</span>
        }

        @Override
        public HttpContextConfiguration getHttpContextConfiguration() {
<span class="fc" id="L2576">            return httpContextConfiguration;</span>
        }

        @Override
        public String getPoolName() {
<span class="fc" id="L2581">            return &quot;minhttp&quot;;</span>
        }

        @Override
        public long getSleepThreshold() {
<span class="fc" id="L2586">            return httpMinWorkerSleepThreshold;</span>
        }

        @Override
        public long getSleepTimeout() {
<span class="fc" id="L2591">            return httpMinWorkerSleepTimeout;</span>
        }

        @Override
        public WaitProcessorConfiguration getWaitProcessorConfiguration() {
<span class="fc" id="L2596">            return httpWaitProcessorConfiguration;</span>
        }

        @Override
        public int[] getWorkerAffinity() {
<span class="fc" id="L2601">            return httpMinWorkerAffinity;</span>
        }

        @Override
        public int getWorkerCount() {
<span class="fc" id="L2606">            return httpMinWorkerCount;</span>
        }

        @Override
        public long getYieldThreshold() {
<span class="fc" id="L2611">            return httpMinWorkerYieldThreshold;</span>
        }

        @Override
        public boolean haltOnError() {
<span class="fc" id="L2616">            return httpMinWorkerHaltOnError;</span>
        }

        @Override
        public boolean isEnabled() {
<span class="fc" id="L2621">            return httpMinServerEnabled;</span>
        }
    }

<span class="fc" id="L2625">    private class PropHttpServerConfiguration implements HttpServerConfiguration {</span>

        @Override
        public IODispatcherConfiguration getDispatcherConfiguration() {
<span class="fc" id="L2629">            return httpIODispatcherConfiguration;</span>
        }

        @Override
        public HttpContextConfiguration getHttpContextConfiguration() {
<span class="fc" id="L2634">            return httpContextConfiguration;</span>
        }

        @Override
        public JsonQueryProcessorConfiguration getJsonQueryProcessorConfiguration() {
<span class="fc" id="L2639">            return jsonQueryProcessorConfiguration;</span>
        }

        @Override
        public String getPoolName() {
<span class="fc" id="L2644">            return &quot;http&quot;;</span>
        }

        @Override
        public int getQueryCacheBlockCount() {
<span class="fc" id="L2649">            return httpSqlCacheBlockCount;</span>
        }

        @Override
        public int getQueryCacheRowCount() {
<span class="fc" id="L2654">            return httpSqlCacheRowCount;</span>
        }

        @Override
        public long getSleepThreshold() {
<span class="fc" id="L2659">            return httpWorkerSleepThreshold;</span>
        }

        @Override
        public long getSleepTimeout() {
<span class="fc" id="L2664">            return httpWorkerSleepTimeout;</span>
        }

        @Override
        public StaticContentProcessorConfiguration getStaticContentProcessorConfiguration() {
<span class="fc" id="L2669">            return staticContentProcessorConfiguration;</span>
        }

        @Override
        public WaitProcessorConfiguration getWaitProcessorConfiguration() {
<span class="fc" id="L2674">            return httpWaitProcessorConfiguration;</span>
        }

        @Override
        public int[] getWorkerAffinity() {
<span class="fc" id="L2679">            return httpWorkerAffinity;</span>
        }

        @Override
        public int getWorkerCount() {
<span class="fc" id="L2684">            return httpWorkerCount;</span>
        }

        @Override
        public long getYieldThreshold() {
<span class="fc" id="L2689">            return httpWorkerYieldThreshold;</span>
        }

        @Override
        public boolean haltOnError() {
<span class="fc" id="L2694">            return httpWorkerHaltOnError;</span>
        }

        @Override
        public boolean isEnabled() {
<span class="fc" id="L2699">            return httpServerEnabled;</span>
        }

        @Override
        public boolean isQueryCacheEnabled() {
<span class="fc" id="L2704">            return httpSqlCacheEnabled;</span>
        }
    }

<span class="fc" id="L2708">    private class PropJsonQueryProcessorConfiguration implements JsonQueryProcessorConfiguration {</span>

        @Override
        public MillisecondClock getClock() {
<span class="pc bpc" id="L2712" title="1 of 2 branches missed.">            return httpFrozenClock ? StationaryMillisClock.INSTANCE : MillisecondClockImpl.INSTANCE;</span>
        }

        @Override
        public int getConnectionCheckFrequency() {
<span class="fc" id="L2717">            return jsonQueryConnectionCheckFrequency;</span>
        }

        @Override
        public int getDoubleScale() {
<span class="fc" id="L2722">            return jsonQueryDoubleScale;</span>
        }

        @Override
        public FilesFacade getFilesFacade() {
<span class="fc" id="L2727">            return FilesFacadeImpl.INSTANCE;</span>
        }

        @Override
        public int getFloatScale() {
<span class="fc" id="L2732">            return jsonQueryFloatScale;</span>
        }

        @Override
        public CharSequence getKeepAliveHeader() {
<span class="fc" id="L2737">            return keepAliveHeader;</span>
        }

        @Override
        public long getMaxQueryResponseRowLimit() {
<span class="fc" id="L2742">            return maxHttpQueryResponseRowLimit;</span>
        }
    }

<span class="fc" id="L2746">    private class PropLineTcpIOWorkerPoolConfiguration implements WorkerPoolConfiguration {</span>
        @Override
        public String getPoolName() {
<span class="fc" id="L2749">            return &quot;ilpio&quot;;</span>
        }

        @Override
        public long getSleepThreshold() {
<span class="fc" id="L2754">            return lineTcpIOWorkerSleepThreshold;</span>
        }

        @Override
        public int[] getWorkerAffinity() {
<span class="fc" id="L2759">            return lineTcpIOWorkerAffinity;</span>
        }

        @Override
        public int getWorkerCount() {
<span class="fc" id="L2764">            return lineTcpIOWorkerCount;</span>
        }

        @Override
        public long getYieldThreshold() {
<span class="fc" id="L2769">            return lineTcpIOWorkerYieldThreshold;</span>
        }

        @Override
        public boolean haltOnError() {
<span class="fc" id="L2774">            return lineTcpIOWorkerPoolHaltOnError;</span>
        }
    }

<span class="fc" id="L2778">    private class PropLineTcpReceiverConfiguration implements LineTcpReceiverConfiguration {</span>

        @Override
        public String getAuthDbPath() {
<span class="fc" id="L2782">            return lineTcpAuthDbPath;</span>
        }

        @Override
        public boolean getAutoCreateNewColumns() {
<span class="fc" id="L2787">            return ilpAutoCreateNewColumns;</span>
        }

        @Override
        public boolean getAutoCreateNewTables() {
<span class="fc" id="L2792">            return ilpAutoCreateNewTables;</span>
        }

        @Override
        public CairoSecurityContext getCairoSecurityContext() {
<span class="fc" id="L2797">            return AllowAllCairoSecurityContext.INSTANCE;</span>
        }

        @Override
        public long getCommitIntervalDefault() {
<span class="fc" id="L2802">            return lineTcpCommitIntervalDefault;</span>
        }

        @Override
        public double getCommitIntervalFraction() {
<span class="fc" id="L2807">            return lineTcpCommitIntervalFraction;</span>
        }

        @Override
        public int getConnectionPoolInitialCapacity() {
<span class="fc" id="L2812">            return lineTcpConnectionPoolInitialCapacity;</span>
        }

        @Override
        public short getDefaultColumnTypeForFloat() {
<span class="fc" id="L2817">            return floatDefaultColumnType;</span>
        }

        @Override
        public short getDefaultColumnTypeForInteger() {
<span class="fc" id="L2822">            return integerDefaultColumnType;</span>
        }

        @Override
        public int getDefaultPartitionBy() {
<span class="fc" id="L2827">            return lineTcpDefaultPartitionBy;</span>
        }

        @Override
        public boolean getDisconnectOnError() {
<span class="fc" id="L2832">            return lineTcpDisconnectOnError;</span>
        }

        @Override
        public IODispatcherConfiguration getDispatcherConfiguration() {
<span class="fc" id="L2837">            return lineTcpReceiverDispatcherConfiguration;</span>
        }

        @Override
        public FilesFacade getFilesFacade() {
<span class="nc" id="L2842">            return FilesFacadeImpl.INSTANCE;</span>
        }

        @Override
        public WorkerPoolConfiguration getIOWorkerPoolConfiguration() {
<span class="fc" id="L2847">            return lineTcpIOWorkerPoolConfiguration;</span>
        }

        @Override
        public long getMaintenanceInterval() {
<span class="fc" id="L2852">            return lineTcpMaintenanceInterval;</span>
        }

        @Override
        public int getMaxFileNameLength() {
<span class="fc" id="L2857">            return maxFileNameLength;</span>
        }

        @Override
        public int getMaxMeasurementSize() {
<span class="fc" id="L2862">            return lineTcpMaxMeasurementSize;</span>
        }

        @Override
        public MicrosecondClock getMicrosecondClock() {
<span class="fc" id="L2867">            return MicrosecondClockImpl.INSTANCE;</span>
        }

        @Override
        public MillisecondClock getMillisecondClock() {
<span class="fc" id="L2872">            return MillisecondClockImpl.INSTANCE;</span>
        }

        @Override
        public int getNetMsgBufferSize() {
<span class="fc" id="L2877">            return lineTcpMsgBufferSize;</span>
        }

        @Override
        public NetworkFacade getNetworkFacade() {
<span class="fc" id="L2882">            return NetworkFacadeImpl.INSTANCE;</span>
        }

        @Override
        public long getSymbolCacheWaitUsBeforeReload() {
<span class="fc" id="L2887">            return symbolCacheWaitUsBeforeReload;</span>
        }

        @Override
        public LineProtoTimestampAdapter getTimestampAdapter() {
<span class="fc" id="L2892">            return lineTcpTimestampAdapter;</span>
        }

        @Override
        public long getWriterIdleTimeout() {
<span class="fc" id="L2897">            return minIdleMsBeforeWriterRelease;</span>
        }

        @Override
        public int getWriterQueueCapacity() {
<span class="fc" id="L2902">            return lineTcpWriterQueueCapacity;</span>
        }

        @Override
        public WorkerPoolConfiguration getWriterWorkerPoolConfiguration() {
<span class="fc" id="L2907">            return lineTcpWriterWorkerPoolConfiguration;</span>
        }

        @Override
        public boolean isEnabled() {
<span class="fc" id="L2912">            return lineTcpEnabled;</span>
        }

        @Override
        public boolean isStringAsTagSupported() {
<span class="fc" id="L2917">            return stringAsTagSupported;</span>
        }

        @Override
        public boolean isStringToCharCastAllowed() {
<span class="fc" id="L2922">            return stringToCharCastAllowed;</span>
        }

        @Override
        public boolean isSymbolAsFieldSupported() {
<span class="fc" id="L2927">            return symbolAsFieldSupported;</span>
        }
    }

<span class="fc" id="L2931">    private class PropLineTcpReceiverIODispatcherConfiguration implements IODispatcherConfiguration {</span>

        @Override
        public int getBindIPv4Address() {
<span class="fc" id="L2935">            return lineTcpNetBindIPv4Address;</span>
        }

        @Override
        public int getBindPort() {
<span class="fc" id="L2940">            return lineTcpNetBindPort;</span>
        }

        @Override
        public MillisecondClock getClock() {
<span class="fc" id="L2945">            return MillisecondClockImpl.INSTANCE;</span>
        }

        @Override
        public String getDispatcherLogName() {
<span class="fc" id="L2950">            return &quot;tcp-line-server&quot;;</span>
        }

        @Override
        public EpollFacade getEpollFacade() {
<span class="nc" id="L2955">            return EpollFacadeImpl.INSTANCE;</span>
        }

        @Override
        public boolean getHint() {
<span class="fc" id="L2960">            return lineTcpNetConnectionHint;</span>
        }

        @Override
        public int getInitialBias() {
<span class="fc" id="L2965">            return BIAS_READ;</span>
        }

        @Override
        public KqueueFacade getKqueueFacade() {
<span class="fc" id="L2970">            return KqueueFacadeImpl.INSTANCE;</span>
        }

        @Override
        public int getLimit() {
<span class="fc" id="L2975">            return lineTcpNetConnectionLimit;</span>
        }

        public NetworkFacade getNetworkFacade() {
<span class="fc" id="L2979">            return NetworkFacadeImpl.INSTANCE;</span>
        }

        @Override
        public long getQueueTimeout() {
<span class="fc" id="L2984">            return lineTcpNetConnectionQueueTimeout;</span>
        }

        @Override
        public int getRcvBufSize() {
<span class="fc" id="L2989">            return lineTcpNetConnectionRcvBuf;</span>
        }

        @Override
        public SelectFacade getSelectFacade() {
<span class="nc" id="L2994">            return SelectFacadeImpl.INSTANCE;</span>
        }

        @Override
        public int getSndBufSize() {
<span class="fc" id="L2999">            return -1;</span>
        }

        @Override
        public int getTestConnectionBufferSize() {
<span class="fc" id="L3004">            return netTestConnectionBufferSize;</span>
        }

        @Override
        public long getTimeout() {
<span class="fc" id="L3009">            return lineTcpNetConnectionTimeout;</span>
        }
    }

<span class="fc" id="L3013">    private class PropLineTcpWriterWorkerPoolConfiguration implements WorkerPoolConfiguration {</span>
        @Override
        public String getPoolName() {
<span class="fc" id="L3016">            return &quot;ilpwriter&quot;;</span>
        }

        @Override
        public long getSleepThreshold() {
<span class="fc" id="L3021">            return lineTcpWriterWorkerSleepThreshold;</span>
        }

        @Override
        public int[] getWorkerAffinity() {
<span class="fc" id="L3026">            return lineTcpWriterWorkerAffinity;</span>
        }

        @Override
        public int getWorkerCount() {
<span class="fc" id="L3031">            return lineTcpWriterWorkerCount;</span>
        }

        @Override
        public long getYieldThreshold() {
<span class="fc" id="L3036">            return lineTcpWriterWorkerYieldThreshold;</span>
        }

        @Override
        public boolean haltOnError() {
<span class="fc" id="L3041">            return lineTcpWriterWorkerPoolHaltOnError;</span>
        }
    }

<span class="fc" id="L3045">    private class PropLineUdpReceiverConfiguration implements LineUdpReceiverConfiguration {</span>
        @Override
        public boolean getAutoCreateNewColumns() {
<span class="fc" id="L3048">            return ilpAutoCreateNewColumns;</span>
        }

        @Override
        public boolean getAutoCreateNewTables() {
<span class="fc" id="L3053">            return ilpAutoCreateNewTables;</span>
        }

        @Override
        public int getBindIPv4Address() {
<span class="fc" id="L3058">            return lineUdpBindIPV4Address;</span>
        }

        @Override
        public CairoSecurityContext getCairoSecurityContext() {
<span class="fc" id="L3063">            return AllowAllCairoSecurityContext.INSTANCE;</span>
        }

        @Override
        public int getCommitMode() {
<span class="fc" id="L3068">            return lineUdpCommitMode;</span>
        }

        @Override
        public int getCommitRate() {
<span class="fc" id="L3073">            return lineUdpCommitRate;</span>
        }

        @Override
        public short getDefaultColumnTypeForFloat() {
<span class="fc" id="L3078">            return floatDefaultColumnType;</span>
        }

        @Override
        public short getDefaultColumnTypeForInteger() {
<span class="fc" id="L3083">            return integerDefaultColumnType;</span>
        }

        @Override
        public int getDefaultPartitionBy() {
<span class="fc" id="L3088">            return lineUdpDefaultPartitionBy;</span>
        }

        @Override
        public int getGroupIPv4Address() {
<span class="fc" id="L3093">            return lineUdpGroupIPv4Address;</span>
        }

        @Override
        public int getMaxFileNameLength() {
<span class="fc" id="L3098">            return maxFileNameLength;</span>
        }

        @Override
        public int getMsgBufferSize() {
<span class="fc" id="L3103">            return lineUdpMsgBufferSize;</span>
        }

        @Override
        public int getMsgCount() {
<span class="fc" id="L3108">            return lineUdpMsgCount;</span>
        }

        @Override
        public NetworkFacade getNetworkFacade() {
<span class="fc" id="L3113">            return NetworkFacadeImpl.INSTANCE;</span>
        }

        @Override
        public int getPort() {
<span class="fc" id="L3118">            return lineUdpPort;</span>
        }

        @Override
        public int getReceiveBufferSize() {
<span class="fc" id="L3123">            return lineUdpReceiveBufferSize;</span>
        }

        @Override
        public LineProtoTimestampAdapter getTimestampAdapter() {
<span class="fc" id="L3128">            return lineUdpTimestampAdapter;</span>
        }

        @Override
        public boolean isEnabled() {
<span class="fc" id="L3133">            return lineUdpEnabled;</span>
        }

        @Override
        public boolean isUnicast() {
<span class="fc" id="L3138">            return lineUdpUnicast;</span>
        }

        @Override
        public boolean ownThread() {
<span class="fc" id="L3143">            return lineUdpOwnThread;</span>
        }

        @Override
        public int ownThreadAffinity() {
<span class="fc" id="L3148">            return lineUdpOwnThreadAffinity;</span>
        }
    }

<span class="fc" id="L3152">    private class PropMetricsConfiguration implements MetricsConfiguration {</span>

        @Override
        public boolean isEnabled() {
<span class="fc" id="L3156">            return metricsEnabled;</span>
        }
    }

<span class="fc" id="L3160">    private class PropPGWireConfiguration implements PGWireConfiguration {</span>
        @Override
        public int getBinParamCountCapacity() {
<span class="fc" id="L3163">            return pgBinaryParamsCapacity;</span>
        }

        @Override
        public int getCharacterStoreCapacity() {
<span class="fc" id="L3168">            return pgCharacterStoreCapacity;</span>
        }

        @Override
        public int getCharacterStorePoolCapacity() {
<span class="fc" id="L3173">            return pgCharacterStorePoolCapacity;</span>
        }

        @Override
        public SqlExecutionCircuitBreakerConfiguration getCircuitBreakerConfiguration() {
<span class="fc" id="L3178">            return circuitBreakerConfiguration;</span>
        }

        @Override
        public int getConnectionPoolInitialCapacity() {
<span class="fc" id="L3183">            return pgConnectionPoolInitialCapacity;</span>
        }

        @Override
        public DateLocale getDefaultDateLocale() {
<span class="nc" id="L3188">            return pgDefaultLocale;</span>
        }

        @Override
        public String getDefaultPassword() {
<span class="fc" id="L3193">            return pgPassword;</span>
        }

        @Override
        public String getDefaultUsername() {
<span class="fc" id="L3198">            return pgUsername;</span>
        }

        @Override
        public IODispatcherConfiguration getDispatcherConfiguration() {
<span class="fc" id="L3203">            return propPGWireDispatcherConfiguration;</span>
        }

        @Override
        public int getInsertCacheBlockCount() {
<span class="fc" id="L3208">            return pgInsertCacheBlockCount;</span>
        }

        @Override
        public int getInsertCacheRowCount() {
<span class="fc" id="L3213">            return pgInsertCacheRowCount;</span>
        }

        @Override
        public int getInsertPoolCapacity() {
<span class="fc" id="L3218">            return pgInsertPoolCapacity;</span>
        }

        @Override
        public int getMaxBlobSizeOnQuery() {
<span class="fc" id="L3223">            return pgMaxBlobSizeOnQuery;</span>
        }

        @Override
        public int getNamedStatementCacheCapacity() {
<span class="fc" id="L3228">            return pgNamedStatementCacheCapacity;</span>
        }

        @Override
        public int getNamesStatementPoolCapacity() {
<span class="fc" id="L3233">            return pgNamesStatementPoolCapacity;</span>
        }

        @Override
        public NetworkFacade getNetworkFacade() {
<span class="fc" id="L3238">            return NetworkFacadeImpl.INSTANCE;</span>
        }

        @Override
        public int getPendingWritersCacheSize() {
<span class="fc" id="L3243">            return pgPendingWritersCacheCapacity;</span>
        }

        @Override
        public String getPoolName() {
<span class="fc" id="L3248">            return &quot;pgwire&quot;;</span>
        }

        @Override
        public String getReadOnlyPassword() {
<span class="fc" id="L3253">            return pgReadOnlyPassword;</span>
        }

        @Override
        public String getReadOnlyUsername() {
<span class="fc" id="L3258">            return pgReadOnlyUsername;</span>
        }

        @Override
        public int getRecvBufferSize() {
<span class="fc" id="L3263">            return pgRecvBufferSize;</span>
        }

        @Override
        public int getSelectCacheBlockCount() {
<span class="fc" id="L3268">            return pgSelectCacheBlockCount;</span>
        }

        @Override
        public int getSelectCacheRowCount() {
<span class="fc" id="L3273">            return pgSelectCacheRowCount;</span>
        }

        @Override
        public int getSendBufferSize() {
<span class="fc" id="L3278">            return pgSendBufferSize;</span>
        }

        @Override
        public String getServerVersion() {
<span class="fc" id="L3283">            return &quot;11.3&quot;;</span>
        }

        @Override
        public long getSleepThreshold() {
<span class="fc" id="L3288">            return pgWorkerSleepThreshold;</span>
        }

        @Override
        public int getUpdateCacheBlockCount() {
<span class="fc" id="L3293">            return pgUpdateCacheBlockCount;</span>
        }

        @Override
        public int getUpdateCacheRowCount() {
<span class="fc" id="L3298">            return pgUpdateCacheRowCount;</span>
        }

        @Override
        public int[] getWorkerAffinity() {
<span class="fc" id="L3303">            return pgWorkerAffinity;</span>
        }

        @Override
        public int getWorkerCount() {
<span class="fc" id="L3308">            return pgWorkerCount;</span>
        }

        @Override
        public long getYieldThreshold() {
<span class="fc" id="L3313">            return pgWorkerYieldThreshold;</span>
        }

        @Override
        public boolean haltOnError() {
<span class="fc" id="L3318">            return pgHaltOnError;</span>
        }

        @Override
        public boolean isDaemonPool() {
<span class="fc" id="L3323">            return pgDaemonPool;</span>
        }

        @Override
        public boolean isEnabled() {
<span class="fc" id="L3328">            return pgEnabled;</span>
        }

        @Override
        public boolean isInsertCacheEnabled() {
<span class="fc" id="L3333">            return pgInsertCacheEnabled;</span>
        }

        @Override
        public boolean isReadOnlyUserEnabled() {
<span class="fc" id="L3338">            return pgReadOnlyUserEnabled;</span>
        }

        @Override
        public boolean isSelectCacheEnabled() {
<span class="fc" id="L3343">            return pgSelectCacheEnabled;</span>
        }

        @Override
        public boolean isUpdateCacheEnabled() {
<span class="fc" id="L3348">            return pgUpdateCacheEnabled;</span>
        }

        @Override
        public boolean readOnlySecurityContext() {
<span class="pc bpc" id="L3353" title="1 of 4 branches missed.">            return pgReadOnlySecurityContext || isReadOnlyInstance;</span>
        }
    }

<span class="fc" id="L3357">    private class PropPGWireDispatcherConfiguration implements IODispatcherConfiguration {</span>

        @Override
        public int getBindIPv4Address() {
<span class="fc" id="L3361">            return pgNetBindIPv4Address;</span>
        }

        @Override
        public int getBindPort() {
<span class="fc" id="L3366">            return pgNetBindPort;</span>
        }

        @Override
        public MillisecondClock getClock() {
<span class="fc" id="L3371">            return MillisecondClockImpl.INSTANCE;</span>
        }

        @Override
        public String getDispatcherLogName() {
<span class="fc" id="L3376">            return &quot;pg-server&quot;;</span>
        }

        @Override
        public EpollFacade getEpollFacade() {
<span class="nc" id="L3381">            return EpollFacadeImpl.INSTANCE;</span>
        }

        @Override
        public boolean getHint() {
<span class="fc" id="L3386">            return pgNetConnectionHint;</span>
        }

        @Override
        public int getInitialBias() {
<span class="fc" id="L3391">            return BIAS_READ;</span>
        }

        @Override
        public KqueueFacade getKqueueFacade() {
<span class="fc" id="L3396">            return KqueueFacadeImpl.INSTANCE;</span>
        }

        @Override
        public int getLimit() {
<span class="fc" id="L3401">            return pgNetConnectionLimit;</span>
        }

        @Override
        public NetworkFacade getNetworkFacade() {
<span class="fc" id="L3406">            return NetworkFacadeImpl.INSTANCE;</span>
        }

        @Override
        public long getQueueTimeout() {
<span class="fc" id="L3411">            return pgNetConnectionQueueTimeout;</span>
        }

        @Override
        public int getRcvBufSize() {
<span class="fc" id="L3416">            return pgNetConnectionRcvBuf;</span>
        }

        @Override
        public SelectFacade getSelectFacade() {
<span class="nc" id="L3421">            return SelectFacadeImpl.INSTANCE;</span>
        }

        @Override
        public int getSndBufSize() {
<span class="fc" id="L3426">            return pgNetConnectionSndBuf;</span>
        }

        @Override
        public int getTestConnectionBufferSize() {
<span class="fc" id="L3431">            return netTestConnectionBufferSize;</span>
        }

        public long getTimeout() {
<span class="fc" id="L3435">            return pgNetIdleConnectionTimeout;</span>
        }
    }

<span class="fc" id="L3439">    private class PropSqlExecutionCircuitBreakerConfiguration implements SqlExecutionCircuitBreakerConfiguration {</span>

        @Override
        public boolean checkConnection() {
<span class="nc" id="L3443">            return true;</span>
        }

        @Override
        public int getBufferSize() {
<span class="fc" id="L3448">            return netTestConnectionBufferSize;</span>
        }

        @Override
        public int getCircuitBreakerThrottle() {
<span class="fc" id="L3453">            return circuitBreakerThrottle;</span>
        }

        @Override
        @NotNull
        public MillisecondClock getClock() {
<span class="pc bpc" id="L3459" title="1 of 2 branches missed.">            return MillisecondClockImpl.INSTANCE;</span>
        }

        @Override
        @NotNull
        public NetworkFacade getNetworkFacade() {
<span class="pc bpc" id="L3465" title="1 of 2 branches missed.">            return NetworkFacadeImpl.INSTANCE;</span>
        }

        @Override
        public long getTimeout() {
<span class="fc" id="L3470">            return circuitBreakerTimeout;</span>
        }

        @Override
        public boolean isEnabled() {
<span class="fc" id="L3475">            return interruptOnClosedConnection;</span>
        }
    }

<span class="fc" id="L3479">    private class PropStaticContentProcessorConfiguration implements StaticContentProcessorConfiguration {</span>

        @Override
        public FilesFacade getFilesFacade() {
<span class="fc" id="L3483">            return FilesFacadeImpl.INSTANCE;</span>
        }

        @Override
        public CharSequence getIndexFileName() {
<span class="fc" id="L3488">            return indexFileName;</span>
        }

        @Override
        public String getKeepAliveHeader() {
<span class="fc" id="L3493">            return keepAliveHeader;</span>
        }

        @Override
        public MimeTypesCache getMimeTypesCache() {
<span class="fc" id="L3498">            return mimeTypesCache;</span>
        }

        /**
         * Absolute path to HTTP public directory.
         *
         * @return path to public directory
         */
        @Override
        public CharSequence getPublicDirectory() {
<span class="fc" id="L3508">            return publicDirectory;</span>
        }
    }

<span class="fc" id="L3512">    private class PropTelemetryConfiguration implements TelemetryConfiguration {</span>

        @Override
        public boolean getDisableCompletely() {
<span class="fc" id="L3516">            return telemetryDisableCompletely;</span>
        }

        @Override
        public boolean getEnabled() {
<span class="fc" id="L3521">            return telemetryEnabled;</span>
        }

        @Override
        public int getQueueCapacity() {
<span class="fc" id="L3526">            return telemetryQueueCapacity;</span>
        }

        @Override
        public boolean hideTables() {
<span class="nc" id="L3531">            return telemetryHideTables;</span>
        }
    }

<span class="fc" id="L3535">    private class PropTextConfiguration implements TextConfiguration {</span>

        @Override
        public int getDateAdapterPoolCapacity() {
<span class="fc" id="L3539">            return dateAdapterPoolCapacity;</span>
        }

        @Override
        public DateLocale getDefaultDateLocale() {
<span class="fc" id="L3544">            return locale;</span>
        }

        @Override
        public InputFormatConfiguration getInputFormatConfiguration() {
<span class="fc" id="L3549">            return inputFormatConfiguration;</span>
        }

        @Override
        public int getJsonCacheLimit() {
<span class="fc" id="L3554">            return jsonCacheLimit;</span>
        }

        @Override
        public int getJsonCacheSize() {
<span class="fc" id="L3559">            return jsonCacheSize;</span>
        }

        @Override
        public double getMaxRequiredDelimiterStdDev() {
<span class="fc" id="L3564">            return maxRequiredDelimiterStdDev;</span>
        }

        @Override
        public double getMaxRequiredLineLengthStdDev() {
<span class="fc" id="L3569">            return maxRequiredLineLengthStdDev;</span>
        }

        @Override
        public int getMetadataStringPoolCapacity() {
<span class="fc" id="L3574">            return metadataStringPoolCapacity;</span>
        }

        @Override
        public int getRollBufferLimit() {
<span class="fc" id="L3579">            return rollBufferLimit;</span>
        }

        @Override
        public int getRollBufferSize() {
<span class="fc" id="L3584">            return rollBufferSize;</span>
        }

        @Override
        public int getTextAnalysisMaxLines() {
<span class="fc" id="L3589">            return textAnalysisMaxLines;</span>
        }

        @Override
        public int getTextLexerStringPoolCapacity() {
<span class="fc" id="L3594">            return textLexerStringPoolCapacity;</span>
        }

        @Override
        public int getTimestampAdapterPoolCapacity() {
<span class="fc" id="L3599">            return timestampAdapterPoolCapacity;</span>
        }

        @Override
        public int getUtf8SinkSize() {
<span class="fc" id="L3604">            return utf8SinkSize;</span>
        }
    }

<span class="fc" id="L3608">    private class PropWaitProcessorConfiguration implements WaitProcessorConfiguration {</span>

        @Override
        public MillisecondClock getClock() {
<span class="fc" id="L3612">            return MillisecondClockImpl.INSTANCE;</span>
        }

        @Override
        public double getExponentialWaitMultiplier() {
<span class="fc" id="L3617">            return rerunExponentialWaitMultiplier;</span>
        }

        @Override
        public int getInitialWaitQueueSize() {
<span class="fc" id="L3622">            return rerunInitialWaitQueueSize;</span>
        }

        @Override
        public int getMaxProcessingQueueSize() {
<span class="fc" id="L3627">            return rerunMaxProcessingQueueSize;</span>
        }

        @Override
        public long getMaxWaitCapMs() {
<span class="fc" id="L3632">            return maxRerunWaitCapMs;</span>
        }
    }

<span class="fc" id="L3636">    private class PropWalApplyPoolConfiguration implements WorkerPoolConfiguration {</span>
        @Override
        public String getPoolName() {
<span class="fc" id="L3639">            return &quot;wal-apply&quot;;</span>
        }

        @Override
        public long getSleepThreshold() {
<span class="fc" id="L3644">            return walApplyWorkerSleepThreshold;</span>
        }

        @Override
        public long getSleepTimeout() {
<span class="fc" id="L3649">            return walApplySleepTimeout;</span>
        }

        @Override
        public int[] getWorkerAffinity() {
<span class="fc" id="L3654">            return walApplyWorkerAffinity;</span>
        }

        @Override
        public int getWorkerCount() {
<span class="fc" id="L3659">            return walApplyWorkerCount;</span>
        }

        @Override
        public long getYieldThreshold() {
<span class="fc" id="L3664">            return walApplyWorkerYieldThreshold;</span>
        }

        @Override
        public boolean haltOnError() {
<span class="fc" id="L3669">            return walApplyWorkerHaltOnError;</span>
        }

        @Override
        public boolean isEnabled() {
<span class="pc bpc" id="L3674" title="1 of 2 branches missed.">            return walApplyWorkerCount &gt; 0;</span>
        }
    }

<span class="fc" id="L3678">    private class PropWorkerPoolConfiguration implements WorkerPoolConfiguration {</span>
        @Override
        public String getPoolName() {
<span class="fc" id="L3681">            return &quot;shared&quot;;</span>
        }

        @Override
        public long getSleepThreshold() {
<span class="fc" id="L3686">            return sharedWorkerSleepThreshold;</span>
        }

        @Override
        public long getSleepTimeout() {
<span class="fc" id="L3691">            return sharedWorkerSleepTimeout;</span>
        }

        @Override
        public int[] getWorkerAffinity() {
<span class="fc" id="L3696">            return sharedWorkerAffinity;</span>
        }

        @Override
        public int getWorkerCount() {
<span class="fc" id="L3701">            return sharedWorkerCount;</span>
        }

        @Override
        public long getYieldThreshold() {
<span class="fc" id="L3706">            return sharedWorkerYieldThreshold;</span>
        }

        @Override
        public boolean haltOnError() {
<span class="fc" id="L3711">            return sharedWorkerHaltOnError;</span>
        }
    }

    static {
<span class="fc" id="L3716">        WRITE_FO_OPTS.put(&quot;o_direct&quot;, (int) CairoConfiguration.O_DIRECT);</span>
<span class="fc" id="L3717">        WRITE_FO_OPTS.put(&quot;o_sync&quot;, (int) CairoConfiguration.O_SYNC);</span>
<span class="fc" id="L3718">        WRITE_FO_OPTS.put(&quot;o_async&quot;, (int) CairoConfiguration.O_ASYNC);</span>
<span class="fc" id="L3719">        WRITE_FO_OPTS.put(&quot;o_none&quot;, (int) CairoConfiguration.O_NONE);</span>

<span class="fc" id="L3721">        registerObsolete(</span>
                &quot;line.tcp.commit.timeout&quot;,
                PropertyKey.LINE_TCP_COMMIT_INTERVAL_DEFAULT,
                PropertyKey.LINE_TCP_COMMIT_INTERVAL_FRACTION);
<span class="fc" id="L3725">        registerObsolete(</span>
                &quot;cairo.timestamp.locale&quot;,
                PropertyKey.CAIRO_DATE_LOCALE);
<span class="fc" id="L3728">        registerObsolete(</span>
                &quot;pg.timestamp.locale&quot;,
                PropertyKey.PG_DATE_LOCALE);
<span class="fc" id="L3731">        registerObsolete(</span>
                &quot;cairo.sql.append.page.size&quot;,
                PropertyKey.CAIRO_WRITER_DATA_APPEND_PAGE_SIZE);

<span class="fc" id="L3735">        registerDeprecated(</span>
                PropertyKey.HTTP_MIN_BIND_TO,
                PropertyKey.HTTP_MIN_NET_BIND_TO);
<span class="fc" id="L3738">        registerDeprecated(</span>
                PropertyKey.HTTP_MIN_NET_IDLE_CONNECTION_TIMEOUT,
                PropertyKey.HTTP_MIN_NET_CONNECTION_TIMEOUT);
<span class="fc" id="L3741">        registerDeprecated(</span>
                PropertyKey.HTTP_MIN_NET_QUEUED_CONNECTION_TIMEOUT,
                PropertyKey.HTTP_MIN_NET_CONNECTION_QUEUE_TIMEOUT);
<span class="fc" id="L3744">        registerDeprecated(</span>
                PropertyKey.HTTP_MIN_NET_SND_BUF_SIZE,
                PropertyKey.HTTP_MIN_NET_CONNECTION_SNDBUF);
<span class="fc" id="L3747">        registerDeprecated(</span>
                PropertyKey.HTTP_NET_RCV_BUF_SIZE,
                PropertyKey.HTTP_MIN_NET_CONNECTION_RCVBUF,
                PropertyKey.HTTP_NET_CONNECTION_RCVBUF);
<span class="fc" id="L3751">        registerDeprecated(</span>
                PropertyKey.HTTP_NET_ACTIVE_CONNECTION_LIMIT,
                PropertyKey.HTTP_NET_CONNECTION_LIMIT);
<span class="fc" id="L3754">        registerDeprecated(</span>
                PropertyKey.HTTP_NET_IDLE_CONNECTION_TIMEOUT,
                PropertyKey.HTTP_NET_CONNECTION_TIMEOUT);
<span class="fc" id="L3757">        registerDeprecated(</span>
                PropertyKey.HTTP_NET_QUEUED_CONNECTION_TIMEOUT,
                PropertyKey.HTTP_NET_CONNECTION_QUEUE_TIMEOUT);
<span class="fc" id="L3760">        registerDeprecated(</span>
                PropertyKey.HTTP_NET_SND_BUF_SIZE,
                PropertyKey.HTTP_NET_CONNECTION_SNDBUF);
<span class="fc" id="L3763">        registerDeprecated(</span>
                PropertyKey.PG_NET_ACTIVE_CONNECTION_LIMIT,
                PropertyKey.PG_NET_CONNECTION_LIMIT);
<span class="fc" id="L3766">        registerDeprecated(</span>
                PropertyKey.PG_NET_IDLE_TIMEOUT,
                PropertyKey.PG_NET_CONNECTION_TIMEOUT);
<span class="fc" id="L3769">        registerDeprecated(</span>
                PropertyKey.PG_NET_RECV_BUF_SIZE,
                PropertyKey.PG_NET_CONNECTION_RCVBUF);
<span class="fc" id="L3772">        registerDeprecated(</span>
                PropertyKey.LINE_TCP_NET_ACTIVE_CONNECTION_LIMIT,
                PropertyKey.LINE_TCP_NET_CONNECTION_LIMIT);
<span class="fc" id="L3775">        registerDeprecated(</span>
                PropertyKey.LINE_TCP_NET_IDLE_TIMEOUT,
                PropertyKey.LINE_TCP_NET_CONNECTION_TIMEOUT);
<span class="fc" id="L3778">        registerDeprecated(</span>
                PropertyKey.LINE_TCP_NET_QUEUED_TIMEOUT,
                PropertyKey.LINE_TCP_NET_CONNECTION_QUEUE_TIMEOUT);
<span class="fc" id="L3781">        registerDeprecated(</span>
                PropertyKey.LINE_TCP_NET_RECV_BUF_SIZE,
                PropertyKey.LINE_TCP_NET_CONNECTION_RCVBUF);
<span class="fc" id="L3784">        registerDeprecated(</span>
                PropertyKey.LINE_TCP_DEFAULT_PARTITION_BY,
                PropertyKey.LINE_DEFAULT_PARTITION_BY);
<span class="fc" id="L3787">        registerDeprecated(</span>
                PropertyKey.CAIRO_REPLACE_BUFFER_MAX_SIZE,
                PropertyKey.CAIRO_SQL_STR_FUNCTION_BUFFER_MAX_SIZE);
<span class="fc" id="L3790">        registerDeprecated(</span>
                PropertyKey.CIRCUIT_BREAKER_BUFFER_SIZE,
                PropertyKey.NET_TEST_CONNECTION_BUFFER_SIZE);
<span class="fc" id="L3793">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>